<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-technologies/kafka/kafka-guarantees" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.0">
<title data-rh="true">Kafka Guarantees | Deep Notes</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://deepaksood619.github.io/img/timeline_blurred.webp"><meta data-rh="true" name="twitter:image" content="https://deepaksood619.github.io/img/timeline_blurred.webp"><meta data-rh="true" property="og:url" content="https://deepaksood619.github.io/technologies/kafka/kafka-guarantees"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Kafka Guarantees | Deep Notes"><meta data-rh="true" name="description" content="- Messages sent by a producer to a topic and a partition are appended in the same order"><meta data-rh="true" property="og:description" content="- Messages sent by a producer to a topic and a partition are appended in the same order"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://deepaksood619.github.io/technologies/kafka/kafka-guarantees"><link data-rh="true" rel="alternate" href="https://deepaksood619.github.io/technologies/kafka/kafka-guarantees" hreflang="en"><link data-rh="true" rel="alternate" href="https://deepaksood619.github.io/technologies/kafka/kafka-guarantees" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://X3OY8NGHVH-dsn.algolia.net" crossorigin="anonymous"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Technologies","item":"https://deepaksood619.github.io/technologies/"},{"@type":"ListItem","position":2,"name":"Kafka","item":"https://deepaksood619.github.io/technologies/kafka/"},{"@type":"ListItem","position":3,"name":"Kafka Guarantees","item":"https://deepaksood619.github.io/technologies/kafka/kafka-guarantees"}]}</script><link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-ZSZMJXWSH3"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-ZSZMJXWSH3",{})</script>
<link rel="preconnect" href="https://www.googletagmanager.com">
<script>window.dataLayer=window.dataLayer||[]</script>
<script>!function(e,t,a,n){e[n]=e[n]||[],e[n].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var g=t.getElementsByTagName(a)[0],m=t.createElement(a);m.async=!0,m.src="https://www.googletagmanager.com/gtm.js?id=GTM-TN3KBF4",g.parentNode.insertBefore(m,g)}(window,document,"script","dataLayer")</script>



<link rel="search" type="application/opensearchdescription+xml" title="Deep Notes" href="/opensearch.xml">
<link rel="icon" href="/img/logo.webp">
<link rel="manifest" href="/manifest.json">
<meta name="theme-color" content="rgb(53, 120, 229)">


<script src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5616865131274062" async crossorigin="anonymous"></script><link rel="stylesheet" href="/assets/css/styles.9f55d0bd.css">
<script src="/assets/js/runtime~main.7b3a7cc3.js" defer="defer"></script>
<script src="/assets/js/main.c96be3a1.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TN3KBF4" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>


<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")),document.documentElement.setAttribute("data-theme-choice",t||"system")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.webp" alt="Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.webp" alt="Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Deep Notes</b></a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/deepaksood619" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><a href="https://www.linkedin.com/in/deepaksood619/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Command+K)"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/about-deepak-sood/">About Deepak Sood</a><button aria-label="Expand sidebar category &#x27;About Deepak Sood&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/ai/">AI</a><button aria-label="Expand sidebar category &#x27;AI&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/algorithms/">Algorithms</a><button aria-label="Expand sidebar category &#x27;Algorithms&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/book-summaries/">Book Summaries</a><button aria-label="Expand sidebar category &#x27;Book Summaries&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/cloud/">Cloud</a><button aria-label="Expand sidebar category &#x27;Cloud&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/computer-science/">Computer Science</a><button aria-label="Expand sidebar category &#x27;Computer Science&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/courses/">Courses / Certifications</a><button aria-label="Expand sidebar category &#x27;Courses / Certifications&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/data-structures/">Data Structures</a><button aria-label="Expand sidebar category &#x27;Data Structures&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/data-warehouses/">Data Warehouses</a><button aria-label="Expand sidebar category &#x27;Data Warehouses&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/databases/">Databases</a><button aria-label="Expand sidebar category &#x27;Databases&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/databases-nosql/">NoSQL Databases</a><button aria-label="Expand sidebar category &#x27;NoSQL Databases&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/databases-sql/">SQL Databases</a><button aria-label="Expand sidebar category &#x27;SQL Databases&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/decentralized-applications/">Decentralized Applications</a><button aria-label="Expand sidebar category &#x27;Decentralized Applications&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/devops/">DevOps</a><button aria-label="Expand sidebar category &#x27;DevOps&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/economics/">Economics</a><button aria-label="Expand sidebar category &#x27;Economics&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/education/">Education</a><button aria-label="Expand sidebar category &#x27;Education&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/frontend/">Frontend</a><button aria-label="Expand sidebar category &#x27;Frontend&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/knowledge/">Knowledge</a><button aria-label="Expand sidebar category &#x27;Knowledge&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/languages/">Languages</a><button aria-label="Expand sidebar category &#x27;Languages&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/management/">Management</a><button aria-label="Expand sidebar category &#x27;Management&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/mathematics/">Mathematics</a><button aria-label="Expand sidebar category &#x27;Mathematics&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/networking/">Networking</a><button aria-label="Expand sidebar category &#x27;Networking&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/psychology/">Psychology</a><button aria-label="Expand sidebar category &#x27;Psychology&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/python/">Python</a><button aria-label="Expand sidebar category &#x27;Python&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/">Deepak&#x27;s Wiki</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/technologies/">Technologies</a><button aria-label="Collapse sidebar category &#x27;Technologies&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/technologies/apache/">Apache</a><button aria-label="Expand sidebar category &#x27;Apache&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/technologies/apache-airflow/">Airflow</a><button aria-label="Expand sidebar category &#x27;Airflow&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/technologies/apache-hadoop/">Apache Hadoop</a><button aria-label="Expand sidebar category &#x27;Apache Hadoop&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/technologies/apache-spark/">Apache Spark</a><button aria-label="Expand sidebar category &#x27;Apache Spark&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/technologies/brokers/">Brokers</a><button aria-label="Expand sidebar category &#x27;Brokers&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/technologies/celery/">Celery</a><button aria-label="Expand sidebar category &#x27;Celery&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/technologies/confluent/">Confluent</a><button aria-label="Expand sidebar category &#x27;Confluent&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/technologies/elasticsearch/">Elasticsearch</a><button aria-label="Expand sidebar category &#x27;Elasticsearch&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/technologies/flink/">Apache Flink</a><button aria-label="Expand sidebar category &#x27;Apache Flink&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/technologies/git/">Git</a><button aria-label="Expand sidebar category &#x27;Git&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/technologies/kafka/">Kafka</a><button aria-label="Collapse sidebar category &#x27;Kafka&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/technologies/kafka/comparison">Comparison</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/technologies/kafka/installing-kafka">Installing Kafka</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/technologies/kafka/intro-to-kafka">Intro to Kafka</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/technologies/kafka/kafka-architecture">Kafka Architecture</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/technologies/kafka/kafka-brokers">Kafka Brokers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/technologies/kafka/kafka-commands">Kafka Commands</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/technologies/kafka/kafka-configurations">Kafka Configurations</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/technologies/kafka/kafka-connect">Kafka Connect</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/technologies/kafka/kafka-consumers">Kafka Consumers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/technologies/kafka/kafka-guarantees">Kafka Guarantees</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/technologies/kafka/kafka-listeners">Kafka Listeners</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/technologies/kafka/kafka-message-key">Kafka Message Key</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/technologies/kafka/kafka-partitions">Partitions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/technologies/kafka/kafka-producers">Kafka Producers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/technologies/kafka/kafka-python">kafka-python</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/technologies/kafka/kafka-rest-proxy">kafka-rest proxy</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/technologies/kafka/kafka-schema-registry-compatibility-rules">Kafka Schema Registry Compatibility Rules</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/technologies/kafka/kafka-schema-registry">Kafka Schema Registry</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/technologies/kafka/kafka-streams">Kafka Streams</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/technologies/kafka/kafka-topic-replication">Kafka Topic/Replication</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/technologies/kafka/kafka-topics">Kafka Topics</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/technologies/kafka/kafkacat-kcat">kafkacat / kcat</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/technologies/kafka/kraft">Kafka without Zookeeper (Kafka with KRaft Mode)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/technologies/kafka/log-compaction">Log Compaction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/technologies/kafka/migration-mirroring-replication">Migration / Mirroring / Replication</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/technologies/kafka/monitoring">Monitoring</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/technologies/kafka/others">Others</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/technologies/kafka/releases-upgrades-changelogs">Releases / Upgrades / Change logs</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/technologies/kafka/security/">Security</a><button aria-label="Expand sidebar category &#x27;Security&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/technologies/kafka/strimzi">Strimzi</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/technologies/kafka/use-cases">Use Cases</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/technologies/others/">Others</a><button aria-label="Expand sidebar category &#x27;Others&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/technologies/"><span>Technologies</span></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/technologies/kafka/"><span>Kafka</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Kafka Guarantees</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Kafka Guarantees</h1></header>
<ul>
<li>Messages sent by a producer to a topic and a partition are appended in the same order</li>
<li>A consumer instance gets the messages in the same order as they are produced</li>
<li>A topic with replication factor N, tolerates upto N-1 server failures</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="message-processing-guarantees">Message Processing Guarantees<a href="#message-processing-guarantees" class="hash-link" aria-label="Direct link to Message Processing Guarantees" title="Direct link to Message Processing Guarantees">​</a></h2>
<ul>
<li><strong>No guarantee -</strong> No explicit guarantee is provided, so consumers may process messages once, multiple times or never at all.</li>
<li><strong>At most once -</strong> This is &quot;best effort&quot; delivery semantics. Consumers will receive and process messages exactly once or not at all.</li>
<li><strong>At least once -</strong> Consumers will receive and process every message, but they may process the same message more than once.</li>
<li><strong>Effectively once -</strong> Also <a href="https://streaml.io/blog/exactly-once" target="_blank" rel="noopener noreferrer">contentiously</a> <a href="https://medium.com/@jaykreps/exactly-once-support-in-apache-kafka-55e1fdd0a35f" target="_blank" rel="noopener noreferrer">known</a> as exactly once, this promises consumers will process every message once.</li>
</ul>
<p><img decoding="async" loading="lazy" alt="image" src="/assets/images/Technologies-Kafka-Others-image1-c116dd5d2221e9d4fc3d59d6c2a42a56.jpg" width="525" height="409" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="exactly-once-semantics-eos">Exactly Once Semantics (EOS)<a href="#exactly-once-semantics-eos" class="hash-link" aria-label="Direct link to Exactly Once Semantics (EOS)" title="Direct link to Exactly Once Semantics (EOS)">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="key-building-blocks-for-eos">Key Building Blocks for EOS<a href="#key-building-blocks-for-eos" class="hash-link" aria-label="Direct link to Key Building Blocks for EOS" title="Direct link to Key Building Blocks for EOS">​</a></h3>
<p>Kafka achieves <strong>EOS</strong> using three main features:</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="a-idempotent-producer">(a) Idempotent Producer<a href="#a-idempotent-producer" class="hash-link" aria-label="Direct link to (a) Idempotent Producer" title="Direct link to (a) Idempotent Producer">​</a></h4>
<ul>
<li>Every message sent by a producer gets a <strong>producer ID (PID)</strong> and a <strong>sequence number</strong>.</li>
<li>If retries happen (e.g., network glitch), Kafka detects duplicates by checking the sequence number and ignores them.</li>
<li>Ensures <strong>no duplicates on retries</strong> → gives <strong>idempotent writes</strong>.</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="b-transactions">(b) Transactions<a href="#b-transactions" class="hash-link" aria-label="Direct link to (b) Transactions" title="Direct link to (b) Transactions">​</a></h4>
<ul>
<li>A producer can group multiple writes (to one or more partitions, topics) into a <strong>transaction</strong>.</li>
<li>Kafka ensures that either:<!-- -->
<ul>
<li>All writes in the transaction are committed, or</li>
<li>None are (atomicity).</li>
</ul>
</li>
<li>Consumers using <strong>read_committed</strong> isolation see only committed data.</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="c-replication-protocol">(c) Replication Protocol<a href="#c-replication-protocol" class="hash-link" aria-label="Direct link to (c) Replication Protocol" title="Direct link to (c) Replication Protocol">​</a></h4>
<ul>
<li>With <code>acks=all</code>, Kafka ensures that once a transaction is committed, it’s <strong>durably replicated to all in-sync replicas (ISRs)</strong>.</li>
<li>This guarantees durability even if the leader fails immediately after commit.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="putting-it-together">Putting It Together<a href="#putting-it-together" class="hash-link" aria-label="Direct link to Putting It Together" title="Direct link to Putting It Together">​</a></h3>
<p>Here’s how EOS works in practice:</p>
<ol>
<li><strong>Producer</strong> starts a transaction → <code>initTransactions()</code>.</li>
<li>Writes messages with <strong>idempotence enabled</strong>.</li>
<li>Calls <code>commitTransaction()</code> → Kafka writes a <strong>transaction marker</strong> ensuring atomic visibility.</li>
<li>Messages are replicated to all ISRs (with <code>acks=all</code>).</li>
<li><strong>Consumer</strong> reads with <code>isolation.level=read_committed</code> → sees each committed message <strong>exactly once</strong>.</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="limitations">Limitations<a href="#limitations" class="hash-link" aria-label="Direct link to Limitations" title="Direct link to Limitations">​</a></h3>
<ul>
<li>EOS works <strong>only within Kafka</strong> (end-to-end with producers + Kafka + consumers).</li>
<li>If you write to an external DB/system, you need <strong>two-phase commit or outbox patterns</strong>.</li>
<li>Slight overhead due to transaction coordination.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="replication-protocol">Replication Protocol<a href="#replication-protocol" class="hash-link" aria-label="Direct link to Replication Protocol" title="Direct link to Replication Protocol">​</a></h2>
<ul>
<li>
<p>When a <strong>producer</strong> writes a message to a partition, it first goes to the <strong>leader replica</strong> of that partition.</p>
</li>
<li>
<p>The producer can specify the <strong>acks</strong> setting:</p>
<ul>
<li><code>acks=0</code> → Producer doesn’t wait for acknowledgment.</li>
<li><code>acks=1</code> → Producer gets an acknowledgment once the leader writes it.</li>
<li><code>acks=all</code> (or <code>-1</code>) → Producer gets acknowledgment only after the message is written to the leader <strong>and</strong> replicated to all <strong>in-sync replicas (ISRs)</strong>.</li>
</ul>
</li>
</ul>
<p><strong>Important nuance</strong>: Kafka does <strong>not</strong> guarantee replication to <em>all available replicas</em> after the leader write. Instead, it guarantees replication to the set of <strong>in-sync replicas (ISRs)</strong>.</p>
<ul>
<li>If a follower is <strong>out of sync</strong>, it won’t block the acknowledgment.</li>
<li>As long as at least one ISR (typically the leader + followers in sync) has the message, Kafka considers it durable.</li>
</ul>
<blockquote>
<p>Kafka’s replication protocol guarantees that once a message has been acknowledged with <code>acks=all</code>, it has been written successfully to the leader replica and replicated to all in-sync replicas (ISRs).</p>
</blockquote>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="outbox-pattern">Outbox Pattern<a href="#outbox-pattern" class="hash-link" aria-label="Direct link to Outbox Pattern" title="Direct link to Outbox Pattern">​</a></h2>
<p>The <strong>Outbox Pattern</strong> is one of the most popular patterns used to achieve <strong>reliable event-driven integration</strong> between a database (like MySQL, PostgreSQL) and a message broker (like Kafka).</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="problem-it-solves">Problem it Solves<a href="#problem-it-solves" class="hash-link" aria-label="Direct link to Problem it Solves" title="Direct link to Problem it Solves">​</a></h3>
<p>When a service needs to:</p>
<ol>
<li>Update its <strong>own database</strong> (say insert a new <code>Order</code>), and</li>
<li>Publish an <strong>event to Kafka</strong> (like <code>OrderCreated</code>)</li>
</ol>
<p>You run into the <strong>dual-write problem</strong>:</p>
<ul>
<li>If you write to the DB but crash before publishing to Kafka → event is lost.</li>
<li>If you publish to Kafka but crash before writing to DB → system state is inconsistent.</li>
</ul>
<p>This breaks <strong>exactly-once semantics across DB + Kafka</strong>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="the-outbox-pattern">The Outbox Pattern<a href="#the-outbox-pattern" class="hash-link" aria-label="Direct link to The Outbox Pattern" title="Direct link to The Outbox Pattern">​</a></h3>
<p>Instead of doing both separately, you write <strong>only to your database</strong> in a single atomic transaction:</p>
<ol>
<li>Service writes <strong>business data</strong> (e.g., new <code>Order</code>)</li>
<li>In the <strong>same transaction</strong>, service writes an <strong>event record</strong> into a special <code>outbox</code> table.</li>
</ol>
<p>Example (Postgres/MySQL):</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">BEGIN</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">INSERT</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">INTO</span><span class="token plain"> orders </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">id</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> customer</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> amount</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">status</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">VALUES</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">123</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Deepak&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1000</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;CREATED&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">INSERT</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">INTO</span><span class="token plain"> outbox </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">event_id</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">type</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> payload</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">status</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">VALUES</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">uuid</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;OrderCreated&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;{&quot;id&quot;:123,&quot;amount&quot;:1000}&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;NEW&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">COMMIT</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<p>Now DB and event are <strong>guaranteed consistent</strong>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="event-relay-debezium--polling">Event Relay (Debezium / Polling)<a href="#event-relay-debezium--polling" class="hash-link" aria-label="Direct link to Event Relay (Debezium / Polling)" title="Direct link to Event Relay (Debezium / Polling)">​</a></h3>
<p>Next step:</p>
<ul>
<li>A <strong>relay process</strong> reads events from the <code>outbox</code> table and publishes them to Kafka.</li>
<li>Can be done via:<!-- -->
<ul>
<li><strong>Change Data Capture (CDC)</strong> tools like <strong>Debezium</strong> (reads DB transaction log, automatically streams outbox rows to Kafka).</li>
<li><strong>Polling</strong> (a background service queries the outbox table and sends events).</li>
</ul>
</li>
</ul>
<p>After publishing, event status can be marked as <code>SENT</code> or the row can be archived.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="benefits">Benefits<a href="#benefits" class="hash-link" aria-label="Direct link to Benefits" title="Direct link to Benefits">​</a></h3>
<ul>
<li><strong>Atomicity</strong> → DB update + event log are one transaction.</li>
<li><strong>Reliability</strong> → No lost or duplicated events.</li>
<li><strong>Event-driven architecture</strong> works smoothly with existing DB.</li>
<li>Plays well with <strong>Kafka + EOS</strong> when you integrate external systems.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="example-flow">Example Flow<a href="#example-flow" class="hash-link" aria-label="Direct link to Example Flow" title="Direct link to Example Flow">​</a></h3>
<p><strong>Order Service</strong>:</p>
<ul>
<li>User places order.</li>
<li>Service saves order + inserts event into outbox table.</li>
<li>Debezium streams outbox → Kafka topic <code>order.events</code>.</li>
</ul>
<p><strong>Inventory Service</strong>:</p>
<ul>
<li>Consumes from <code>order.events</code>.</li>
<li>Updates stock accordingly.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="outbox-to-kafka---eos">Outbox to Kafka - EOS<a href="#outbox-to-kafka---eos" class="hash-link" aria-label="Direct link to Outbox to Kafka - EOS" title="Direct link to Outbox to Kafka - EOS">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-the-challenge">1. The Challenge<a href="#1-the-challenge" class="hash-link" aria-label="Direct link to 1. The Challenge" title="Direct link to 1. The Challenge">​</a></h3>
<ul>
<li>The <strong>outbox table</strong> is already atomic with your business data.</li>
<li>But when your <strong>producer service</strong> reads from the outbox and publishes to Kafka, two risks appear:<!-- -->
<ol>
<li><strong>Duplicate sends</strong> (retry on failure, service crash before marking event as sent).</li>
<li><strong>Lost events</strong> (service marks row as sent, but crash happens before actually producing to Kafka).</li>
</ol>
</li>
</ul>
<p>We need EOS here.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-solution-approaches">2. Solution Approaches<a href="#2-solution-approaches" class="hash-link" aria-label="Direct link to 2. Solution Approaches" title="Direct link to 2. Solution Approaches">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="approach-a-kafka-transactions-eos-producer">Approach A: <strong>Kafka Transactions (EOS Producer)</strong><a href="#approach-a-kafka-transactions-eos-producer" class="hash-link" aria-label="Direct link to approach-a-kafka-transactions-eos-producer" title="Direct link to approach-a-kafka-transactions-eos-producer">​</a></h4>
<p>Kafka has <strong>idempotent producers + transactions</strong>:</p>
<ul>
<li>Configure the producer with:<!-- -->
<ul>
<li><code>enable.idempotence=true</code></li>
<li><code>acks=all</code></li>
<li><code>transactional.id=outbox-relay-1</code></li>
</ul>
</li>
<li>Start a <strong>transaction</strong>:<!-- -->
<ol>
<li>Read batch of unsent events from outbox table.</li>
<li>Begin Kafka transaction.</li>
<li>Send all events to Kafka.</li>
<li>Commit Kafka transaction <strong>AND</strong> update outbox table status (<code>sent=true</code>) in the <strong>same transactional flow</strong>.</li>
</ol>
</li>
</ul>
<p>But here’s the catch: Kafka transactions and DB transactions are separate. You <strong>cannot</strong> commit both atomically in one step.</p>
<p>So you need a <strong>transactional outbox + idempotent updates</strong> pattern.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="approach-b-idempotent-deduplication-key">Approach B: <strong>Idempotent Deduplication Key</strong><a href="#approach-b-idempotent-deduplication-key" class="hash-link" aria-label="Direct link to approach-b-idempotent-deduplication-key" title="Direct link to approach-b-idempotent-deduplication-key">​</a></h4>
<p>Each event in outbox has a <strong>unique event_id (UUID)</strong>.</p>
<ul>
<li>Use <code>event_id</code> as <strong>Kafka message key</strong> (or put it in headers).</li>
<li>Kafka producer with idempotence ensures retries don’t create duplicates.</li>
<li>Consumers can deduplicate by <code>event_id</code> if needed.</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="approach-c-debezium--cdc-outbox-best-practice">Approach C: <strong>Debezium / CDC Outbox (Best Practice)</strong><a href="#approach-c-debezium--cdc-outbox-best-practice" class="hash-link" aria-label="Direct link to approach-c-debezium--cdc-outbox-best-practice" title="Direct link to approach-c-debezium--cdc-outbox-best-practice">​</a></h4>
<p>Instead of writing custom relay code:</p>
<ul>
<li>
<p>Use <strong>Debezium</strong> (reads DB’s transaction log).</p>
</li>
<li>
<p>When your service commits the DB transaction (business row + outbox row), Debezium streams the outbox change directly into Kafka.</p>
</li>
<li>
<p>This is already <strong>exactly-once</strong> because:</p>
<ul>
<li>DB transaction log guarantees no duplicates.</li>
<li>Kafka’s EOS producer (in Debezium) guarantees idempotence.</li>
</ul>
</li>
</ul>
<p>This avoids the &quot;dual-write&quot; problem entirely.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="3-practical-design-if-writing-custom-relay-service">3. Practical Design (if writing custom relay service)<a href="#3-practical-design-if-writing-custom-relay-service" class="hash-link" aria-label="Direct link to 3. Practical Design (if writing custom relay service)" title="Direct link to 3. Practical Design (if writing custom relay service)">​</a></h3>
<ol>
<li>Outbox row has:
<code>event_id (UUID, PK), payload, status, created_at</code></li>
<li>Relay service logic:<!-- -->
<ul>
<li>Poll outbox rows where <code>status=&#x27;NEW&#x27;</code>.</li>
<li>Start Kafka transaction.</li>
<li>For each row:
<code>producer.send(new ProducerRecord(&quot;topic&quot;, event_id, payload));</code></li>
<li>Commit Kafka transaction.</li>
<li>After successful commit, mark those rows as <code>SENT</code>.</li>
</ul>
</li>
<li>If crash happens:<!-- -->
<ul>
<li>Rows still marked <code>NEW</code> → safe to retry.</li>
<li>Kafka idempotence + unique key ensure no duplicates.</li>
</ul>
</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="4-key-points">4. Key Points<a href="#4-key-points" class="hash-link" aria-label="Direct link to 4. Key Points" title="Direct link to 4. Key Points">​</a></h3>
<ul>
<li><strong>Idempotence in Kafka</strong> removes duplicates caused by retries.</li>
<li><strong>Outbox status column</strong> ensures no message is lost.</li>
<li><strong>CDC (Debezium)</strong> is the cleanest and production-proven way.</li>
<li>If you roll your own relay, you must use <strong>idempotent producer + unique event_id</strong>.</li>
</ul>
<p>So, <strong>the safest way</strong> to ensure EOS from Outbox → Kafka is:</p>
<ul>
<li>Use <strong>CDC (Debezium Outbox pattern)</strong> if possible.</li>
<li>If using a custom service, use <strong>Kafka idempotent producer with unique event_id</strong> + mark rows after commit.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="idempotent-writer">Idempotent Writer<a href="#idempotent-writer" class="hash-link" aria-label="Direct link to Idempotent Writer" title="Direct link to Idempotent Writer">​</a></h2>
<p>A writer produces <a href="https://developer.confluent.io/patterns/event/event" target="_blank" rel="noopener noreferrer">Events</a> that are written into an <a href="https://developer.confluent.io/patterns/event-stream/event-stream" target="_blank" rel="noopener noreferrer">Event Stream</a>, and under stable conditions, each Event is recorded only once. However, in the case of an operational failure or a brief network outage, an <a href="https://developer.confluent.io/patterns/event-source/event-source" target="_blank" rel="noopener noreferrer">Event Source</a> may need to retry writes. This may result in multiple copies of the same Event ending up in the Event Stream, as the first write may have actually succeeded even though the producer did not receive the acknowledgement from the <a href="https://developer.confluent.io/patterns/event-stream/event-streaming-platform" target="_blank" rel="noopener noreferrer">Event Streaming Platform</a>. This type of duplication is a common failure scenario in practice and one of the perils of distributed systems.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="solution">Solution<a href="#solution" class="hash-link" aria-label="Direct link to Solution" title="Direct link to Solution">​</a></h3>
<p><img decoding="async" loading="lazy" src="https://developer.confluent.io/e2aafad9a007b0e88fca48e720894ec1/idempotent-writer.svg" alt="idempotent-writer" class="img_ev3q"></p>
<p>Generally speaking, this can be addressed by native support for idempotent clients. This means that a writer may try to produce an Event more than once, but the Event Streaming Platform detects and discards duplicate write attempts for the same Event.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="implementation">Implementation<a href="#implementation" class="hash-link" aria-label="Direct link to Implementation" title="Direct link to Implementation">​</a></h3>
<p>To make an Apache Kafka® producer idempotent, configure your producer with the following setting:</p>
<p><code>enable.idempotence=true</code></p>
<p>The Kafka producer tags each batch of Events that it sends to the Kafka cluster with a sequence number. Brokers in the cluster use this sequence number to enforce deduplication of Events sent from this specific producer. Each batch&#x27;s sequence number is persisted so that even if the <a href="https://www.confluent.io/blog/apache-kafka-intro-how-kafka-works/?session_ref=https%3A%2F%2Fwww.google.com%2F#replication" target="_blank" rel="noopener noreferrer">leader broker</a> fails, the new leader broker will also know if a given batch is a duplicate.</p>
<p>To enable exactly-once processing within an Apache Flink® application that uses Kafka sources and sinks, configure the delivery guarantee to be exactly once, either via the <a href="https://nightlies.apache.org/flink/flink-docs-stable/docs/connectors/datastream/kafka/#fault-tolerance" target="_blank" rel="noopener noreferrer">DeliveryGuarantee.EXACTLY_ONCE</a> KafkaSink configuration option if the application uses the DataStream Kafka connector, or by setting the <a href="https://nightlies.apache.org/flink/flink-docs-stable/docs/connectors/table/kafka/#consistency-guarantees" target="_blank" rel="noopener noreferrer">sink.delivery-guarantee</a> configuration option to exactly-once if it uses one of the Table API connectors. <a href="https://docs.confluent.io/cloud/current/flink/overview.html" target="_blank" rel="noopener noreferrer">Confluent Cloud for Apache Flink</a> provides built-in exactly-once semantics. Downstream of the Flink application, be sure to configure any Kafka consumer with an <a href="https://docs.confluent.io/platform/current/installation/configuration/consumer-configs.html#isolation-level" target="_blank" rel="noopener noreferrer">isolation.level</a> of read_committed since Flink leverages Kafka transactions in the embedded producer to implement exactly-once processing.</p>
<p>To enable <a href="https://docs.confluent.io/platform/current/installation/configuration/streams-configs.html#processing-guarantee" target="_blank" rel="noopener noreferrer">exactly-once processing guarantees</a> in Kafka Streams or ksqlDB, configure the application with the following setting, which includes enabling idempotence in the embedded producer:</p>
<p><code>processing.guarantee=exactly_once_v2</code></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="considerations">Considerations<a href="#considerations" class="hash-link" aria-label="Direct link to Considerations" title="Direct link to Considerations">​</a></h3>
<p>Enabling idempotency for a Kafka producer not only ensures that duplicate Events are fenced out from the topic, it also ensures that they are written in order. This is because the brokers accept a batch of Events only if its sequence number is exactly one greater than that of the last committed batch; otherwise, it results in an out-of-sequence error.</p>
<p>Exactly-once semantics (EOS) allow <a href="https://developer.confluent.io/patterns/event-processing/event-processing-application" target="_blank" rel="noopener noreferrer">Event Streaming Applications</a> to process data without loss or duplication. This ensures that computed results are always consistent and accurate, even for stateful computations such as joins, <a href="https://developer.confluent.io/patterns/stream-processing/event-aggregator" target="_blank" rel="noopener noreferrer">aggregations</a>, and <a href="https://developer.confluent.io/patterns/stream-processing/event-grouper" target="_blank" rel="noopener noreferrer">windowing</a>. Any solution that requires EOS guarantees must enable EOS at all stages of the pipeline, not just on the writer. An Idempotent Writer is therefore typically combined with an <a href="https://developer.confluent.io/patterns/event-processing/idempotent-reader" target="_blank" rel="noopener noreferrer">Idempotent Reader</a> and transactional processing.</p>
<p><a href="https://developer.confluent.io/patterns/event-processing/idempotent-writer/" target="_blank" rel="noopener noreferrer">Idempotent Writer</a></p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/deepaksood619/deepaksood619.github.io/tree/master/docs/technologies/kafka/kafka-guarantees.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2026-01-25T11:19:44.000Z" itemprop="dateModified">Jan 25, 2026</time></b> by <b>Deepak Sood</b></span></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/technologies/kafka/kafka-consumers"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Kafka Consumers</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/technologies/kafka/kafka-listeners"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Kafka Listeners</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#message-processing-guarantees" class="table-of-contents__link toc-highlight">Message Processing Guarantees</a></li><li><a href="#exactly-once-semantics-eos" class="table-of-contents__link toc-highlight">Exactly Once Semantics (EOS)</a><ul><li><a href="#key-building-blocks-for-eos" class="table-of-contents__link toc-highlight">Key Building Blocks for EOS</a></li><li><a href="#putting-it-together" class="table-of-contents__link toc-highlight">Putting It Together</a></li><li><a href="#limitations" class="table-of-contents__link toc-highlight">Limitations</a></li></ul></li><li><a href="#replication-protocol" class="table-of-contents__link toc-highlight">Replication Protocol</a></li><li><a href="#outbox-pattern" class="table-of-contents__link toc-highlight">Outbox Pattern</a><ul><li><a href="#problem-it-solves" class="table-of-contents__link toc-highlight">Problem it Solves</a></li><li><a href="#the-outbox-pattern" class="table-of-contents__link toc-highlight">The Outbox Pattern</a></li><li><a href="#event-relay-debezium--polling" class="table-of-contents__link toc-highlight">Event Relay (Debezium / Polling)</a></li><li><a href="#benefits" class="table-of-contents__link toc-highlight">Benefits</a></li><li><a href="#example-flow" class="table-of-contents__link toc-highlight">Example Flow</a></li></ul></li><li><a href="#outbox-to-kafka---eos" class="table-of-contents__link toc-highlight">Outbox to Kafka - EOS</a><ul><li><a href="#1-the-challenge" class="table-of-contents__link toc-highlight">1. The Challenge</a></li><li><a href="#2-solution-approaches" class="table-of-contents__link toc-highlight">2. Solution Approaches</a></li><li><a href="#3-practical-design-if-writing-custom-relay-service" class="table-of-contents__link toc-highlight">3. Practical Design (if writing custom relay service)</a></li><li><a href="#4-key-points" class="table-of-contents__link toc-highlight">4. Key Points</a></li></ul></li><li><a href="#idempotent-writer" class="table-of-contents__link toc-highlight">Idempotent Writer</a><ul><li><a href="#solution" class="table-of-contents__link toc-highlight">Solution</a></li><li><a href="#implementation" class="table-of-contents__link toc-highlight">Implementation</a></li><li><a href="#considerations" class="table-of-contents__link toc-highlight">Considerations</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2026 Deep Notes, Built with ❤️</div></div></div></footer></div>
</body>
</html>