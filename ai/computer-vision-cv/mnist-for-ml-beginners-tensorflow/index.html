<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-ai/computer-vision-cv/mnist-for-ml-beginners-tensorflow" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.0.1">
<title data-rh="true">MNIST For ML Beginners | TensorFlow | Deep Notes</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://deepaksood619.github.io/img/timeline_blurred.webp"><meta data-rh="true" name="twitter:image" content="https://deepaksood619.github.io/img/timeline_blurred.webp"><meta data-rh="true" property="og:url" content="https://deepaksood619.github.io/ai/computer-vision-cv/mnist-for-ml-beginners-tensorflow"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="MNIST For ML Beginners | TensorFlow | Deep Notes"><meta data-rh="true" name="description" content="When one learns how to program, there&#x27;s a tradition that the first thing you do is print &quot;Hello World.&quot; Just like programming has Hello World, machine learning has MNIST."><meta data-rh="true" property="og:description" content="When one learns how to program, there&#x27;s a tradition that the first thing you do is print &quot;Hello World.&quot; Just like programming has Hello World, machine learning has MNIST."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://deepaksood619.github.io/ai/computer-vision-cv/mnist-for-ml-beginners-tensorflow"><link data-rh="true" rel="alternate" href="https://deepaksood619.github.io/ai/computer-vision-cv/mnist-for-ml-beginners-tensorflow" hreflang="en"><link data-rh="true" rel="alternate" href="https://deepaksood619.github.io/ai/computer-vision-cv/mnist-for-ml-beginners-tensorflow" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://X3OY8NGHVH-dsn.algolia.net" crossorigin="anonymous"><link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-ZSZMJXWSH3"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-ZSZMJXWSH3",{})</script>
<link rel="preconnect" href="https://www.googletagmanager.com">
<script>window.dataLayer=window.dataLayer||[]</script>
<script>!function(e,t,a,n,g){e[n]=e[n]||[],e[n].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var m=t.getElementsByTagName(a)[0],r=t.createElement(a);r.async=!0,r.src="https://www.googletagmanager.com/gtm.js?id=GTM-TN3KBF4",m.parentNode.insertBefore(r,m)}(window,document,"script","dataLayer")</script>


<link rel="search" type="application/opensearchdescription+xml" title="Deep Notes" href="/opensearch.xml">
<link rel="icon" href="/img/logo.webp">
<link rel="manifest" href="/manifest.json">
<meta name="theme-color" content="rgb(47, 133, 85)">

<script src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5616865131274062" async crossorigin="anonymous"></script><link rel="stylesheet" href="/assets/css/styles.1aa998db.css">
<script src="/assets/js/runtime~main.5cf98e5f.js" defer="defer"></script>
<script src="/assets/js/main.d4641f59.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TN3KBF4" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>

<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();null!==e?t(e):window.matchMedia("(prefers-color-scheme: dark)").matches?t("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,t("light"))}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.webp" alt="Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.webp" alt="Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Deep Notes</b></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/deepaksood619/deepaksood619.github.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/about-me/">About Me</a><button aria-label="Expand sidebar category &#x27;About Me&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/ai/">AI</a><button aria-label="Collapse sidebar category &#x27;AI&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/ai/big-data/">Big Data</a><button aria-label="Expand sidebar category &#x27;Big Data&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/ai/computer-vision-cv/">Computer Vision</a><button aria-label="Collapse sidebar category &#x27;Computer Vision&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ai/computer-vision-cv/convolutional-neural-network-cnn">Convolutional Neural Network (CNN)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ai/computer-vision-cv/cv-libraries-tools">CV - Libraries / Tools</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ai/computer-vision-cv/examples">Examples</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ai/computer-vision-cv/image-data-labeling-tools">Image / Data Labeling Tools</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ai/computer-vision-cv/image-formats">Image Formats</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ai/computer-vision-cv/imagemagick">ImageMagick</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ai/computer-vision-cv/intro">Computer Vision / CV Intro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/ai/computer-vision-cv/mnist-for-ml-beginners-tensorflow">MNIST For ML Beginners | TensorFlow</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ai/computer-vision-cv/model-building-stages">Model Building Stages</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ai/computer-vision-cv/others">Others</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ai/computer-vision-cv/pre-trained-models">Pre-Trained Models</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/ai/data-science/">Data Science</a><button aria-label="Expand sidebar category &#x27;Data Science&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/ai/data-visualization/">Data Visualization</a><button aria-label="Expand sidebar category &#x27;Data Visualization&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/ai/deep-learning/">Deep Learning</a><button aria-label="Expand sidebar category &#x27;Deep Learning&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ai/hackathons">Hackathons</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/ai/libraries/">Libraries</a><button aria-label="Expand sidebar category &#x27;Libraries&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/ai/llm/">ChatGPT / LLM</a><button aria-label="Expand sidebar category &#x27;ChatGPT / LLM&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/ai/ml-algorithms/">ML Algorithms</a><button aria-label="Expand sidebar category &#x27;ML Algorithms&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/ai/ml-fundamentals/">ML Fundamentals</a><button aria-label="Expand sidebar category &#x27;ML Fundamentals&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/ai/model-evaluation/">Model Evaluation</a><button aria-label="Expand sidebar category &#x27;Model Evaluation&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/ai/move-37/">Move37</a><button aria-label="Expand sidebar category &#x27;Move37&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/ai/nlp/">NLP</a><button aria-label="Expand sidebar category &#x27;NLP&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/ai/numpy/">Numpy</a><button aria-label="Expand sidebar category &#x27;Numpy&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ai/others-resources-interview-learning-courses">Others / Resources / Interview / Learning / Courses</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/ai/pandas/">Pandas</a><button aria-label="Expand sidebar category &#x27;Pandas&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/ai/scikit-learn/">Scikit Learn / Scipy</a><button aria-label="Expand sidebar category &#x27;Scikit Learn / Scipy&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ai/social-media-analytics-solution">Social Media Analytics Solution</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ai/solutions">Solutions</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/algorithms/">Algorithms</a><button aria-label="Expand sidebar category &#x27;Algorithms&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/book-summaries/">Book Summaries</a><button aria-label="Expand sidebar category &#x27;Book Summaries&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/cloud/">Cloud</a><button aria-label="Expand sidebar category &#x27;Cloud&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/computer-science/">Computer Science</a><button aria-label="Expand sidebar category &#x27;Computer Science&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/courses/">Courses / Certifications</a><button aria-label="Expand sidebar category &#x27;Courses / Certifications&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/data-structures/">Data Structures</a><button aria-label="Expand sidebar category &#x27;Data Structures&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/databases/">Databases</a><button aria-label="Expand sidebar category &#x27;Databases&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/decentralized-applications/">Decentralized Applications</a><button aria-label="Expand sidebar category &#x27;Decentralized Applications&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/devops/">DevOps</a><button aria-label="Expand sidebar category &#x27;DevOps&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/economics/">Economics</a><button aria-label="Expand sidebar category &#x27;Economics&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/frontend/">Frontend</a><button aria-label="Expand sidebar category &#x27;Frontend&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/knowledge/">Knowledge</a><button aria-label="Expand sidebar category &#x27;Knowledge&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/languages/">Languages</a><button aria-label="Expand sidebar category &#x27;Languages&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/management/">Management</a><button aria-label="Expand sidebar category &#x27;Management&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/mathematics/">Mathematics</a><button aria-label="Expand sidebar category &#x27;Mathematics&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/networking/">Networking</a><button aria-label="Expand sidebar category &#x27;Networking&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/psychology/">Psychology</a><button aria-label="Expand sidebar category &#x27;Psychology&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/python/">Python</a><button aria-label="Expand sidebar category &#x27;Python&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/">Deep Notes</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/technologies/">Technologies</a><button aria-label="Expand sidebar category &#x27;Technologies&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/ai/"><span itemprop="name">AI</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/ai/computer-vision-cv/"><span itemprop="name">Computer Vision</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">MNIST For ML Beginners | TensorFlow</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>MNIST For ML Beginners | TensorFlow</h1>
<p>When one learns how to program, there&#x27;s a tradition that the first thing you do is print &quot;Hello World.&quot; Just like programming has Hello World, machine learning has MNIST.</p>
<p>MNIST is a simple computer vision dataset. It consists of images of handwritten digits like these:</p>
<p><img loading="lazy" alt="image" src="data:image/jpeg;base64,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" width="636" height="159" class="img_ev3q"></p>
<p>It also includes labels for each image, telling us which digit it is. For example, the labels for the above images are 5, 0, 4, and 1.</p>
<p>In this tutorial, we&#x27;re going to train a model to look at images and predict what digits they are. We&#x27;re going to start with a very simple model, called a Softmax Regression.</p>
<p>The actual code for this tutorial is very short, and all the interesting stuff happens in just three lines. However, it is very important to understand the ideas behind it: both how TensorFlow works and the core machine learning concepts. Because of this, we are going to very carefully work through the code.</p>
<p>What we will accomplish in this tutorial:</p>
<ul>
<li>Learn about the MNIST data and softmax regressions</li>
<li>Create a function that is a model for recognizing digits, based on looking at every pixel in the image</li>
<li>Use TensorFlow to train the model to recognize digits by having it &quot;look&quot; at thousands of examples (and run our first TensorFlow session to do so)</li>
<li>Check the model&#x27;s accuracy with our test data</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="the-mnist-data">The MNIST Data<a href="#the-mnist-data" class="hash-link" aria-label="Direct link to The MNIST Data" title="Direct link to The MNIST Data">​</a></h3>
<p>The MNIST data is hosted on <a href="http://yann.lecun.com/exdb/mnist/" target="_blank" rel="noopener noreferrer">Yann LeCun&#x27;s website</a>. If you are copying and pasting in the code from this tutorial, start here with these two lines of code which will download and read in the data automatically:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> tensorflow</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">examples</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tutorials</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">mnist </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> input_data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mnist </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> input_data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">read_data_sets</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;MNIST_data/&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> one_hot</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The MNIST data is split into three parts: 55,000 data points of training data (mnist.train), 10,000 points of test data (mnist.test), and 5,000 points of validation data (mnist.validation). This split is very important: it&#x27;s essential in machine learning that we have separate data which we don&#x27;t learn from so that we can make sure that what we&#x27;ve learned actually generalizes!</p>
<p>As mentioned earlier, every MNIST data point has two parts: an image of a handwritten digit and a corresponding label. We&#x27;ll call the images &quot;x&quot; and the labels &quot;y&quot;. Both the training set and test set contain images and their corresponding labels; for example the training images are mnist.train.images and the training labels are mnist.train.labels.</p>
<p>Each image is 28 pixels by 28 pixels. We can interpret this as a big array of numbers:</p>
<p><img loading="lazy" alt="image" src="/assets/images/Computer-Vision-CV_MNIST-For-ML-Beginners-TensorFlow-image2-afc89d8ea1a6d4a962aaa922ed05753e.jpg" width="982" height="387" class="img_ev3q"></p>
<p>We can flatten this array into a vector of 28x28 = 784 numbers. It doesn&#x27;t matter how we flatten the array, as long as we&#x27;re consistent between images. From this perspective, the MNIST images are just a bunch of points in a 784-dimensional vector space, with a <a href="https://colah.github.io/posts/2014-10-Visualizing-MNIST/" target="_blank" rel="noopener noreferrer">very rich structure</a> (warning: computationally intensive visualizations).</p>
<p>Flattening the data throws away information about the 2D structure of the image. Isn&#x27;t that bad? Well, the best computer vision methods do exploit this structure, and we will in later tutorials. But the simple method we will be using here, a softmax regression (defined below), won&#x27;t.</p>
<p>The result is that mnist.train.images is a tensor (an n-dimensional array) with a shape of [55000, 784]. The first dimension is an index into the list of images and the second dimension is the index for each pixel in each image. Each entry in the tensor is a pixel intensity between 0 and 1, for a particular pixel in a particular image.</p>
<p><img loading="lazy" alt="image" src="/assets/images/Computer-Vision-CV_MNIST-For-ML-Beginners-TensorFlow-image3-5f2939bf2742d577bae05507e3fec724.jpg" width="1498" height="678" class="img_ev3q"></p>
<p>Each image in MNIST has a corresponding label, a number between 0 and 9 representing the digit drawn in the image.</p>
<p>For the purposes of this tutorial, we&#x27;re going to want our labels as &quot;one-hot vectors&quot;. A one-hot vector is a vector which is 0 in most dimensions, and 1 in a single dimension. In this case, the nth digit will be represented as a vector which is 1 in the nth dimension. For example, 3 would be [0,0,0,1,0,0,0,0,0,0]. Consequently, mnist.train.labels is a [55000, 10] array of floats.</p>
<p><img loading="lazy" alt="image" src="/assets/images/Computer-Vision-CV_MNIST-For-ML-Beginners-TensorFlow-image4-7e60b6fe98acf75213d407d7a00a08ab.jpg" width="1460" height="505" class="img_ev3q"></p>
<p>We&#x27;re now ready to actually make our model!</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="softmax-regressions">Softmax Regressions<a href="#softmax-regressions" class="hash-link" aria-label="Direct link to Softmax Regressions" title="Direct link to Softmax Regressions">​</a></h3>
<p>We know that every image in MNIST is of a handwritten digit between zero and nine. So there are only ten possible things that a given image can be. We want to be able to look at an image and give the probabilities for it being each digit. For example, our model might look at a picture of a nine and be 80% sure it&#x27;s a nine, but give a 5% chance to it being an eight (because of the top loop) and a bit of probability to all the others because it isn&#x27;t 100% sure.</p>
<p>This is a classic case where a softmax regression is a natural, simple model. If you want to assign probabilities to an object being one of several different things, softmax is the thing to do, because softmax gives us a list of values between 0 and 1 that add up to 1. Even later on, when we train more sophisticated models, the final step will be a layer of softmax.</p>
<p>A softmax regression has two steps: first we add up the evidence of our input being in certain classes, and then we convert that evidence into probabilities.</p>
<p>To tally up the evidence that a given image is in a particular class, we do a weighted sum of the pixel intensities. The weight is negative if that pixel having a high intensity is evidence against the image being in that class, and positive if it is evidence in favor.</p>
<p>The following diagram shows the weights one model learned for each of these classes. Red represents negative weights, while blue represents positive weights.</p>
<p><img loading="lazy" alt="image" src="/assets/images/Computer-Vision-CV_MNIST-For-ML-Beginners-TensorFlow-image5-58acc90928d5452e4ced5e762d7cd47b.jpg" width="1145" height="575" class="img_ev3q"></p>
<p>We also add some extra evidence called a bias. Basically, we want to be able to say that some things are more likely independent of the input. The result is that the evidence for a class i given an input x is:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">evidencei</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">∑jWi</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> jxj</span><span class="token operator" style="color:#393A34">+</span><span class="token plain">bi</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>where Wi is the weights and bi is the bias for class i, and j is an index for summing over the pixels in our input image x. We then convert the evidence tallies into our predicted probabilities y using the &quot;softmax&quot; function:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">y</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">softmax</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">evidence</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Here softmax is serving as an &quot;activation&quot; or &quot;link&quot; function, shaping the output of our linear function into the form we want -- in this case, a probability distribution over 10 cases. You can think of it as converting tallies of evidence into probabilities of our input being in each class. It&#x27;s defined as:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">softmax</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">evidence</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">normalize</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">exp⁡</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">evidence</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>If you expand that equation out, you get:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">softmax</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">evidence</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">i</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">exp⁡</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">evidencei</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">∑jexp⁡</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">evidencej</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>But it&#x27;s often more helpful to think of softmax the first way: exponentiating its inputs and then normalizing them. The exponentiation means that one more unit of evidence increases the weight given to any hypothesis multiplicatively. And conversely, having one less unit of evidence means that a hypothesis gets a fraction of its earlier weight. No hypothesis ever has zero or negative weight. Softmax then normalizes these weights, so that they add up to one, forming a valid probability distribution. (To get more intuition about the softmax function, check out the <a href="http://neuralnetworksanddeeplearning.com/chap3.html#softmax" target="_blank" rel="noopener noreferrer">section</a> on it in Michael Nielsen&#x27;s book, complete with an interactive visualization.)</p>
<p>You can picture our softmax regression as looking something like the following, although with a lot more xs. For each output, we compute a weighted sum of the xs, add a bias, and then apply softmax.</p>
<p><img loading="lazy" alt="image" src="/assets/images/Computer-Vision-CV_MNIST-For-ML-Beginners-TensorFlow-image6-689074d2f83aae45129c983b99236536.jpg" width="1378" height="550" class="img_ev3q"></p>
<p>If we write that out as equations, we get:</p>
<p><img loading="lazy" alt="image" src="/assets/images/Computer-Vision-CV_MNIST-For-ML-Beginners-TensorFlow-image7-9af7ff5868415e1cd76b1fb44bfda1c1.jpg" width="1377" height="314" class="img_ev3q"></p>
<p>We can &quot;vectorize&quot; this procedure, turning it into a matrix multiplication and vector addition. This is helpful for computational efficiency. (It&#x27;s also a useful way to think.)</p>
<p><img loading="lazy" alt="image" src="/assets/images/Computer-Vision-CV_MNIST-For-ML-Beginners-TensorFlow-image8-a3f01283a153ea6db7add514316a8df1.jpg" width="1378" height="334" class="img_ev3q"></p>
<p>More compactly, we can just write:</p>
<p><code>y=softmax(Wx+b)</code></p>
<p>Now let&#x27;s turn that into something that TensorFlow can use.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="implementing-the-regression">Implementing the Regression<a href="#implementing-the-regression" class="hash-link" aria-label="Direct link to Implementing the Regression" title="Direct link to Implementing the Regression">​</a></h2>
<p>To do efficient numerical computing in Python, we typically use libraries like <a href="http://www.numpy.org/" target="_blank" rel="noopener noreferrer">NumPy</a> that do expensive operations such as matrix multiplication outside Python, using highly efficient code implemented in another language. Unfortunately, there can still be a lot of overhead from switching back to Python every operation. This overhead is especially bad if you want to run computations on GPUs or in a distributed manner, where there can be a high cost to transferring data.</p>
<p>TensorFlow also does its heavy lifting outside Python, but it takes things a step further to avoid this overhead. Instead of running a single expensive operation independently from Python, TensorFlow lets us describe a graph of interacting operations that run entirely outside Python. (Approaches like this can be seen in a few machine learning libraries.)</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># To use TensorFlow, first we need to import it.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> tensorflow </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> tf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># We describe these interacting operations by manipulating symbolic variables. Let&#x27;s create one:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">x </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> tf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">placeholder</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">float32</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token boolean" style="color:#36acaa">None</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">784</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>x isn&#x27;t a specific value. It&#x27;s a placeholder, a value that we&#x27;ll input when we ask TensorFlow to run a computation. We want to be able to input any number of MNIST images, each flattened into a 784-dimensional vector. We represent this as a 2-D tensor of floating-point numbers, with a shape [None, 784]. (Here None means that a dimension can be of any length.)</p>
<p>We also need the weights and biases for our model. We could imagine treating these like additional inputs, but TensorFlow has an even better way to handle it: Variable. A Variable is a modifiable tensor that lives in TensorFlow&#x27;s graph of interacting operations. It can be used and even modified by the computation. For machine learning applications, one generally has the model parameters be Variables.</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">W </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> tf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Variable</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">zeros</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">784</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">b </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> tf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Variable</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">zeros</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>We create these Variables by giving tf.Variable the initial value of the Variable: in this case, we initialize both W and b as tensors full of zeros. Since we are going to learn W and b, it doesn&#x27;t matter very much what they initially are.</p>
<p>Notice that W has a shape of [784, 10] because we want to multiply the 784-dimensional image vectors by it to produce 10-dimensional vectors of evidence for the difference classes. b has a shape of [10] so we can add it to the output.</p>
<p>We can now implement our model. It only takes one line to define it!</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">y </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> tf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">nn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">softmax</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">matmul</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> W</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> b</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>First, we multiply x by W with the expression tf.matmul(x, W). This is flipped from when we multiplied them in our equation, where we had Wx, as a small trick to deal with x being a 2D tensor with multiple inputs. We then add b, and finally apply tf.nn.softmax.</p>
<p>That&#x27;s it. It only took us one line to define our model, after a couple short lines of setup. That isn&#x27;t because TensorFlow is designed to make a softmax regression particularly easy: it&#x27;s just a very flexible way to describe many kinds of numerical computations, from machine learning models to physics simulations. And once defined, our model can be run on different devices: your computer&#x27;s CPU, GPUs, and even phones!</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="training">Training<a href="#training" class="hash-link" aria-label="Direct link to Training" title="Direct link to Training">​</a></h2>
<p>In order to train our model, we need to define what it means for the model to be good. Well, actually, in machine learning we typically define what it means for a model to be bad. We call this the cost, or the loss, and it represents how far off our model is from our desired outcome. We try to minimize that error, and the smaller the error margin, the better our model is.</p>
<p>One very common, very nice function to determine the loss of a model is called &quot;cross-entropy.&quot; Cross-entropy arises from thinking about information compressing codes in information theory but it winds up being an important idea in lots of areas, from gambling to machine learning. It&#x27;s defined as:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Hy′</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">y</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">−∑iyi′log⁡</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">yi</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Where y is our predicted probability distribution, and y′ is the true distribution (the one-hot vector with the digit labels). In some rough sense, the cross-entropy is measuring how inefficient our predictions are for describing the truth. Going into more detail about cross-entropy is beyond the scope of this tutorial, but it&#x27;s well worth <a href="https://colah.github.io/posts/2015-09-Visual-Information" target="_blank" rel="noopener noreferrer">understanding</a>.</p>
<p>To implement cross-entropy we need to first add a new placeholder to input the correct answers:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">y_ </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> tf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">placeholder</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">float32</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token boolean" style="color:#36acaa">None</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Then we can implement the cross</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">entropy function</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> −∑y′log⁡</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">y</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cross_entropy </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> tf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">reduce_mean</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">tf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">reduce_sum</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">y_ </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> tf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">y</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> reduction_indices</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>First, tf.log computes the logarithm of each element of y. Next, we multiply each element of y_with the corresponding element of tf.log(y). Then tf.reduce_sum adds the elements in the second dimension of y, due to the reduction_indices=[1] parameter. Finally, tf.reduce_mean computes the mean over all the examples in the batch.</p>
<p>Note that in the source code, we don&#x27;t use this formulation, because it is numerically unstable. Instead, we apply tf.nn.softmax_cross_entropy_with_logits on the unnormalized logits (e.g., we call softmax_cross_entropy_with_logits on tf.matmul(x, W) + b), because this more numerically stable function internally computes the softmax activation. In your code, consider using tf.nn.softmax_cross_entropy_with_logits instead.</p>
<p>Now that we know what we want our model to do, it&#x27;s very easy to have TensorFlow train it to do so. Because TensorFlow knows the entire graph of your computations, it can automatically use the <a href="https://colah.github.io/posts/2015-08-Backprop" target="_blank" rel="noopener noreferrer">backpropagation algorithm</a> to efficiently determine how your variables affect the loss you ask it to minimize. Then it can apply your choice of optimization algorithm to modify the variables and reduce the loss.</p>
<p>train_step = tf.train.GradientDescentOptimizer(0.5).minimize(cross_entropy)</p>
<p>In this case, we ask TensorFlow to minimize cross_entropy using the <a href="https://en.wikipedia.org/wiki/Gradient_descent" target="_blank" rel="noopener noreferrer">gradient descent algorithm</a> with a learning rate of 0.5. Gradient descent is a simple procedure, where TensorFlow simply shifts each variable a little bit in the direction that reduces the cost. But TensorFlow also provides <a href="https://www.tensorflow.org/api_guides/python/train#Optimizers" target="_blank" rel="noopener noreferrer">many other optimization algorithms</a>: using one is as simple as tweaking one line.</p>
<p>What TensorFlow actually does here, behind the scenes, is to add new operations to your graph which implement backpropagation and gradient descent. Then it gives you back a single operation which, when run, does a step of gradient descent training, slightly tweaking your variables to reduce the loss.</p>
<p>We can now launch the model in an InteractiveSession:</p>
<p><code>sess = tf.InteractiveSession()</code></p>
<p>We first have to create an operation to initialize the variables we created:</p>
<p><code>tf.global_variables_initializer().run()</code></p>
<p>Let&#x27;s train -- we&#x27;ll run the training step 1000 times!</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> _ </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token builtin">range</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1000</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> batch_xs</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> batch_ys </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> mnist</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">train</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">next_batch</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">100</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> sess</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">run</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">train_step</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> feed_dict</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> batch_xs</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> y_</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> batch_ys</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Each step of the loop, we get a &quot;batch&quot; of one hundred random data points from our training set. We run train_step feeding in the batches data to replace the placeholders.</p>
<p>Using small batches of random data is called stochastic training -- in this case, stochastic gradient descent. Ideally, we&#x27;d like to use all our data for every step of training because that would give us a better sense of what we should be doing, but that&#x27;s expensive. So, instead, we use a different subset every time. Doing this is cheap and has much of the same benefit.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="evaluating-our-model">Evaluating Our Model<a href="#evaluating-our-model" class="hash-link" aria-label="Direct link to Evaluating Our Model" title="Direct link to Evaluating Our Model">​</a></h2>
<p>How well does our model do?</p>
<p>Well, first let&#x27;s figure out where we predicted the correct label. tf.argmax is an extremely useful function which gives you the index of the highest entry in a tensor along some axis. For example, tf.argmax(y,1) is the label our model thinks is most likely for each input, while tf.argmax(y_,1) is the correct label. We can use tf.equal to check if our prediction matches the truth.</p>
<p><code>correct_prediction = tf.equal(tf.argmax(y,1), tf.argmax(y_,1))</code></p>
<p>That gives us a list of booleans. To determine what fraction are correct, we cast to floating point numbers and then take the mean. For example, [True, False, True, True] would become [1,0,1,1] which would become 0.75.</p>
<p><code>accuracy = tf.reduce_mean(tf.cast(correct_prediction, tf.float32))</code></p>
<p>Finally, we ask for our accuracy on our test data.</p>
<p><code>print(sess.run(accuracy, feed_dict={x: mnist.test.images, y_: mnist.test.labels}))</code></p>
<p>This should be about 92%.</p>
<p>Is that good? Well, not really. In fact, it&#x27;s pretty bad. This is because we&#x27;re using a very simple model. With some small changes, we can get to 97%. The best models can get to over 99.7% accuracy! (For more information, have a look at this <a href="https://rodrigob.github.io/are_we_there_yet/build/classification_datasets_results" target="_blank" rel="noopener noreferrer">list of results</a>.)</p>
<p>What matters is that we learned from this model. Still, if you&#x27;re feeling a bit down about these results, check out <a href="https://www.tensorflow.org/get_started/mnist/pros" target="_blank" rel="noopener noreferrer">the next tutorial</a> where we do a lot better, and learn how to build more sophisticated models using TensorFlow!</p>
<p><a href="https://www.tensorflow.org/get_started/mnist/beginners" target="_blank" rel="noopener noreferrer">https://www.tensorflow.org/get_started/mnist/beginners</a></p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/deepaksood619/deepaksood619.github.io/tree/master/docs/ai/computer-vision-cv/mnist-for-ml-beginners-tensorflow.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2024-02-05T13:06:14.000Z">Feb 5, 2024</time></b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/ai/computer-vision-cv/intro"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Computer Vision / CV Intro</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/ai/computer-vision-cv/model-building-stages"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Model Building Stages</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#the-mnist-data" class="table-of-contents__link toc-highlight">The MNIST Data</a></li><li><a href="#softmax-regressions" class="table-of-contents__link toc-highlight">Softmax Regressions</a></li><li><a href="#implementing-the-regression" class="table-of-contents__link toc-highlight">Implementing the Regression</a></li><li><a href="#training" class="table-of-contents__link toc-highlight">Training</a></li><li><a href="#evaluating-our-model" class="table-of-contents__link toc-highlight">Evaluating Our Model</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 Deep Notes, Built with ❤️</div></div></div></footer></div>
</body>
</html>