"use strict";(self.webpackChunkdeep_notes=self.webpackChunkdeep_notes||[]).push([[5054],{840391:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>r,default:()=>p,frontMatter:()=>c,metadata:()=>o,toc:()=>i});var s=t(785893),a=t(511151);const c={},r="kubectl Commands",o={id:"devops/kubernetes/kubectl-commands",title:"kubectl Commands",description:"Debugging",source:"@site/docs/devops/kubernetes/kubectl-commands.md",sourceDirName:"devops/kubernetes",slug:"/devops/kubernetes/kubectl-commands",permalink:"/devops/kubernetes/kubectl-commands",draft:!1,unlisted:!1,editUrl:"https://github.com/deepaksood619/deepaksood619.github.io/tree/master/docs/devops/kubernetes/kubectl-commands.md",tags:[],version:"current",lastUpdatedAt:1734460808,formattedLastUpdatedAt:"Dec 17, 2024",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"KEDA",permalink:"/devops/kubernetes/keda"},next:{title:"KubeEdge",permalink:"/devops/kubernetes/kubeedge"}},l={},i=[{value:"Debugging",id:"debugging",level:2},{value:"Commands",id:"commands",level:2},{value:"<code>kubectl [command] [TYPE] [NAME] [flags]</code>",id:"kubectl-command-type-name-flags",level:3},{value:"Basic Commands (Beginner)",id:"basic-commands-beginner",level:2},{value:"create",id:"create",level:3},{value:"expose",id:"expose",level:3},{value:"run",id:"run",level:3},{value:"set",id:"set",level:3},{value:"Basic Commands (Intermediate)",id:"basic-commands-intermediate",level:2},{value:"get Display one or many resources",id:"get-display-one-or-many-resources",level:3},{value:"Troubleshooting and Debugging Commands",id:"troubleshooting-and-debugging-commands",level:2},{value:"Patch",id:"patch",level:3},{value:"Other Commands",id:"other-commands",level:2},{value:"api-resources",id:"api-resources",level:3},{value:"config",id:"config",level:3},{value:"version",id:"version",level:3},{value:"options",id:"options",level:3},{value:"Usage",id:"usage",level:3},{value:"Commands",id:"commands-1",level:2},{value:"Experimental commands",id:"experimental-commands",level:2},{value:"Kubectl dashboard",id:"kubectl-dashboard",level:2},{value:"Kubernetes dashboard",id:"kubernetes-dashboard",level:3},{value:"Decoding a Secret",id:"decoding-a-secret",level:3},{value:"Example - Counter every 1 sec",id:"example---counter-every-1-sec",level:2},{value:"Kubectl apply vs create",id:"kubectl-apply-vs-create",level:3},{value:"Tab Completion in iterm zsh / Auto complete",id:"tab-completion-in-iterm-zsh--auto-complete",level:3},{value:"Storage Class",id:"storage-class",level:3},{value:"Cleanup / clean up commands",id:"cleanup--clean-up-commands",level:2},{value:"Requests and Limits",id:"requests-and-limits",level:2},{value:"References",id:"references",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.a)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h1,{id:"kubectl-commands",children:"kubectl Commands"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"kgpo -A --watch | ts '[%Y-%m-%d %H:%M:%S]'\nk rollout restart deployment/ticket-api -n prod\n\nkubectl run test --rm -it --image get -- bash\nkubectl run test --rm -it --image python:3.8 -- bash\nkubectl run test --rm -it --image curlimages/curl -- sh\nkubectl run nginx --image=nginx --restart=Never -n test\nkubectl run nginx --image=nginx:1.17.4 --restart=Never --port=80\nkubectl run busybox --image=busybox --restart=Never -- ls\nkubectl run busybox --image=busybox --restart=Never -- /bin/sh -c \"sleep 3600\"\nkubectl run busybox --image=nginx --restart=Never -it --rm -- echo \"How are you\"\nkubectl run busybox --image=nginx --restart=Never -it --rm -- sh\nkubectl run nginx --image=nginx --restart=Never --port=80 --expose\nkubectl run nginx --image=nginx --restart=Never --requests='cpu=100m,memory=256Mi' --limits='cpu=200m,memory=512Mi'\nkubectl run nginx --image=nginx --restart=Never --serviceaccount=myuser\nkubectl run nginx1 --image=nginx --restart=Never --labels=app=v1\n\nkubectl exec -it troubleshoot- -- /bin/sh\nkubectl exec -it busybox -- wget -o- <IP Address>\n\nkubectl create deploy nginx --image=nginx --dry-run -o yaml\nkubectl create quota myrq --hard=cpu=1,memory=1G,pods=2 --dry-run -o yaml\nkubectl create configmap config --from-literal=foo=lala --from-literal=foo2=lolo\nkubectl create cm config2 --from-file=config.txt\nkubectl create cm config4 --from-file=special=config4.txt\nkubectl create cm config3 --from-env-file=config.env\nkubectl create secret generic mysecret --from-literal=password=mypass\nkubectl create secret generic mysecret2 --from-file=username\nkubectl create sa myuser\nkubectl create job pi --image=perl -- perl -Mbignum=bpi -wle 'print bpi(2000)'\nkubectl create cronjob busybox --image=busybox --schedule=\"*/1 * * * *\" -- /bin/sh -c 'date; echo Hello from the Kubernetes cluster'\n\nkubectl expose deploy foo --port=6262 --target-port=8080\n\nkubectl delete po nginx --grace-period=0 --force\nkubectl delete deploy/nginx hpa/nginx\n\nkubectl get po nginx --v=7 (6 to 10)\nkubectl get po nginx --show-labels\nkubectl get po -l app\nkubectl get po --label-columns=app\n\nkubectl get po -l app=v2\nkubectl get po -l 'app in (v2,v1)'\nkubectl get po --selector=app=v2\nkubectl get pods --sort-by=.metadata.name (sorted by name)\nkubectl get pods --sort-by=.metadata.creationTimestamp (sorted by creationTimestamp)\nkubectl get po -o=custom-columns=\"POD_NAME:.metadata.name, POD_STATUS:.status.containerStatuses[].state\" (custom columns)\n\n# Annotations\nkubectl annotate po nginx1 nginx2 nginx3 description='my description'\nkubectl get pods -o custom-columns=Name:metadata.name,ANNOTATIONS:metadata.annotations.description\nkubectl describe po nginx1 | grep -i 'annotations'\nkubectl annotate po nginx{1..3} description-\n\nkubectl label po nginx app=nginx\nkubectl label po nginx1 nginx2 nginx3 app-\nkubectl label po nginx{1..3} app-\nkubectl label po -l app app-\n\nkubectl label po nginx2 app=v2 --overwrite\n\n# Rollouts / rollbacks\nkubectl set image pod/nginx nginx=nginx:1.15-alpine\nkubectl rollout status deploy nginx\nkubectl rollout history deploy nginx\nkubectl rollout history deploy nginx --revision=4\n\nkubectl rollout undo deploy nginx\nkubectl rollout undo deploy nginx --to-revision=2\n\nkubectl rollout pause deploy nginx\nkubectl rollout resume deploy nginx\nkubectl rollout restart deployment/frontend #Rolling restart of frontend deploy\n\nkubectl scale deploy nginx --replicas=5\nkubectl scale sts airflow-worker --replicas=5\n\nkubectl autoscale deploy nginx --min=5 --max=10 --cpu-percent=80\n\nkubectl explain po.spec\n\nkubectl top pod busybox --containers > file.log\n\nwget -O- http://10.1.0.89:8080\n\n"})}),"\n",(0,s.jsx)(n.h2,{id:"debugging",children:"Debugging"}),"\n",(0,s.jsx)(n.p,{children:"exit code=137 means that either (1) something killed the container that hosted the TE or (2) something killed the process with SIGKILL (kill -9) (We can figure that out by taking theexit codeand deduct 128 from it to get the actual signal number, i.e.137-128=9)"}),"\n",(0,s.jsx)(n.h2,{id:"commands",children:"Commands"}),"\n",(0,s.jsx)(n.h3,{id:"kubectl-command-type-name-flags",children:(0,s.jsx)(n.code,{children:"kubectl [command] [TYPE] [NAME] [flags]"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"command"}),": Specifies the operation that you want to perform on one or more resources, for example ",(0,s.jsx)(n.strong,{children:"create"}),", ",(0,s.jsx)(n.strong,{children:"get"}),", ",(0,s.jsx)(n.strong,{children:"describe"}),", ",(0,s.jsx)(n.strong,{children:"delete"}),"."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"TYPE"}),": Specifies the ",(0,s.jsx)(n.a,{href:"https://kubernetes.io/docs/reference/kubectl/overview/#resource-types",children:"resource type"}),". Resource types are case-insensitive and you can specify the singular, plural, or abbreviated forms."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"NAME"}),": Specifies the name of the resource. Names are case-sensitive. If the name is omitted, details for all resources are displayed, for example ",(0,s.jsx)(n.code,{children:"$ kubectl get pods"})]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"flags"}),": Specifies optional flags. For example, you can use the ",(0,s.jsx)(n.strong,{children:"-s"})," or ",(0,s.jsx)(n.strong,{children:"--server"})," flags to specify the address and port of the Kubernetes API server."]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"basic-commands-beginner",children:"Basic Commands (Beginner)"}),"\n",(0,s.jsx)(n.h3,{id:"create",children:"create"}),"\n",(0,s.jsx)(n.p,{children:"Create a resource from a file or from stdin"}),"\n",(0,s.jsx)(n.p,{children:"Imperative management of kubernetes objects using configuration files"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"kubectl create deploy nginx --image nginx:latest\nkubectl create deploy python-test --image python:3.8\nkubectl create deployment troubleshoot --image=nginx\nkubectl create job --from=cronjob/loanetl loanetl-manual-002 -n apps\nkubectl create secret tls example-com-tls --cert=tls.crt --key=tls.key\nkubectl create secret tls ca-key-pair --key=ca.key --cert=ca.crt\n\n# Create a pod based on the JSON passed into stdin\ncat pod.json | kubectl create -f -\n\n# Edit the data in docker-registry.yaml in JSON then create the resource using the edited data\n\nkubectl create -f docker-registry.yaml --edit -o json\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"clusterrole Create a ClusterRole."}),"\n",(0,s.jsx)(n.li,{children:"clusterrolebinding Create a ClusterRoleBinding for a particular ClusterRole"}),"\n",(0,s.jsx)(n.li,{children:"configmap Create a configmap from a local file, directory or literal value"}),"\n",(0,s.jsx)(n.li,{children:"cronjob Create a cronjob with the specified name."}),"\n",(0,s.jsx)(n.li,{children:"deployment Create a deployment with the specified name."}),"\n",(0,s.jsx)(n.li,{children:"job Create a job with the specified name."}),"\n",(0,s.jsx)(n.li,{children:"namespace Create a namespace with the specified name"}),"\n",(0,s.jsx)(n.li,{children:"poddisruptionbudget Create a pod disruption budget with the specified name."}),"\n",(0,s.jsx)(n.li,{children:"priorityclass Create a priorityclass with the specified name."}),"\n",(0,s.jsx)(n.li,{children:"quota Create a quota with the specified name."}),"\n",(0,s.jsx)(n.li,{children:"role Create a role with single rule."}),"\n",(0,s.jsx)(n.li,{children:"rolebinding Create a RoleBinding for a particular Role or ClusterRole"}),"\n",(0,s.jsx)(n.li,{children:"secret Create a secret using specified subcommand"}),"\n",(0,s.jsx)(n.li,{children:"service Create a service using specified subcommand."}),"\n",(0,s.jsx)(n.li,{children:"serviceaccount Create a service account with the specified name"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"expose",children:"expose"}),"\n",(0,s.jsx)(n.p,{children:"Take a replication controller, service, deployment or pod and expose it as a new Kubernetes Service"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'kubectl expose deployment hello-nginx --type=NodePort\nkubectl expose deployment hello-server --type="LoadBalancer"\n'})}),"\n",(0,s.jsx)(n.h3,{id:"run",children:"run"}),"\n",(0,s.jsx)(n.p,{children:"Run a particular image on the cluster"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"kubectl run hello-nginx --image=nginx --port=80\nkubectl run -t -i kub-log --image=deepaksood619/kubernetes_logger:latest\n"})}),"\n",(0,s.jsx)(n.h3,{id:"set",children:"set"}),"\n",(0,s.jsx)(n.p,{children:"Set specific features on objects"}),"\n",(0,s.jsx)(n.p,{children:'run-container Run a particular image on the cluster. This command is deprecated, use "run" instead'}),"\n",(0,s.jsx)(n.h2,{id:"basic-commands-intermediate",children:"Basic Commands (Intermediate)"}),"\n",(0,s.jsx)(n.h3,{id:"get-display-one-or-many-resources",children:"get Display one or many resources"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"kubectl get nodes"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'# show public ip of nodes\nkubectl get nodes -o wide | awk {\'print $1" " $2 " " $7\'} | column -t\nkubectl get pods -o wide\nkubectl get pods --show-labels\nkubectl get deployments\nkubectl get services\nkubectl get replicasets\nkubectl get svc\n\nkubectl get events\nkubectl get events --watch\n\nkubectl get crd\nkubectl get endpoints (ep)\nkubectl get pods -A (kubectl get pods --all-namespaces)\n\n-w for watch\n\n## explain Documentation of resources\nkubectl explain deployment\nkubectl explain deployment --recursive\nkubectl explain deployment.spec.strategy\nkubectl explain deploy.spec.strategy (works with short names too)\n\nedit Edit a resource on the server\n\n## delete Delete resources by filenames, stdin, resources and names, or by resources and label selector\n\nkubectl delete service -l run=kubernetes-bootcamp\nkubectl delete deployment hello-python\nkubectl delete daemonsets,replicasets,services,deployments,pods,rc,pvc,cm --all\n\n## Deploy Commands\n\n## rollout Manage the rollout of a resource\n\nrolling-update Perform a rolling update of the given ReplicationController\nk rollout history deployment.v1.apps/kg-kong -n kong\nk rollout undo deployment.v1.apps/kg-kong -n kong\n\n## *scale* Set a new size for a Deployment, ReplicaSet, Replication Controller, or Job\n\nkubectl scale --replicas=3 deployment/hello-nginx\nkubectl scale --replicas=10 deployment/kub-log\n\n## autoscale Auto-scale a Deployment, ReplicaSet, or ReplicationController\n\nkubectl autoscale deployment foo --min=2 --max=10 --cpu-percent=70\n\n# Autoscale pod foo with a minimum of 2 and maximum of 10 replicas when CPU utilization is equal to or greater than 70%\n\n## Cluster Management Commands\n\ncertificate Modify certificate resources.\n\n## *cluster-info* Display cluster info\n\n## top Display Resource (CPU/Memory/Storage) usage\n\nkubectl top node\nkubectl top pod\nkubectl top pod --namespace=NAMESPACE\nkubectl top pod c360-production-598cf9c859-5jlx5 --containers\nkubectl top po -A --sort-by=cpu\nkubectl top po -A --sort-by=memory\n\n## cordon Mark node as unschedulable. Used for maintenance of cluster\n\n## uncordon Mark node as schedulable. Used after maintenance\n\n## drain Drain node. Removes pods from node via graceful termination for maintenance\n\nkubectl drain aks-agentpool-10140213-9 --ignore-daemonsets\n\n## taint Update the taints on one or more nodes. Taint a node so they can only run dedicated workloads or certain pods that need specialized hardware\n\nkubectl taint nodes aks-agentpool-10140213-9 node=historical:NoSchedule\n\n# to overwrite previous taint\n\nkubectl taint nodes --overwrite aks-agentpool-10140213-0 node=example-0:NoSchedule\n\n# to remove a taint\nkubectl taint nodes aks-agentpool-10140213-9 node=NoSchedule-\n\ntolerations:\n- key: "key"\noperator: "Equal"\nvalue: "value"\neffect: "NoSchedule"\n'})}),"\n",(0,s.jsx)(n.h2,{id:"troubleshooting-and-debugging-commands",children:"Troubleshooting and Debugging Commands"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'*describe* Show details of a specific resource or group of resources\n\nkubectl describe node\nkubectl describe pod\nkubectl describe pod <pod_name> #get pod name using kubectl get pods\nkubectl describe service hello-nginx\nkubectl describe deployments <deployment_name>\n\n## logs Print the logs for a container in a pod\n\nkubectl logs counter\nkubectl logs --previous counter # --previous command to retrieve logs from a previous instantiation of a container\nkubectl logs -p alert-trent-7c55c54cb-6gjhc -n consumers\nkubectl logs --since-time=\'2019-04-23T12:30:36.750121287Z\' --timestamps ke-cp-kafka-connect658bfcd6fb-852fv -c cp-kafka-connect-server -n kafka\nkubectl logs busybox\nkubectl logs busybox -p #previous logs\nklo -l app=admin-panel -c celery -n prod --prefix\n\n## attach Attach to a running container\nkubectl attach -it kafka-manager-5f54d74d89-mdxh4 -n kafka\n\n## exec Execute a command in a container\nkubectl exec monolith --stdin --tty -c monolith /bin/sh\nkubectl exec -it druid-republisher-fd8bb77bd-zgjf7 -- /bin/bash\nkubectl exec -n kafka -it my-kafka-connect-cp-kafka-connect-5ff6d9758d-gjk22 -c cp-kafka-connect-server -- /bin/bash\nkubectl exec example-0 cfurl http://10.8.0.1:9101\n\n## port-forward Forward one or more local ports to a pod\n\nkubectl port-forward svc/emqx-service 18083:18083 --namespace kube-system\nkubectl port-forward svc/kafka-manager 8000:80 -n kafka\nkubectl port-forward <service_name> <host_port>:<service_running_port> -n kafka\n\nproxy Run a proxy to the Kubernetes API server\n\ncp Copy files and directories to and from containers\nkubectl cp busybox:/etc/passwd ./passwd\n\n# copy data from container to local\nkubectl cp prod/admin-panel-0:/app/dumpdata.sql Downloads/Office/backup/dumpdata.sql\n\n# Copy /tmp/foo_dir local directory to /tmp/bar_dir in a remote pod in the default namespace\nkubectl cp /tmp/foo_dir<some-pod>:/tmp/bar_dir\n\n# Copy /tmp/foo local file to /tmp/bar in a remote pod in a specific container\nkubectl cp/tmp/foo<some-pod>:/tmp/bar-c<specific-container>\n\n# Copy /tmp/foo local file to /tmp/bar in a remote pod in namespace <some-namespace>\nkubectl cp /tmp/foo<some-namespace>/<some-pod>:/tmp/bar\n\n# Copy /tmp/foo from a remote pod to /tmp/bar locally\nkubectl cp <some-namespace>/<some-pod>:/tmp/foo/tmp/bar\n\nauth Inspect authorization\n\n## Advanced Commands\n\n## apply Apply a configuration to a resource by filename or stdin\n\nDeclarative management of kubernetes objects using configuration files\n\nkubectl apply -f k8s/vernemq-statefulset.yaml --dry-run\nkubectl apply -f k8s/locust-service.yaml --force\n\n# patch Update field(s) of a resource using strategic merge patch\n\n# for performing rolling update on statefulset\n\n## kubectl patch statefulset web -p \'{"spec":{"updateStrategy":{"type":"RollingUpdate"}}}\'\n\nreplace Replace a resource by filename or stdin\n\nconvert Convert config files between different API versions\n\n## Settings Commands\n\n## *label* Update the labels on a resource\n\nkubectl label pod $POD_NAME app=v1\nkubectl label nodes aks-agentpool-10140213-9 node=historical\nkubectl label nodes aks-agentpool-10140213-0 node=example\nkubectl label node aks-agentpool-10140213-0 node-\n\nannotate Update the annotations on a resource\n\ncompletion Output shell completion code for the specified shell (bash or zsh)\n'})}),"\n",(0,s.jsx)(n.h3,{id:"patch",children:"Patch"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'# remove daemonset from all nodes by adding selector\nkubectl patch daemonset metricbeat-cms-metricbeat -p \'{"spec": {"template": {"spec": {"nodeSelector": {"non-existing": "true"}}}}}\'\n\n# remove selector to deploy daemonset to all nodes\nkubectl -n <namespace> patch daemonset <name-of-daemon-set> --type json -p=\'[{"op": "remove", "path": "/spec/template/spec/nodeSelector/non-existing"}]\'\n\n# https://stackoverflow.com/questions/53929693/how-to-scale-kubernetes-daemonset-to-0\n\n# patch hpa\nkubectl patch hpa cnext-backend-production-hpa -n prod --type=\'json\' -p=\'[{"op": "replace", "path": "/spec/minReplicas", "value": 30}]\'\n'})}),"\n",(0,s.jsx)(n.h2,{id:"other-commands",children:"Other Commands"}),"\n",(0,s.jsx)(n.h3,{id:"api-resources",children:"api-resources"}),"\n",(0,s.jsx)(n.p,{children:"Print all api-resources available in the cluster"}),"\n",(0,s.jsx)(n.p,{children:'api-versions Print the supported API versions on the server, in the form of "group/version"'}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"admissionregistration.k8s.io/v1beta1"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"apiextensions.k8s.io/v1beta1"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"apiregistration.k8s.io/v1"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"apiregistration.k8s.io/v1beta1"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"apps/v1"}),"\n",(0,s.jsx)(n.p,{children:"apps/v1 is the most popular API group in Kubernetes, and it includes functionality related to running applications on Kubernetes, like Deployments, RollingUpdates, and ReplicaSets."}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"apps/v1beta1"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"apps/v1beta2"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"authentication.k8s.io/v1"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"authentication.k8s.io/v1beta1"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"authorization.k8s.io/v1"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"authorization.k8s.io/v1beta1"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"autoscaling/v1"}),"\n",(0,s.jsx)(n.p,{children:"autoscaling/v1 allows pods to be autoscaled based on different resource usage metrics"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"autoscaling/v2beta1"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"autoscaling/v2beta2"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"azmon.container.insights/v1"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"batch/v1"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"batch/v1 is related to batch processing and and jobs"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"batch/v1beta1"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"batch/v1beta1 is the beta release of batch/v1"}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"certificates.k8s.io/v1beta1"}),"\n",(0,s.jsx)(n.p,{children:"certificates.k8s.io/v1beta1 validates network certificates for secure communication in your cluster."}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"coordination.k8s.io/v1"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"coordination.k8s.io/v1beta1"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"enterprises.upmc.com/v1"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"events.k8s.io/v1beta1"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"extensions/v1beta1"}),"\n",(0,s.jsx)(n.p,{children:"extensions/v1beta1 includes many new, commonly used features. In Kubernetes 1.6, some of these features were relocated fromextensionsto specific API groups like apps"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"metrics.k8s.io/v1beta1"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"monitoring.coreos.com/v1"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"networking.k8s.io/v1"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"node.k8s.io/v1beta1"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"policy/v1beta1"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"policy/v1beta1 enables setting a pod disruption budget and new pod security rules"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"rbac.authorization.k8s.io/v1"}),"\n",(0,s.jsx)(n.p,{children:"rbac.authorization.k8s.io/v1 includes extra functionality for Kubernetes RBAC - (role-based access control)"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"rbac.authorization.k8s.io/v1beta1"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"scheduling.k8s.io/v1"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"scheduling.k8s.io/v1beta1"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"storage.k8s.io/v1"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"storage.k8s.io/v1beta1"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"v1"}),"\n",(0,s.jsx)(n.p,{children:"v1 was the first stable release of the Kubernetes API. It contains many core objects."}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"config",children:"config"}),"\n",(0,s.jsx)(n.p,{children:"Modify kubeconfig files"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"export KUBECONFIG=/Users/deepaksood/kubeconfig-file.yaml\n\nkubectl --kubeconfig kubeconfig-file.yaml get pods\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"current-context Displays the current-context"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"delete-cluster Delete the specified cluster from the kubeconfig"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"delete-context Delete the specified context from the kubeconfig"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"get-clusters Display clusters defined in the kubeconfig"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"get-contexts Describe one or many contexts"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"rename-context Renames a context from the kubeconfig file."}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"set Sets an individual value in a kubeconfig file"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"set-cluster Sets a cluster entry in kubeconfig"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"set-context Sets a context entry in kubeconfig"}),"\n",(0,s.jsx)(n.p,{children:"permanently save the namespace for all subsequent kubectl commands in that context."}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"kubectl config set-context --current --namespace=monitoring**"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"set-credentials Sets a user entry in kubeconfig"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"unset Unsets an individual value in a kubeconfig file"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"use-context Sets the current-context in a kubeconfig file"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"view Display merged kubeconfig settings or a specified kubeconfig file"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"kubectl config current-context"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"kubectl config use-context docker-for-desktop"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"kubectl config set-context $(kubectl config current-context) --namespace=blue"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"kubectl config delete-cluster my-cluster"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"kubectl config delete-context my-cluster-context"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"help Help about any command"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"plugin Runs a command-line plugin"}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"version",children:"version"}),"\n",(0,s.jsx)(n.p,{children:"Print the client and server version information"}),"\n",(0,s.jsx)(n.h3,{id:"options",children:"options"}),"\n",(0,s.jsx)(n.h3,{id:"usage",children:"Usage"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"kubectl [flags] [options]\n\n- kubectl apply -f service.yaml\n- kubectl edit deployment <container_name>\n- kubectl history deployment <container_name>\n"})}),"\n",(0,s.jsx)(n.h2,{id:"commands-1",children:"Commands"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"kubectl get secret eager-otter-grafana -o yaml\nkubectl get secret --namespace default eager-otter-grafana -o jsonpath=\"{.data.admin-password}\" | base64 --decode ; echo\n\n# Adding Secrets for pulling images from private registry\n    https://container-solutions.com/using-google-container-registry-with-kubernetes/\n\nkubectl create secret docker-registry gcr-json-key --docker-server=gcr.io --docker-username=_json_key --docker-password=\"$(cat ~/json-key-file.json)\" --docker-email=deepak.sood@abc.com\n\nkubectl patch serviceaccount default -p '{\"imagePullSecrets\": [{\"name\": \"gcr-json-key\"}]}'\n\nkubectl patch serviceaccount default -p '{\"imagePullSecrets\": [{\"name\": \"gcr-json-key\"}]}' -n zenalytix\n\n# CPU Requests\nkubectl get po --all-namespaces -o=jsonpath=\"{range .items[*]}{.metadata.namespace}:{.metadata.name}{'\\n'}{range .spec.containers[*]}  {.name}:{.resources.requests.cpu}{'\\n'}{end}{'\\n'}{end}\"\n\n# Memory Requests\nkubectl get po --all-namespaces -o=jsonpath=\"{range .items[*]}{.metadata.namespace}:{.metadata.name}{'\\n'}{range .spec.containers[*]}  {.name}:{.resources.requests.memory}{'\\n'}{end}{'\\n'}{end}\"\n\n# CPU Limits\nkubectl get po --all-namespaces -o=jsonpath=\"{range .items[*]}{.metadata.namespace}:{.metadata.name}{'\\n'}{range .spec.containers[*]}  {.name}:{.resources.limits.cpu}{'\\n'}{end}{'\\n'}{end}\"\n"})}),"\n",(0,s.jsx)(n.h2,{id:"experimental-commands",children:"Experimental commands"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"kubectl diff -f k8s/vernemq-statefulset.yaml"})}),"\n",(0,s.jsx)(n.h2,{id:"kubectl-dashboard",children:"Kubectl dashboard"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"kubectl edit svc/kubernetes-dashboard -n kube-system\n\nAdd - loadBalancerIP: 52.172.40.253\nChange - type: LoadBalancer\n\nkubectl apply -f https://raw.githubusercontent.com/kubernetes/dashboard/v1.10.1/src/deploy/recommended/kubernetes-dashboard.yaml\n\nkubectl proxy\n\nhttps://github.com/kubernetes/dashboard\n\n# Get bearer token\nkubectl -n kube-system describe secret $(kubectl -n kube-system get secret | grep admin-user | awk '{print $1}')\n\neyJhbGciOiJSUzI1NiIsImtpZCI6IiJ9.eyJpc3MiOiJrdWJlcm5ldGVzL3NlcnZpY2VhY2NvdW50Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9uYW1lc3BhY2UiOiJrdWJlLXN5c3RlbSIsImt1YmVybmV0ZXMuaW8vc2VydmljZWFjY291bnQvc2VjcmV0Lm5hbWUiOiJ0dGwtY29udHJvbGxlci10b2tlbi1zcTYyaiIsImt1YmVybmV0ZXMuaW8vc2VydmljZWFjY291bnQvc2VydmljZS1hY2NvdW50Lm5hbWUiOiJ0dGwtY29udHJvbGxlciIsImt1YmVybmV0ZXMuaW8vc2VydmljZWFjY291bnQvc2VydmljZS1hY2NvdW50LnVpZCI6IjZhMzFmZDYwLTMzNGQtMTFlOS04OTk4LTAyNTAwMDAwMDAwMSIsInN1YiI6InN5c3RlbTpzZXJ2aWNlYWNjb3VudDprdWJlLXN5c3RlbTp0dGwtY29udHJvbGxlciJ9.bmsdSGQH2Pgn50DbyAOKSD25GZW6A51vxcPGmFpJn1ZBkD4GQxqt4g36dJGsuD4TAHnPUOecQxuGBNJYZrpxP9qbvByqd5AfllTTHRIp170oNO65f7bN9sNfXbQev0CbxU5zOoDUoLz7KuA1qKX1chiPTq2TioRd-g6tUc9Ly1qpg7nbt4LKMCw0Kyg7H9g2Pi7s484IHvtWtrDMOsoYaix1baeujMYq4pSE8X_MNA_IPYlkF9GdpjX2OMJmsXSXlCr7-hV9gkIporAVqozLL-Upxknpt-2jfIZ5UYmgoCC4dOXTTzAe9FaMAr50ipiQzj1b7ENVtn5hMYboyuvieQ\n"})}),"\n",(0,s.jsx)(n.h3,{id:"kubernetes-dashboard",children:"Kubernetes dashboard"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{href:"http://localhost:8001/api/v1/namespaces/kube-system/services/https:kubernetes-dashboard:/proxy",children:"http://localhost:8001/api/v1/namespaces/kube-system/services/https:kubernetes-dashboard:/proxy"})}),"\n",(0,s.jsx)(n.h3,{id:"decoding-a-secret",children:"Decoding a Secret"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"kubectl get secret mysecret -o yaml\necho 'MWYyZDFlMmU2N2Rm' | base64 --decode\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{href:"https://kubernetes.io/docs/concepts/configuration/secret/#decoding-a-secret",children:"https://kubernetes.io/docs/concepts/configuration/secret/#decoding-a-secret"})}),"\n",(0,s.jsx)(n.h2,{id:"example---counter-every-1-sec",children:"Example - Counter every 1 sec"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"apiVersion: v1\nkind: Pod\nmetadata:\n    name: counter\nspec:\n    containers:\n        - name: count\n        image: busybox\nargs: [/bin/sh, -c, 'i=0; while true; do echo \"$i: $(date)\"; i=$((i+1)); sleep 1; done']\n"})}),"\n",(0,s.jsx)(n.h3,{id:"kubectl-apply-vs-create",children:"Kubectl apply vs create"}),"\n",(0,s.jsxs)(n.p,{children:["Those are two different approaches.kubectl createis what we call",(0,s.jsx)(n.a,{href:"https://kubernetes.io/docs/tutorials/object-management-kubectl/imperative-object-management-configuration/",children:"Imperative Management"}),". On this approach you tell the Kubernetes API what you want to create, replace or delete, not how you want your K8s cluster world to look like."]}),"\n",(0,s.jsxs)(n.p,{children:["kubectl applyis part of the",(0,s.jsx)(n.a,{href:"https://kubernetes.io/docs/tutorials/object-management-kubectl/declarative-object-management-configuration/",children:"Declarative Management"})," approach, where changes that you may have applied to a live object (i.e. throughscale) are maintained even if youapplyother changes to the object."]}),"\n",(0,s.jsx)(n.h3,{id:"tab-completion-in-iterm-zsh--auto-complete",children:"Tab Completion in iterm zsh / Auto complete"}),"\n",(0,s.jsx)(n.p,{children:"Add ~/.zshrc file"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"source <(kubectl completion zsh)"})}),"\n",(0,s.jsx)(n.h3,{id:"storage-class",children:"Storage Class"}),"\n",(0,s.jsx)(n.p,{children:"Setting default storage class"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'kubectl patch storageclass <your-class-name> -p \'{"metadata": {"annotations":{"storageclass.kubernetes.io/is-default-class":"false"}}}\'\n\nkubectl patch storageclass <your-class-name> -p \'{"metadata": {"annotations":{"storageclass.kubernetes.io/is-default-class":"true"}}}\'\n'})}),"\n",(0,s.jsx)(n.h2,{id:"cleanup--clean-up-commands",children:"Cleanup / clean up commands"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"kubectl get pv | grep Released\nkubectl delete pv $(kubectl get pv | grep Released | awk {'print $1'})\nkubectl delete -n uat pvc $(kubectl get pvc -n uat | awk {'print $1'})\n\nDelete unused PVCs\nkubectl describe -A pvc | grep -E \"^Name:.*$|^Namespace:.*$|^Used By:.*$\" | grep -B 2 \"<none>\" | grep -E \"^Name:.*$|^Namespace:.*$\"\n\nkubectl describe -A pvc | grep -E \"^Name:.*$|^Namespace:.*$|^Used By:.*$\" | grep -B 2 \"<none>\" | grep -E \"^Name:.*$|^Namespace:.*$\" | cut -f2 -d: | paste -d \" \" - - | xargs -n2 bash -c 'kubectl -n ${1} delete pvc ${0}'\n\n#remove old replicasets\nkubectl get --all-namespaces rs -o json|jq -r '.items[] | select(.spec.replicas | contains(0)) | \"kubectl delete rs --namespace=\\(.metadata.namespace) \\(.metadata.name)\"'\n\n#remove jobs\nkubectl delete job $(kubectl get jobs| awk '$3 ~ 1' | awk '{print $1}')\nkubectl delete job $(kubectl get jobs -n maintenance | awk '{print $1}') -n maintenance\nkubectl delete job $(kubectl get jobs -n zenalytix | awk '$3 ~ 0' | awk '{print $1}') -n zenalytix\n\nkubectl delete pod $(kubectl get pods -l app=alertdriver -n zenalytix | awk '{print $1}') -n zenalytix\n\n# Delete namespace stuck at terminating state\n    (\nNAMESPACE=your-rogue-namespace\nkubectl proxy &\nkubectl get namespace $NAMESPACE -o json |jq '.spec = {\"finalizers\":[]}' >temp.json\ncurl -k -H \"Content-Type: application/json\" -X PUT --data-binary @temp.json 127.0.0.1:8001/api/v1/namespaces/$NAMESPACE/finalize\n)\n\n# delete pods using regex\nkubectl get pods -n crons --no-headers=true | awk '/app-rating-report/{print $1}' | xargs kubectl delete -n crons pod\n\n# delete all pods with Error status\nkubectl get pods -n crons --no-headers=true | awk '/Error/{print $1}' | xargs kubectl delete -n crons pod\n\n# completed pods\n    kubectl get pod --field-selector=status.phase==Succeeded\n    kubectl delete pod --field-selector=status.phase==Succeeded\n\n    kubectl get pods | grep Completed | awk '{print $1}' | xargs kubectl delete pod\n    kubectl get pods -n crons | grep -iv Running | awk '{print $1}' | xargs kubectl delete -n crons pod\n\n#remove evicted pods\nkubectl get pods -n <namespace> | grep Evicted | awk '{print $1}' | xargs kubectl delete pod -n <namespace>\nkubectl get pods -n apps | grep Evicted  | awk '{print $1}' | xargs kubectl delete pod -n apps\nkubectl get pods -A | grep Evicted  | awk '{print $1}' | xargs kubectl delete pod -A\n\n# Delete pods older than X seconds\nkubectl get pods -n crons -o go-template --template '{{range .items}}{{.metadata.name}} {{.metadata.creationTimestamp}}{{\"\\n\"}}{{end}}' | awk '$2 <= \"'$(date -d 'yesterday' -Ins --utc | sed 's/+0000/Z/')'\" { print $1 }' | xargs --no-run-if-empty kubectl delete pod -n crons\n\nkubectl get pods -n crons -o go-template --template '{{range .items}}{{.metadata.name}} {{.metadata.creationTimestamp}}{{\"\\n\"}}{{end}}' | awk '$2 <= \"'$(date -v-120M \"+%Y-%m-%dT%H:%M:%S\")'\" { print $1 }' | xargs --no-run-if-empty kubectl delete pod -n crons\n\n# delete NotReady Pods\nkubectl delete node $(kubectl get nodes | grep NotReady,SchedulingDisabled | awk '{print $1;}')\n\n# if stuck in EKS\nkubectl patch node/ip-172-30-17-201.ap-southeast-1.compute.internal -p '{\"metadata\":{\"finalizers\":[]}}' --type=merge\n"})}),"\n",(0,s.jsx)(n.h2,{id:"requests-and-limits",children:"Requests and Limits"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{href:"https://github.com/robscott/kube-capacity",children:"GitHub - robscott/kube-capacity: A simple CLI that provides an overview of the resource requests, limits, and utilization in a Kubernetes cluster"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"curl -fsSLO https://github.com/robscott/kube-capacity/releases/download/v0.8.0/kube-capacity_v0.8.0_linux_x86_64.tar.gz\n\ntar -xzvf kube-capacity_v0.8.0_linux_x86_64.tar.gz\nmv kube-capacity /usr/bin\n\nbrew tap robscott/tap\nbrew install robscott/tap/kube-capacity\n\nbrew install kube-capacity\n\n# cluster wide\nkube-capacity\nkube-capacity --util\nkube-capacity --util --sort cpu.util\nkube-capacity --util --sort cpu.util.percentage\nkube-capacity --util --sort memory.util.percentage\n\nkube-capacity --pods --util --sort cpu.util\nkube-capacity --pods --util --sort memory.util.percentage\n\nkube-capacity --available\n\nkube-capacity --node-taints special:NoSchedule\n\nkube-capacity --no-taint\n\nkube-capacity --pod-count\n\nkube-capacity --pods --util --sort memory.util.percentage --namespace prod\n\nkube-capacity --pods --util --sort memory.util.percentage --namespace tidb-cluster\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{href:"https://viblo.asia/p/easy-to-list-kubernetes-resource-requests-and-limits-with-kube-capacity-english-Rk74avM6JeO",children:"Easy to list Kubernetes resource requests and limits with kube-capacity"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{href:"https://github.com/robscott/kube-capacity/releases",children:"Releases \xb7 robscott/kube-capacity"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"import re\nimport subprocess\n\ndef get_total_requests(node_name):\nresult = subprocess.check_output(\"kubectl get pods --all-namespaces \"\nf\"-o wide --field-selector spec.nodeName={node_name} \"\n\"| awk '{print $1,$2,$4}'\", shell=True)\n\nresult = result.decode('utf-8')\nresult = result.split('n')\npods = []\n\nfor i in range(1, len(result) - 1):\nnamespace, pod_name, state = result[i].split()\n\nif state == 'Running':\npods.append((pod_name, namespace))\n\ntotal_ram = 0\ntotal_cpu = 0\n\nfor pod in pods:\npod_name, namespace = pod\nquery = f\"kubectl get pod {pod_name} -n {namespace} -o=jsonpath='\"\nr'{.spec.containers[*].resources.requests.cpu}{\"n\"}'\n\"{.spec.containers[*].resources.requests.memory}'\"\nresult = subprocess.check_output(query, shell=True)\n\nresult = result.decode('utf-8')\ncpu_requests, memory_requests = result.split('n')\n\ncpu_requests = cpu_requests.split()\nmemory_requests = memory_requests.split()\ntotal_cpu_pod = total_ram_pod = 0\n\nfor cpu_request in cpu_requests:\ntotal_cpu_pod += int(re.search(r'd+', cpu_request).group())\n\nfor ram_request in memory_requests:\ntotal_ram_pod += int(re.search(r'd+', ram_request).group())\n\nprint(f'{pod_name}: {total_cpu_pod} {total_ram_pod}')\ntotal_cpu += total_cpu_pod\ntotal_ram += total_ram_pod\n\nprint(f'requested_cpu: {total_cpu} nrequested_ram: {total_ram}')\n"})}),"\n",(0,s.jsx)(n.h2,{id:"references",children:"References"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://rominirani.com/tutorial-getting-started-with-kubernetes-with-docker-on-mac-7f58467203fd",children:"https://rominirani.com/tutorial-getting-started-with-kubernetes-with-docker-on-mac-7f58467203fd"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://kubernetes.io/docs/reference/kubectl/cheatsheet",children:"https://kubernetes.io/docs/reference/kubectl/cheatsheet"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://kubernetes.io/docs/reference/kubectl/overview",children:"https://kubernetes.io/docs/reference/kubectl/overview"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://github.com/dgkanatsios/CKAD-exercises",children:"https://github.com/dgkanatsios/CKAD-exercises"})}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,a.a)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},511151:(e,n,t)=>{t.d(n,{Z:()=>o,a:()=>r});var s=t(667294);const a={},c=s.createContext(a);function r(e){const n=s.useContext(c);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:r(e.components),s.createElement(c.Provider,{value:n},e.children)}}}]);