"use strict";(self.webpackChunkdeep_notes=self.webpackChunkdeep_notes||[]).push([[63070],{451230:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>a,contentTitle:()=>l,default:()=>h,frontMatter:()=>i,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"technologies/celery/commands-tools","title":"Commands / Tools","description":"Configurations","source":"@site/docs/technologies/celery/commands-tools.md","sourceDirName":"technologies/celery","slug":"/technologies/celery/commands-tools","permalink":"/technologies/celery/commands-tools","draft":false,"unlisted":false,"editUrl":"https://github.com/deepaksood619/deepaksood619.github.io/tree/master/docs/technologies/celery/commands-tools.md","tags":[],"version":"current","lastUpdatedBy":"Deepak","lastUpdatedAt":1734022610000,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Celery Backend","permalink":"/technologies/celery/celery-backend"},"next":{"title":"Workers","permalink":"/technologies/celery/workers"}}');var t=r(474848),o=r(28453);const i={},l="Commands / Tools",a={},c=[{value:"Configurations",id:"configurations",level:2},{value:"Commands",id:"commands",level:2},{value:"Tools",id:"tools",level:2},{value:"Flower: Celery Monitoring Tool",id:"flower-celery-monitoring-tool",level:3},{value:"Load Average",id:"load-average",level:3},{value:"Monitoring",id:"monitoring",level:3},{value:"Jobtastic",id:"jobtastic",level:3},{value:"Links",id:"links",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"commands--tools",children:"Commands / Tools"})}),"\n",(0,t.jsx)(n.h2,{id:"configurations",children:"Configurations"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://steve.dignam.xyz/2023/05/20/many-problems-with-celery/",children:"The Many Problems with Celery | Log Blog Kebab"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://ayushshanker.com/posts/celery-in-production-bugfixes",children:"Celery in Production: Three more years of fixing bugs"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://careersatdoordash.com/blog/eliminating-task-processing-outages-with-kafka/",children:"Eliminating Task Processing Outages by Replacing RabbitMQ with Apache Kafka Without Downtime - DoorDash"})}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"commands",children:"Commands"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"celery -A tasks worker --loglevel=INFO\ncelery worker --help\n celery --app=proj worker -l INFO\n celery -A proj worker -l INFO -Q hipri,lopri\n celery -A proj worker --concurrency=4\n celery -A proj worker --concurrency=1000 -P eventlet\n celery worker --autoscale=10,0\n\n celery -A tasks control rate_limit tasks.add 10/m\n\ncelery --help\n Commands:\n   amqp     AMQP Administration Shell.\n   beat     Start the beat periodic task scheduler.\n   call     Call a task by name.\n   control  Workers remote control.\n  [revoke|terminate|rate_limit|time_limit|election|enable_events|disable_events|heartbeat|pool_grow|pool_shrink|pool_restart|autoscale|shutdown|add_consumer|cancel_consumer]\n\n   events   Event-stream utilities.\n   graph    The ``celery graph`` command.\n   inspect  Inspect the worker at runtime.\n  celery -A admin_panel inspect ping\n\n   list     Get info from broker\n  celery list\n\n   logtool  The ``celery logtool`` command.\n   migrate  Migrate tasks from one broker to another.\n   multi    Start multiple worker instances.\n   purge    Erase all messages from all known task queues.\n   report   Shows information useful to include in bug-reports.\n   result   Print the return value for a given task id.\n   shell    Start shell session with convenient access to celery symbols.\n   status   Show list of workers that are online.\n  celery --app admin_panel status\n\n   upgrade  Perform upgrade between versions.\n   worker   Start worker instance.\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Major commands"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"celery purge\ncelery status\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"from celery import Celery\napp = Celery('tasks', backend='redis://default:password123@localhost', broker='redis://default:password123@localhost')\n\n@app.task\ndef add(x, y):\n    return x + y\n\nfrom tasks import add\nresult=add.delay(4,4)\nThe ready() method returns whether the task has finished processing or not:\nresult.ready()\nFalse\nYou can wait for the result to complete, but this is rarely used since it turns the asynchronous call into a synchronous one:\nresult.get(timeout=1)\n8\nIn case the task raised an exception, get() will re-raise the exception, but you can override this by specifying the propagate argument:\nresult.get(propagate=False)\nIf the task raised an exception, you can also gain access to the original traceback:\nresult.traceback\n"})}),"\n",(0,t.jsx)(n.h2,{id:"tools",children:"Tools"}),"\n",(0,t.jsx)(n.h3,{id:"flower-celery-monitoring-tool",children:"Flower: Celery Monitoring Tool"}),"\n",(0,t.jsxs)(n.p,{children:["Flower is a web based tool for monitoring and administrating ",(0,t.jsx)(n.a,{href:"http://celeryproject.org/",children:"Celery"})," clusters"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Real-time monitoring using Celery Events","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Task progress and history"}),"\n",(0,t.jsx)(n.li,{children:"Ability to show task details (arguments, start time, run-time, and more)"}),"\n",(0,t.jsx)(n.li,{children:"Graphs and statistics"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["Remote Control","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"View worker status and statistics"}),"\n",(0,t.jsx)(n.li,{children:"Shutdown and restart worker instances"}),"\n",(0,t.jsx)(n.li,{children:"Control worker pool size and autoscale settings"}),"\n",(0,t.jsx)(n.li,{children:"View and modify the queues a worker instance consumes from"}),"\n",(0,t.jsx)(n.li,{children:"View currently running tasks"}),"\n",(0,t.jsx)(n.li,{children:"View scheduled tasks (ETA/countdown)"}),"\n",(0,t.jsx)(n.li,{children:"View reserved and revoked tasks"}),"\n",(0,t.jsx)(n.li,{children:"Apply time and rate limits"}),"\n",(0,t.jsx)(n.li,{children:"Configuration viewer"}),"\n",(0,t.jsx)(n.li,{children:"Revoke or terminate tasks"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["HTTP API","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"List workers"}),"\n",(0,t.jsx)(n.li,{children:"Shut down a worker"}),"\n",(0,t.jsx)(n.li,{children:"Restart worker's pool"}),"\n",(0,t.jsx)(n.li,{children:"Grow worker's pool"}),"\n",(0,t.jsx)(n.li,{children:"Shrink worker's pool"}),"\n",(0,t.jsx)(n.li,{children:"Autoscale worker pool"}),"\n",(0,t.jsx)(n.li,{children:"Start consuming from a queue"}),"\n",(0,t.jsx)(n.li,{children:"Stop consuming from a queue"}),"\n",(0,t.jsx)(n.li,{children:"List tasks"}),"\n",(0,t.jsx)(n.li,{children:"List (seen) task types"}),"\n",(0,t.jsx)(n.li,{children:"Get a task info"}),"\n",(0,t.jsx)(n.li,{children:"Execute a task"}),"\n",(0,t.jsx)(n.li,{children:"Execute a task by name"}),"\n",(0,t.jsx)(n.li,{children:"Get a task result"}),"\n",(0,t.jsx)(n.li,{children:"Change soft and hard time limits for a task"}),"\n",(0,t.jsx)(n.li,{children:"Change rate limit for a task"}),"\n",(0,t.jsx)(n.li,{children:"Revoke a task"}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.li,{children:"OpenID authentication"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"load-average",children:"Load Average"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"os.getloadavg()"}),"\n",(0,t.jsx)(n.li,{children:"system run queue averaged over the last 1, 5, and 15 minutes"}),"\n",(0,t.jsx)(n.li,{children:"This loadaverage is of the host not the container"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"monitoring",children:"Monitoring"}),"\n",(0,t.jsx)(n.p,{children:"Monitor Celery Tasks with Prometheus and celery-exporter"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.a,{href:"https://github.com/OvalMoney/celery-exporter",children:"https://github.com/OvalMoney/celery-exporter"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.a,{href:"https://grafana.com/grafana/dashboards/10026",children:"https://grafana.com/grafana/dashboards/10026"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.a,{href:"https://github.com/mher/flower",children:"https://github.com/mher/flower"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.a,{href:"https://flower.readthedocs.io/en/latest",children:"https://flower.readthedocs.io/en/latest"})}),"\n",(0,t.jsx)(n.h3,{id:"jobtastic",children:"Jobtastic"}),"\n",(0,t.jsx)(n.p,{children:"Jobtastic is a python library that adds useful features to your Celery tasks. Specifically, these are features you probably want if the results of your jobs are expensive or if your users need to wait while they compute their results."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.a,{href:"http://policystat.github.io/jobtastic",children:"http://policystat.github.io/jobtastic"})}),"\n",(0,t.jsx)(n.h2,{id:"links",children:"Links"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://dnisha.github.io/mynotes/Streaming-technology/Celery/Celery-Task-Decorators-Perameters",children:"Celery Task Decorators Perameters"})}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},28453:(e,n,r)=>{r.d(n,{R:()=>i,x:()=>l});var s=r(296540);const t={},o=s.createContext(t);function i(e){const n=s.useContext(o);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:i(e.components),s.createElement(o.Provider,{value:n},e.children)}}}]);