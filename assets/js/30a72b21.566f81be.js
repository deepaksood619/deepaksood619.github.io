"use strict";(self.webpackChunkdeep_notes=self.webpackChunkdeep_notes||[]).push([[15118],{523209:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>l,contentTitle:()=>r,default:()=>c,frontMatter:()=>s,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"ai/libraries/ml-monitoring","title":"ML Monitoring","description":"A Guide to Monitoring Machine Learning Models in Production | NVIDIA Technical Blog","source":"@site/docs/ai/libraries/ml-monitoring.md","sourceDirName":"ai/libraries","slug":"/ai/libraries/ml-monitoring","permalink":"/ai/libraries/ml-monitoring","draft":false,"unlisted":false,"editUrl":"https://github.com/deepaksood619/deepaksood619.github.io/tree/master/docs/ai/libraries/ml-monitoring.md","tags":[],"version":"current","lastUpdatedBy":"Deepak","lastUpdatedAt":1739572825000,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Libraries","permalink":"/ai/libraries/ml-libraries"},"next":{"title":"MLOps / Model Deployment","permalink":"/ai/libraries/mlops-model-deployment"}}');var o=i(474848),a=i(28453);const s={},r="ML Monitoring",l={},d=[{value:"Machine learning system behavior",id:"machine-learning-system-behavior",level:3},{value:"Challenges in machine learning systems",id:"challenges-in-machine-learning-systems",level:3},{value:"Entanglements",id:"entanglements",level:4},{value:"Configurations",id:"configurations",level:4},{value:"The responsibility challenge",id:"the-responsibility-challenge",level:2},{value:"A data scientist\u2019s perspective",id:"a-data-scientists-perspective",level:3},{value:"An engineer\u2019s perspective",id:"an-engineers-perspective",level:3},{value:"What needs to be monitored in production?",id:"what-needs-to-be-monitored-in-production",level:2},{value:"Functional level monitoring",id:"functional-level-monitoring",level:3},{value:"Input data",id:"input-data",level:4},{value:"The model",id:"the-model",level:4},{value:"The output",id:"the-output",level:4},{value:"Operational level monitoring",id:"operational-level-monitoring",level:3},{value:"The ML system performance",id:"the-ml-system-performance",level:4},{value:"The pipelines",id:"the-pipelines",level:4},{value:"Costs",id:"costs",level:4},{value:"Tools for monitoring machine learning models",id:"tools-for-monitoring-machine-learning-models",level:2}];function h(e){const n={a:"a",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.header,{children:(0,o.jsx)(n.h1,{id:"ml-monitoring",children:"ML Monitoring"})}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.a,{href:"https://developer.nvidia.com/blog/a-guide-to-monitoring-machine-learning-models-in-production/",children:"A Guide to Monitoring Machine Learning Models in Production | NVIDIA Technical Blog"})}),"\n",(0,o.jsx)(n.h3,{id:"machine-learning-system-behavior",children:"Machine learning system behavior"}),"\n",(0,o.jsx)(n.p,{children:"When building machine learning systems, practitioners are mainly keen on tracking the system\u2019s behavior. Three components determine the system\u2019s behavior:"}),"\n",(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"The data (ML specific)"}),": A machine learning system\u2019s behavior depends on the dataset on which the model was trained, as well as the data streaming into the system while in production."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"The model (ML specific)"}),": The model is the output of a machine learning algorithm trained on data. It represents what was learned by the algorithm. It is better to think of the model as a pipeline as it would typically consist of all steps to orchestrate the flow of data into and output from the model."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"The code"}),": Code is required to build the machine learning pipeline and define the model configurations to train, test, and evaluate models."]}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"challenges-in-machine-learning-systems",children:"Challenges in machine learning systems"}),"\n",(0,o.jsx)(n.p,{children:'It is not as simple as saying, "we have two additional dimensions" to consider when building a machine learning system. Code and configuration introduce more complexity and sensitivity into a machine learning system due to the following challenges:'}),"\n",(0,o.jsx)(n.h4,{id:"entanglements",children:"Entanglements"}),"\n",(0,o.jsx)(n.p,{children:"Any change in the input data distributions will influence the approximation of the target function, which may affect the predictions made by the model. In other words, changing anything changes everything. Therefore, any feature engineering and selection code must be carefully tested."}),"\n",(0,o.jsx)(n.h4,{id:"configurations",children:"Configurations"}),"\n",(0,o.jsx)(n.p,{children:"A flaw in the configuration of a model (for example, hyperparameters, versions, and features) can radically alter the system\u2019s behavior and will not be caught with traditional software tests. In other words, a machine learning system can predict an incorrect but valid output without raising an exception."}),"\n",(0,o.jsxs)(n.p,{children:["These factors combine to make monitoring machine learning systems extremely difficult compared to traditional software systems, which are governed by the rules specified in the code. Another factor to consider is the number of stakeholders involved in developing a machine learning system. This is known as the ",(0,o.jsx)(n.strong,{children:"responsibility challenge"}),"."]}),"\n",(0,o.jsx)(n.h2,{id:"the-responsibility-challenge",children:"The responsibility challenge"}),"\n",(0,o.jsx)(n.p,{children:"Often, having multiple stakeholders on a project may be extremely beneficial. Each stakeholder can provide insight into requirements and constraints based on their expertise, enabling the team to reduce and uncover risks on the project."}),"\n",(0,o.jsx)(n.p,{children:'However, each stakeholder may have a completely different understanding of the meaning of "monitoring" based on business areas and responsibilities. An example distinction could be made between data scientists and engineers.'}),"\n",(0,o.jsx)(n.h3,{id:"a-data-scientists-perspective",children:"A data scientist\u2019s perspective"}),"\n",(0,o.jsx)(n.p,{children:"Data scientists are most concerned with achieving functional objectives, such as changes in the input data, the model, and the predictions made by the model. Monitoring functional objectives requires visibility into the data passing into the model, metrics from the model itself, and an understanding of the predictions made by the model."}),"\n",(0,o.jsx)(n.p,{children:"A data scientist may be more concerned with the model\u2019s accuracy in the production environment. To achieve such insight, it would be ideal if true labels were available in real time, which is only sometimes the case. Thus, data scientists often use proxy values to gain visibility into their models."}),"\n",(0,o.jsx)(n.h3,{id:"an-engineers-perspective",children:"An engineer\u2019s perspective"}),"\n",(0,o.jsx)(n.p,{children:"On the other hand, engineers are often responsible for achieving operational objectives that ensure the resources for the machine learning system are healthy. This requires monitoring traditional software application metrics, which is typical in traditional software development. Examples include:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Latency"}),"\n",(0,o.jsx)(n.li,{children:"IO/memory/disk use"}),"\n",(0,o.jsx)(n.li,{children:"System reliability (uptime)"}),"\n",(0,o.jsx)(n.li,{children:"Auditability"}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:"Despite the discrepancies in stakeholder goals and responsibilities, adequate monitoring of machine learning systems takes both perspectives into account. However, a good level of understanding is still required across the board. To achieve such a feat, it is still vital that all stakeholders come together to ensure terms are well-defined so all team members speak the same language."}),"\n",(0,o.jsx)(n.h2,{id:"what-needs-to-be-monitored-in-production",children:"What needs to be monitored in production?"}),"\n",(0,o.jsx)(n.p,{children:"Monitoring is divided into two levels: functional and operational."}),"\n",(0,o.jsx)(n.h3,{id:"functional-level-monitoring",children:"Functional level monitoring"}),"\n",(0,o.jsx)(n.p,{children:"At the functional level, the data scientist (or/and machine learning engineer) will monitor three distinct categories: the input data, the model, and the output predictions. Monitoring each category provides data scientists with better insight into the model\u2019s performance."}),"\n",(0,o.jsx)(n.h4,{id:"input-data",children:"Input data"}),"\n",(0,o.jsx)(n.p,{children:"Models depend on the data received as input. If a model receives an input it does not expect, the model may break. Monitoring the input data is the first step to detecting functional performance problems and extinguishing them before they impact the performance of the machine learning system. Items to monitor from an input data perspective include:"}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.strong,{children:"Data quality"}),": To maintain data integrity, you must validate production data before it sees the machine learning model, using metrics based on data properties. In other words, ensure that data types are equivalent. Several factors may compromise your data integrity; for example, a change in the source data schema or data being lost. Such issues change the data pipeline so that the model no longer receives the expected inputs."]}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.strong,{children:"Data drift"}),": Changes in distribution between the training data and production data can be monitored to check for drift: this is done by detecting changes in the statistical properties of feature values over time. Data comes from a never-ending, ever-changing source called the real world. As people\u2019s behavior changes, the landscape and context around the business case you\u2019re solving may change. At that point, it is time to update your machine learning model."]}),"\n",(0,o.jsx)(n.h4,{id:"the-model",children:"The model"}),"\n",(0,o.jsx)(n.p,{children:"At the heart of your machine learning system lies your machine learning model. For the system to drive business value, the model must maintain a performance level above a threshold. The various aspects that could deter the model\u2019s performance must be monitored to achieve this goal, such as model drift and versions."}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.strong,{children:"Model drift"}),": Model drift is the decay of a model\u2019s predictive power due to alterations in the real-world environment. Statistical tests should be used to detect drift, and predictive performance should be monitored to evaluate the model\u2019s performance over time."]}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.strong,{children:"Versions"}),": Always ensure the correct model is running in production. Version history and predictions should be tracked."]}),"\n",(0,o.jsx)(n.h4,{id:"the-output",children:"The output"}),"\n",(0,o.jsx)(n.p,{children:"To understand how the model performs, you must also understand the predictions the model outputs in the production environment. A machine learning model is put into production to solve a problem. Thus, monitoring the model\u2019s output is a valuable way to ensure it performs according to the metrics used as KPIs. For example:"}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.strong,{children:"Ground truth:"})," For some problems, you can acquire ground truth labels. For example, if a model is used to recommend personalized ads to users (you are predicting if a user will click the ad or not), and a user clicks to imply the ad is relevant, you can almost immediately acquire the ground truth. In such scenarios, an aggregation of a model\u2019s predictions can be evaluated against the actual solution to determine how well the model performs. However, evaluating model predictions against ground truth labels is difficult in most machine learning use cases, and an alternative method is required."]}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.strong,{children:"Prediction drift:"})," When it is not possible to acquire ground truth labels, predictions must be monitored. If there is a drastic change in the distribution of predictions, something has potentially gone wrong. For example, if you are using a model to predict fraudulent credit card transactions and suddenly the proportion of transactions identified as fraud shoots up, then something has changed. Perhaps input data structure has been altered, some other microservice in the system is misbehaving, or maybe there is just more fraud in the world."]}),"\n",(0,o.jsx)(n.h3,{id:"operational-level-monitoring",children:"Operational level monitoring"}),"\n",(0,o.jsx)(n.p,{children:"At the operational level, the operations engineers are concerned with ensuring the resources for the machine learning system are healthy. The engineers are responsible for acting when the resources are not healthy. They will also monitor the machine learning application across three categories: the system, the pipelines, and the costs."}),"\n",(0,o.jsx)(n.h4,{id:"the-ml-system-performance",children:"The ML system performance"}),"\n",(0,o.jsx)(n.p,{children:"The idea is to be informed constantly about how the machine learning model performs in line with the entire application stack. Issues in this arena will impact the entire system. System performance metrics that would provide insight into the model performance include:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Memory use"}),"\n",(0,o.jsx)(n.li,{children:"Latency"}),"\n",(0,o.jsx)(n.li,{children:"CPU/GPU use"}),"\n"]}),"\n",(0,o.jsx)(n.h4,{id:"the-pipelines",children:"The pipelines"}),"\n",(0,o.jsx)(n.p,{children:"Two crucial pipelines should be monitored: the data pipeline and the model pipeline. Failure to monitor the data pipeline may raise data quality issues that cause the system to break. Regarding the model, you want to track and monitor the factors that may lead to the model failing in production, such as the model dependencies."}),"\n",(0,o.jsx)(n.h4,{id:"costs",children:"Costs"}),"\n",(0,o.jsx)(n.p,{children:"From data storage to model training and more, there are financial costs involved in machine learning. While machine learning systems can generate lots of value for a business, it is also possible for leveraging machine learning to become excruciatingly expensive. Constantly monitoring how much your machine learning application costs your organization is a responsible step to ensuring costs are maintained."}),"\n",(0,o.jsx)(n.p,{children:"For example, you can set budgets using a cloud vendor such as AWS or GCP since their services track your bills and spending. The cloud provider will send alerts to inform the team when budgets are maxed."}),"\n",(0,o.jsx)(n.p,{children:"If you are hosting the machine learning application on-premises, monitoring the system usage and cost could provide greater insight into what component of the application is the most costly and whether or not you can make certain compromises to cut costs."}),"\n",(0,o.jsx)(n.h2,{id:"tools-for-monitoring-machine-learning-models",children:"Tools for monitoring machine learning models"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Prometheus and Grafana"}),"\n",(0,o.jsx)(n.li,{children:"Evidently AI"}),"\n",(0,o.jsx)(n.li,{children:"Amazon SageMaker Model Monitor"}),"\n"]})]})}function c(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(h,{...e})}):h(e)}},28453:(e,n,i)=>{i.d(n,{R:()=>s,x:()=>r});var t=i(296540);const o={},a=t.createContext(o);function s(e){const n=t.useContext(a);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:s(e.components),t.createElement(a.Provider,{value:n},e.children)}}}]);