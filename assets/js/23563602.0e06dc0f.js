"use strict";(self.webpackChunkdeep_notes=self.webpackChunkdeep_notes||[]).push([[45882],{634620:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>d,contentTitle:()=>o,default:()=>h,frontMatter:()=>r,metadata:()=>n,toc:()=>l});const n=JSON.parse('{"id":"databases-nosql/etcd","title":"etcd","description":"etcd is a distributed key value store that provides a reliable way to store data across a cluster of machines. It\'s open-source and available on GitHub. etcd gracefully handles leader elections during network partitions and will tolerate machine failure, including the leader.","source":"@site/docs/databases-nosql/etcd.md","sourceDirName":"databases-nosql","slug":"/databases-nosql/etcd","permalink":"/databases-nosql/etcd","draft":false,"unlisted":false,"editUrl":"https://github.com/deepaksood619/deepaksood619.github.io/tree/master/docs/databases-nosql/etcd.md","tags":[],"version":"current","lastUpdatedBy":"Deepak","lastUpdatedAt":1749575438000,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"DuckDB","permalink":"/databases-nosql/duckdb"},"next":{"title":"Milvus","permalink":"/databases-nosql/milvus/"}}');var s=i(474848),a=i(28453);const r={},o="etcd",d={},l=[{value:"Operator",id:"operator",level:3},{value:"Is it possible for etcd to have a split-brain scenario?",id:"is-it-possible-for-etcd-to-have-a-split-brain-scenario",level:3}];function c(e){const t={a:"a",h1:"h1",h3:"h3",header:"header",li:"li",p:"p",ul:"ul",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.header,{children:(0,s.jsx)(t.h1,{id:"etcd",children:"etcd"})}),"\n",(0,s.jsx)(t.p,{children:"etcd is a distributed key value store that provides a reliable way to store data across a cluster of machines. It's open-source and available on GitHub. etcd gracefully handles leader elections during network partitions and will tolerate machine failure, including the leader."}),"\n",(0,s.jsx)(t.p,{children:"Your applications can read and write data into etcd. A simple use-case is to store database connection details or feature flags in etcd as key value pairs. These values can be watched, allowing your app to reconfigure itself when they change."}),"\n",(0,s.jsx)(t.p,{children:"Advanced uses take advantage of the consistency guarantees to implement database leader elections or do distributed locking across a cluster of workers."}),"\n",(0,s.jsx)(t.p,{children:"etcd is a distributed key-value store. In fact, etcd is the primary datastore of Kubernetes; storing and replicating all Kubernetes cluster state. As a critical component of a Kubernetes cluster having a reliable automated approach to its configuration and management is imperative."}),"\n",(0,s.jsx)(t.p,{children:"As a distributed consensus-based system, the cluster configuration of etcd can be complicated. Bootstrapping, maintaining quorum, reconfiguring cluster membership, creating backups, handling disaster recovery, and monitoring critical events are tedious work, and require etcd-specific expertise."}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:["uses Raft consensus algorithm - ",(0,s.jsx)(t.a,{href:"https://raft.github.io",children:"https://raft.github.io"})]}),"\n",(0,s.jsx)(t.li,{children:"etcd means distributed etc directory"}),"\n",(0,s.jsx)(t.li,{children:"used by kubernetes, emqx, openshift"}),"\n"]}),"\n",(0,s.jsx)(t.h3,{id:"operator",children:"Operator"}),"\n",(0,s.jsx)(t.p,{children:"An Operator builds upon the basic Kubernetes resource and controller concepts but includes application domain knowledge to take care of common tasks. They reduce the complexity of running distributed systems and help you focus on the desired configuration, not the details of manual deployment and lifecycle management."}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.a,{href:"https://coreos.com/etcd",children:"https://coreos.com/etcd"})}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.a,{href:"https://github.com/etcd-io/etcd",children:"https://github.com/etcd-io/etcd"})}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.a,{href:"https://etcd.readthedocs.io/en/latest/faq.html#what-is-etcd",children:"https://etcd.readthedocs.io/en/latest/faq.html#what-is-etcd"})}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.a,{href:"https://jepsen.io/analyses/etcd-3.4.3",children:"https://jepsen.io/analyses/etcd-3.4.3"})}),"\n",(0,s.jsx)(t.h3,{id:"is-it-possible-for-etcd-to-have-a-split-brain-scenario",children:"Is it possible for etcd to have a split-brain scenario?"}),"\n",(0,s.jsx)(t.p,{children:"What is split-brain scenario?"}),"\n",(0,s.jsx)(t.p,{children:"Split brain scenarios occur when a group of nodes in a distributed system loses communication with each other primarily due to network partitioning, resulting in inconsistent or conflicting system states."}),"\n",(0,s.jsx)(t.p,{children:"etcd is designed to avoid split-brain scenarios, as it relies on a leader election mechanism to ensure that only one node is active and in control of the cluster at any given time."}),"\n",(0,s.jsx)(t.p,{children:'The official documentation says, there is no "split-brain" in etcd. Here is why.'}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"A network partition divides the etcd cluster into two parts; one with a member majority and the other with a member minority."}),"\n",(0,s.jsx)(t.li,{children:"The majority side becomes the available cluster and the minority side is unavailable"}),"\n",(0,s.jsx)(t.li,{children:"If the leader is on the majority side, then from the majority point of view the failure is a minority follower failure."}),"\n",(0,s.jsx)(t.li,{children:"If the leader is on the minority side, then it is a leader failure."}),"\n",(0,s.jsx)(t.li,{children:"The leader on the minority side steps down and the majority side elects a new leader."}),"\n",(0,s.jsx)(t.li,{children:"Once the network partition clears, the minority side automatically recognizes the leader from the majority side and recovers its state."}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:"So how does the leader know weather its in the majority or minority?"}),"\n",(0,s.jsx)(t.p,{children:'etcd nodes regularly send "heartbeats" to each other.'}),"\n",(0,s.jsx)(t.p,{children:"If the leader is in the minority part of the split, it will not receive acknowledgments from the majority of the nodes."}),"\n",(0,s.jsx)(t.p,{children:"When the leader doesn't get enough responses to its heartbeats, it realizes that it might be in the minority."}),"\n",(0,s.jsx)(t.p,{children:"To maintain the integrity of the system, it steps down from its leadership role."}),"\n",(0,s.jsx)(t.p,{children:"On the other side of the partition, where the majority of nodes are, they also notice they're not getting heartbeats from the leader. Since they are the majority, they can elect a new leader among themselves."})]})}function h(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},28453:(e,t,i)=>{i.d(t,{R:()=>r,x:()=>o});var n=i(296540);const s={},a=n.createContext(s);function r(e){const t=n.useContext(a);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),n.createElement(a.Provider,{value:t},e.children)}}}]);