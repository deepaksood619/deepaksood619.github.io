"use strict";(self.webpackChunkdeep_notes=self.webpackChunkdeep_notes||[]).push([[74173],{134121:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>a,default:()=>h,frontMatter:()=>r,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"about-deepak-sood/projects/70-interview-datainsight-alerting-engine","title":"Interview - Datainsight / Alerting Engine","description":"Data Insight","source":"@site/docs/about-deepak-sood/projects/70-interview-datainsight-alerting-engine.md","sourceDirName":"about-deepak-sood/projects","slug":"/about-deepak-sood/projects/70-interview-datainsight-alerting-engine","permalink":"/about-deepak-sood/projects/70-interview-datainsight-alerting-engine","draft":false,"unlisted":false,"editUrl":"https://github.com/deepaksood619/deepaksood619.github.io/tree/master/docs/about-deepak-sood/projects/70-interview-datainsight-alerting-engine.md","tags":[],"version":"current","lastUpdatedBy":"Deepak","lastUpdatedAt":1734460977000,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Data Engineering - Battle Cards","permalink":"/about-deepak-sood/projects/67-data-engineering-battle-cards"},"next":{"title":"Opstree Standard Proposal Format","permalink":"/about-deepak-sood/projects/71-opstree-standard-proposal-format"}}');var l=i(474848),t=i(28453);const r={},a="Interview - Datainsight / Alerting Engine",d={},c=[{value:"Data Insight",id:"data-insight",level:2},{value:"Technical architecture",id:"technical-architecture",level:3},{value:"Integration Setbacks (Technical Problem)",id:"integration-setbacks-technical-problem",level:3},{value:"Assumption",id:"assumption",level:4},{value:"Problems",id:"problems",level:4},{value:"Solutions",id:"solutions",level:4},{value:"Technological Hurdles (Technical Problem)",id:"technological-hurdles-technical-problem",level:3},{value:"Visualization (end to end from databases to visualization service)",id:"visualization-end-to-end-from-databases-to-visualization-service",level:4},{value:"Assumption",id:"assumption-1",level:5},{value:"Tech architecture",id:"tech-architecture",level:5},{value:"Questions",id:"questions",level:5},{value:"Low Latency Alerting System",id:"low-latency-alerting-system",level:2},{value:"Questions",id:"questions-1",level:3},{value:"Solution",id:"solution",level:3},{value:"Architecture",id:"architecture",level:2},{value:"Followups",id:"followups",level:5},{value:"Alerting Exceptions Handling",id:"alerting-exceptions-handling",level:3}];function o(e){const n={h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",header:"header",img:"img",li:"li",ol:"ol",p:"p",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.header,{children:(0,l.jsx)(n.h1,{id:"interview---datainsight--alerting-engine",children:"Interview - Datainsight / Alerting Engine"})}),"\n",(0,l.jsx)(n.h2,{id:"data-insight",children:"Data Insight"}),"\n",(0,l.jsx)(n.p,{children:'Your company is developing a new cloud-based analytics platform, "DataInsight," designed to provide advanced data processing and visualization capabilities for enterprise clients. The platform integrates with various data sources (telemetry metrics) utilizes machine learning for predictive analytics, and offers a highly interactive and customizable dashboard for end-users.'}),"\n",(0,l.jsx)(n.h3,{id:"technical-architecture",children:"Technical architecture"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Ingestion to database"}),"\n",(0,l.jsx)(n.li,{children:"Database to services (visualization and analytics including ML)"}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"integration-setbacks-technical-problem",children:"Integration Setbacks (Technical Problem)"}),"\n",(0,l.jsx)(n.p,{children:"The platform struggles to integrate smoothly with a"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"wide range of customer databases especially legacy systems"}),"\n",(0,l.jsx)(n.li,{children:"causing delays"}),"\n",(0,l.jsx)(n.li,{children:"data inconsistency issues."}),"\n",(0,l.jsx)(n.li,{children:"Common set of communication protocols from client sensors too"}),"\n"]}),"\n",(0,l.jsx)(n.h4,{id:"assumption",children:"Assumption"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["We have standardized data at our end in Influxdb","\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["Clients (50-5000) -","\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["Branches / Locations - (less - 500-2,50,000)","\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Sensors - measurement (500 sensors, millions)"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["Table schema","\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"(row oriented, column oriented, non-normalized)"}),"\n",(0,l.jsxs)(n.li,{children:["Clients","\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"client_id pk"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["Locations","\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"client fk"}),"\n",(0,l.jsx)(n.li,{children:"location_id pk"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["Raw Sensor Data","\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"location_id fk"}),"\n",(0,l.jsx)(n.li,{children:"sensor_type_fk - fk"}),"\n",(0,l.jsx)(n.li,{children:"values"}),"\n",(0,l.jsx)(n.li,{children:"timestamp"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["Sensor Type","\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"id"}),"\n",(0,l.jsx)(n.li,{children:"sensor_id - 5"}),"\n",(0,l.jsx)(n.li,{children:"parameter - 1 (temp)"}),"\n",(0,l.jsx)(n.li,{children:"metadata - temp (5, 1), humidity (5, 2)"}),"\n",(0,l.jsx)(n.li,{children:"pk - (sensor_id + parameter)"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["Query","\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Aggregate - last week average"}),"\n",(0,l.jsx)(n.li,{children:"15-16 values"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["Device (not a table) - AC","\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"What temp i am set at"}),"\n",(0,l.jsx)(n.li,{children:"What current and voltage i am consuming"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["Multi-tenant / single-tenant","\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"multi-tenant system"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.h4,{id:"problems",children:"Problems"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"wide range of customer databases"}),"\n"]}),"\n",(0,l.jsx)(n.h4,{id:"solutions",children:"Solutions"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Standard set of Ingestion APIs, so integration should be simpler"}),"\n",(0,l.jsx)(n.li,{children:"Producers can be standardized"}),"\n",(0,l.jsx)(n.li,{children:"Serialization / deserialization"}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"technological-hurdles-technical-problem",children:"Technological Hurdles (Technical Problem)"}),"\n",(0,l.jsx)(n.p,{children:"The machine learning models are not performing as expected, leading to inaccurate predictions and inefficient data processing. The cause is unclear, whether it's due to poor model selection, inadequate training data, or something else."}),"\n",(0,l.jsx)(n.h4,{id:"visualization-end-to-end-from-databases-to-visualization-service",children:"Visualization (end to end from databases to visualization service)"}),"\n",(0,l.jsx)(n.h5,{id:"assumption-1",children:"Assumption"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsx)(n.li,{children:"Sensor"}),"\n"]}),"\n",(0,l.jsx)(n.h5,{id:"tech-architecture",children:"Tech architecture"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Database"}),"\n",(0,l.jsxs)(n.li,{children:["Backend service","\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"APIs for highcharts that will give the sensor data"}),"\n",(0,l.jsx)(n.li,{children:"Batch reporting apis"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["Frontend service - show users the end data","\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"IAM"}),"\n",(0,l.jsx)(n.li,{children:"React / Angular - Client side rendered"}),"\n",(0,l.jsxs)(n.li,{children:["Client side app","\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Don't need to send containers all the time"}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.li,{children:"Responsive - Desktop / Mobile"}),"\n",(0,l.jsx)(n.li,{children:"Visualization library - highcharts"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.h5,{id:"questions",children:"Questions"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsx)(n.li,{children:"How much data (10 years, 1 years)"}),"\n",(0,l.jsx)(n.li,{children:"Roll ups"}),"\n",(0,l.jsx)(n.li,{children:"Accuracy of old data"}),"\n",(0,l.jsx)(n.li,{children:"Data tiering"}),"\n",(0,l.jsx)(n.li,{children:"Query speed"}),"\n",(0,l.jsx)(n.li,{children:"Batch Reporting - for downloading large datasets, export"}),"\n",(0,l.jsx)(n.li,{children:"Add queueing and do asynchronous processing"}),"\n",(0,l.jsx)(n.li,{children:"Wait for data, either in mail, or downloads page"}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.strong,{children:"Real time analytics"})}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"low-latency-alerting-system",children:"Low Latency Alerting System"}),"\n",(0,l.jsx)(n.p,{children:"Time series data is being published from loT devices(MQTT) across the building. There are various data types like efficiency, energy consumption, equipment on/off, etc."}),"\n",(0,l.jsx)(n.p,{children:"The user wants different categories of alerts like critical, high, medium, and low."}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Critical - need to be initiated instantly. (within milliseconds)"}),"\n",(0,l.jsx)(n.li,{children:"High - need to be initiated within 10 seconds to 1 minute."}),"\n",(0,l.jsx)(n.li,{children:"Medium - need to be initiated within 5 minutes - 6 hours."}),"\n",(0,l.jsx)(n.li,{children:"Low- can be sent up to once a day or week."}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"Whenever an alerting condition is met, it should trigger an alert and send it to all subscribed users via their preferred mode in the given below template-"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["Alert Summary","\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Timestamp"}),"\n",(0,l.jsx)(n.li,{children:"Priority"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["Asset Name","\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Suggested Action For e.g Most likely Automation commands are not working on the chiller, Please switch the chiller to JouleTrack mode, turn it on, and then return it to recipe mode."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"What all different system components can be brought together to send user alerts on different mediums (push notification, whatsapp, email, message)?"}),"\n",(0,l.jsx)(n.p,{children:"Instruction"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsx)(n.li,{children:"Please create a component level diagram to discussion the solution design"}),"\n",(0,l.jsx)(n.li,{children:"Solution should be low latency, fault-tolerance and distributed in nature. It can be easily scaled to serve millions of monthly alerts to users."}),"\n",(0,l.jsx)(n.li,{children:"Data modeling diagram to represent how things are connected to each other and how data is flowing."}),"\n",(0,l.jsx)(n.li,{children:"Trade Off decisions should be highlighted."}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"questions-1",children:"Questions"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsx)(n.li,{children:"size of data?"}),"\n",(0,l.jsx)(n.li,{children:"Rate of stream? - 10K per second"}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"solution",children:"Solution"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Alert mapping table (in memory or redis)"}),"\n",(0,l.jsx)(n.li,{children:"Subscribe to mqtt topics"}),"\n",(0,l.jsx)(n.li,{children:"Log to alerts too - rdms"}),"\n",(0,l.jsx)(n.li,{children:"Async processing"}),"\n",(0,l.jsxs)(n.li,{children:["Better processing","\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Kafka streams"}),"\n",(0,l.jsx)(n.li,{children:"Apache Pulsar"}),"\n",(0,l.jsx)(n.li,{children:"Druid"}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.li,{children:"Consumer Lag"}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"architecture",children:"Architecture"}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.img,{alt:"mqtt-alerting-engine",src:i(275797).A+"",width:"1651",height:"901"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["Alert mapping table - Main copy in RDBMS","\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Pushed copy in redis"}),"\n",(0,l.jsx)(n.li,{children:"Updates pushed to redis from RDMS whenever changed"}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.li,{children:"Backend service - mqtt broker to redis streams conversion for creating consumer group"}),"\n",(0,l.jsx)(n.li,{children:"Redis streams (single topic)"}),"\n",(0,l.jsxs)(n.li,{children:["Backend service - alert processing module","\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Process the packet"}),"\n",(0,l.jsx)(n.li,{children:"match it with alert mapping table"}),"\n",(0,l.jsx)(n.li,{children:"push to redis streams communication channel"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["Backend service - alerting engine","\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Log the incoming alert"}),"\n",(0,l.jsxs)(n.li,{children:["Call the communications api (based on alert mapping, or alert processing module can ",(0,l.jsx)(n.strong,{children:"send the channel too"}),")","\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Whatsapp"}),"\n",(0,l.jsx)(n.li,{children:"Email"}),"\n",(0,l.jsx)(n.li,{children:"SMS"}),"\n",(0,l.jsx)(n.li,{children:"Push"}),"\n",(0,l.jsx)(n.li,{children:"Telegram, etc"}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.li,{children:"Can send multiple customers"}),"\n",(0,l.jsx)(n.li,{children:"Webhook for delivery status"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["Scaling ways","\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Multithreading"}),"\n",(0,l.jsx)(n.li,{children:"Asyncio"}),"\n",(0,l.jsx)(n.li,{children:"Horizontal Scaling"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.h5,{id:"followups",children:"Followups"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Duplicate"}),"\n",(0,l.jsx)(n.li,{children:"Automatic resolutions"}),"\n",(0,l.jsx)(n.li,{children:"Fire forget"}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"alerting-exceptions-handling",children:"Alerting Exceptions Handling"}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.img,{alt:"alerting-exceptions-handling-flow",src:i(953042).A+"",width:"1255",height:"2120"})})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(o,{...e})}):o(e)}},953042:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/Communication exception flow-de60645458008ace8aa56e5f973ff3e1.png"},275797:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/MQTT Alerting Engine.drawio-1f7875dff64fdaa199e8eba1487df5f1.png"},28453:(e,n,i)=>{i.d(n,{R:()=>r,x:()=>a});var s=i(296540);const l={},t=s.createContext(l);function r(e){const n=s.useContext(t);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:r(e.components),s.createElement(t.Provider,{value:n},e.children)}}}]);