"use strict";(self.webpackChunkdeep_notes=self.webpackChunkdeep_notes||[]).push([[45351],{885656:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>d,default:()=>h,frontMatter:()=>o,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"languages/sql/interview-questions","title":"Interview Questions","description":"Sample Schema - Ecommerce Analytics","source":"@site/docs/languages/sql/interview-questions.md","sourceDirName":"languages/sql","slug":"/languages/sql/interview-questions","permalink":"/languages/sql/interview-questions","draft":false,"unlisted":false,"editUrl":"https://github.com/deepaksood619/deepaksood619.github.io/tree/master/docs/languages/sql/interview-questions.md","tags":[],"version":"current","lastUpdatedBy":"Deepak","lastUpdatedAt":1762888182000,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Functions","permalink":"/languages/sql/functions"},"next":{"title":"Intro","permalink":"/languages/sql/intro"}}');var t=s(474848),i=s(28453);const o={},d="Interview Questions",c={},l=[{value:"Sample Schema - Ecommerce Analytics",id:"sample-schema---ecommerce-analytics",level:2},{value:"Basic Questions (SQL Fundamentals)",id:"basic-questions-sql-fundamentals",level:2},{value:"Intermediate Questions (Joins, Aggregation, Filtering)",id:"intermediate-questions-joins-aggregation-filtering",level:2},{value:"Advanced Questions (Subqueries, CTEs, Window Functions)",id:"advanced-questions-subqueries-ctes-window-functions",level:2},{value:"Expert Questions (Optimization, Edge Cases, Tricky Logic)",id:"expert-questions-optimization-edge-cases-tricky-logic",level:2},{value:"Bonus Topics for Senior-Level Interviews",id:"bonus-topics-for-senior-level-interviews",level:2},{value:"Sample Schema",id:"sample-schema",level:2},{value:"SQL Questions",id:"sql-questions",level:2}];function a(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"interview-questions",children:"Interview Questions"})}),"\n",(0,t.jsx)(n.h2,{id:"sample-schema---ecommerce-analytics",children:"Sample Schema - Ecommerce Analytics"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:"+-------------------+\n|   customers       |\n+-------------------+\n| customer_id (PK)  |\n| name              |\n| email             |\n| city              |\n| signup_date       |\n+-------------------+\n          |\n          | 1..* (a customer can place many orders)\n          |\n          v\n+-------------------+\n|     orders        |\n+-------------------+\n| order_id (PK)     |\n| customer_id (FK)  ---\x3e customers.customer_id\n| order_date        |\n| total_amount      |\n+-------------------+\n          |\n          | 1..* (an order has many order_items)\n          |\n          v\n+-------------------+\n|   order_items     |\n+-------------------+\n| order_item_id (PK)|\n| order_id (FK)     ---\x3e orders.order_id\n| product_id (FK)   ---\x3e products.product_id\n| quantity          |\n| price_per_unit    |\n+-------------------+\n\n+-------------------+\n|    products       |\n+-------------------+\n| product_id (PK)   |\n| name              |\n| category          |\n| price             |\n+-------------------+\n\n          ^\n          | (each item refers to one product)\n          |\n\n+-------------------+\n|    payments       |\n+-------------------+\n| payment_id (PK)   |\n| order_id (FK)     ---\x3e orders.order_id\n| payment_date      |\n| amount            |\n| payment_method    |\n+-------------------+\n"})}),"\n",(0,t.jsx)(n.h2,{id:"basic-questions-sql-fundamentals",children:"Basic Questions (SQL Fundamentals)"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Q1."})," Fetch all customers who signed up in 2024."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:"SELECT * FROM customers\nWHERE EXTRACT(YEAR FROM signup_date) = 2024;\n"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Q2."})," Get the total number of orders placed by each customer."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:"SELECT customer_id, COUNT(*) AS order_count\nFROM orders\nGROUP BY customer_id;\n"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Q3."})," Find customers who haven\u2019t placed any orders."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:"SELECT c.customer_id, c.name\nFROM customers c\nLEFT JOIN orders o ON c.customer_id = o.customer_id\nWHERE o.order_id IS NULL;\n"})}),"\n",(0,t.jsx)(n.h2,{id:"intermediate-questions-joins-aggregation-filtering",children:"Intermediate Questions (Joins, Aggregation, Filtering)"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Q4."})," Retrieve top 3 products by total revenue."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:"SELECT p.name, SUM(oi.quantity * oi.price_per_unit) AS revenue\nFROM order_items oi\nJOIN products p ON oi.product_id = p.product_id\nGROUP BY p.name\nORDER BY revenue DESC\nLIMIT 3;\n"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Q5."})," Get total revenue by product category for the current year."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:"SELECT p.category, SUM(oi.quantity * oi.price_per_unit) AS total_revenue\nFROM order_items oi\nJOIN products p ON oi.product_id = p.product_id\nJOIN orders o ON oi.order_id = o.order_id\nWHERE EXTRACT(YEAR FROM o.order_date) = EXTRACT(YEAR FROM CURRENT_DATE)\nGROUP BY p.category;\n"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Q6."})," Find customers who have spent more than \u20b910,000 in total."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:"SELECT c.customer_id, c.name, SUM(o.total_amount) AS total_spent\nFROM customers c\nJOIN orders o ON c.customer_id = o.customer_id\nGROUP BY c.customer_id, c.name\nHAVING SUM(o.total_amount) > 10000;\n"})}),"\n",(0,t.jsx)(n.h2,{id:"advanced-questions-subqueries-ctes-window-functions",children:"Advanced Questions (Subqueries, CTEs, Window Functions)"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Q7."})," Find the latest order for each customer."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:"SELECT customer_id, order_id, order_date\nFROM (\n  SELECT customer_id, order_id, order_date,\n         ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY order_date DESC) AS rn\n  FROM orders\n) t\nWHERE rn = 1;\n"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Q8."})," Get the top 5 customers by lifetime value (LTV)."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:"SELECT c.name, SUM(o.total_amount) AS ltv\nFROM customers c\nJOIN orders o ON c.customer_id = o.customer_id\nGROUP BY c.name\nORDER BY ltv DESC\nLIMIT 5;\n"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Q9."})," Find the percentage contribution of each category to total revenue."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:"WITH category_revenue AS (\n  SELECT p.category, SUM(oi.quantity * oi.price_per_unit) AS revenue\n  FROM order_items oi\n  JOIN products p ON oi.product_id = p.product_id\n  GROUP BY p.category\n)\nSELECT category,\n       revenue,\n       ROUND(100 * revenue / SUM(revenue) OVER (), 2) AS pct_of_total\nFROM category_revenue;\n"})}),"\n",(0,t.jsx)(n.h2,{id:"expert-questions-optimization-edge-cases-tricky-logic",children:"Expert Questions (Optimization, Edge Cases, Tricky Logic)"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Q10."})," Identify orders where payment is missing or partial."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:"SELECT o.order_id, o.total_amount, COALESCE(SUM(p.amount), 0) AS paid_amount\nFROM orders o\nLEFT JOIN payments p ON o.order_id = p.order_id\nGROUP BY o.order_id, o.total_amount\nHAVING COALESCE(SUM(p.amount), 0) < o.total_amount;\n"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Q11."})," For each customer, show month-over-month growth in spending."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:"WITH monthly_spend AS (\n  SELECT customer_id,\n         DATE_TRUNC('month', order_date) AS month,\n         SUM(total_amount) AS spend\n  FROM orders\n  GROUP BY customer_id, DATE_TRUNC('month', order_date)\n)\nSELECT customer_id,\n       month,\n       spend,\n       spend - LAG(spend) OVER (PARTITION BY customer_id ORDER BY month) AS growth\nFROM monthly_spend;\n"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Q12."})," Find the most popular product category per city."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:"WITH city_category_sales AS (\n  SELECT c.city, p.category, SUM(oi.quantity) AS qty\n  FROM order_items oi\n  JOIN orders o ON oi.order_id = o.order_id\n  JOIN customers c ON o.customer_id = c.customer_id\n  JOIN products p ON oi.product_id = p.product_id\n  GROUP BY c.city, p.category\n),\nranked AS (\n  SELECT *, ROW_NUMBER() OVER (PARTITION BY city ORDER BY qty DESC) AS rn\n  FROM city_category_sales\n)\nSELECT city, category, qty\nFROM ranked\nWHERE rn = 1;\n"})}),"\n",(0,t.jsx)(n.h2,{id:"bonus-topics-for-senior-level-interviews",children:"Bonus Topics for Senior-Level Interviews"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Topic"}),(0,t.jsx)(n.th,{children:"Sample Question"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"Indexes"})}),(0,t.jsxs)(n.td,{children:["Explain when to use composite indexes and how they affect ",(0,t.jsx)(n.code,{children:"WHERE"})," clause performance."]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"Query Optimization"})}),(0,t.jsx)(n.td,{children:"How would you debug a slow query that joins 5 tables?"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"Transactions"})}),(0,t.jsx)(n.td,{children:"What happens if one statement in a transaction fails?"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"Isolation Levels"})}),(0,t.jsx)(n.td,{children:"Explain \u201cphantom read\u201d and how to prevent it."})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"Partitioning"})}),(0,t.jsxs)(n.td,{children:["How would you partition the ",(0,t.jsx)(n.code,{children:"orders"})," table by year for performance?"]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"CTE vs Subquery"})}),(0,t.jsx)(n.td,{children:"When to prefer one over the other?"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"Window Functions"})}),(0,t.jsxs)(n.td,{children:["How are ",(0,t.jsx)(n.code,{children:"ROW_NUMBER()"})," and ",(0,t.jsx)(n.code,{children:"RANK()"})," different?"]})]})]})]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.a,{href:"https://chatgpt.com/share/69019e55-5d84-8008-9b05-83dd7f4143e5",children:"ChatGPT - SQL interview questions"})}),"\n",(0,t.jsx)(n.h2,{id:"sample-schema",children:"Sample Schema"}),"\n",(0,t.jsxs)(n.p,{children:["Real estate agents purchase our advertising product, Premier Agent, on a monthly basis. Let\u2019s assume we have a table which stores\xa0",(0,t.jsx)(n.code,{children:"AgentID, Month, Spend"}),"."]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Write a query to track the following 4 metrics every month (relative to the prior month):"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"New Purchase"}),", which is the spend from a new agent who joined Zillow\u2019s platform that month"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Mod-Up"}),", which is the increase in spend from an agent in a given month relative to the previous month"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Cancel"}),", which is the spend we\u2019ve lost from an agent who cancelled their spend at the end of the previous month"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Mod-Down"}),", which is the decrease in spend from an agent in a given month relative to the previous month"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"The final product should be a summary table showing the total for each metric."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Monthly_Spend"})}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Zuid"}),(0,t.jsx)(n.th,{children:"Month"}),(0,t.jsx)(n.th,{children:"Spend"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"123"}),(0,t.jsx)(n.td,{children:"2020-01-01"}),(0,t.jsx)(n.td,{children:"$100"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"123"}),(0,t.jsx)(n.td,{children:"2020-02-01"}),(0,t.jsx)(n.td,{children:"$150"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"456"}),(0,t.jsx)(n.td,{children:"2020-01-01"}),(0,t.jsx)(n.td,{children:"$75"})]})]})]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.strong,{children:"[execution time limit] 10 seconds (mysql)"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.strong,{children:"[memory limit] 1 GB"})}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"sql-questions",children:"SQL Questions"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["Find the ",(0,t.jsx)(n.strong,{children:"3rd highest salary"})," in a company, returning all employees who have that salary."]}),"\n",(0,t.jsxs)(n.li,{children:["Find the ",(0,t.jsx)(n.strong,{children:"top 2 scorers per subject"})," from a marks table."]}),"\n",(0,t.jsxs)(n.li,{children:["Find the ",(0,t.jsx)(n.strong,{children:"highest paid employee in each department"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:["Find the ",(0,t.jsx)(n.strong,{children:"second highest salary in each department"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:["Find ",(0,t.jsx)(n.strong,{children:"students who scored more than the class average"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:["Find the ",(0,t.jsx)(n.strong,{children:"cumulative total salary"})," per department ordered by salary descending."]}),"\n",(0,t.jsxs)(n.li,{children:["Find the ",(0,t.jsx)(n.strong,{children:"employee(s) whose salary is just below the maximum salary"})," in the company (difference-based)."]}),"\n",(0,t.jsxs)(n.li,{children:["List ",(0,t.jsx)(n.strong,{children:"employees ranked by salary within each department"})," using ",(0,t.jsx)(n.code,{children:"ROW_NUMBER()"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:["Find ",(0,t.jsx)(n.strong,{children:"products whose price is above the average price in their category"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:["Find ",(0,t.jsx)(n.strong,{children:"the difference between each employee\u2019s salary and the department average"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:["Find the ",(0,t.jsx)(n.strong,{children:"running total of sales"})," ordered by sale date."]}),"\n",(0,t.jsxs)(n.li,{children:["Find the ",(0,t.jsx)(n.strong,{children:"first transaction per customer"})," by date."]}),"\n",(0,t.jsxs)(n.li,{children:["Find the ",(0,t.jsx)(n.strong,{children:"top 3 selling products"})," based on total revenue."]}),"\n",(0,t.jsxs)(n.li,{children:["Find ",(0,t.jsx)(n.strong,{children:"students who scored exactly the median score"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:["Find ",(0,t.jsx)(n.strong,{children:"employees who earn more than their manager"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:["Find ",(0,t.jsx)(n.strong,{children:"consecutive login days"})," for each user (window + gaps)."]}),"\n",(0,t.jsxs)(n.li,{children:["Find the ",(0,t.jsx)(n.strong,{children:"latest salary record"})," per employee from a historical salary table."]}),"\n",(0,t.jsxs)(n.li,{children:["Find ",(0,t.jsx)(n.strong,{children:"percentage contribution"})," of each product to total sales."]}),"\n",(0,t.jsxs)(n.li,{children:["Find ",(0,t.jsx)(n.strong,{children:"customers who purchased more than once within 7 days"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:["Find ",(0,t.jsx)(n.strong,{children:"each employee\u2019s salary rank across the company and within their department"}),"."]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(a,{...e})}):a(e)}},28453:(e,n,s)=>{s.d(n,{R:()=>o,x:()=>d});var r=s(296540);const t={},i=r.createContext(t);function o(e){const n=r.useContext(i);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),r.createElement(i.Provider,{value:n},e.children)}}}]);