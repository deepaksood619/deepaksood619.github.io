"use strict";(self.webpackChunkdeep_notes=self.webpackChunkdeep_notes||[]).push([[23992],{331391:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>a,default:()=>o,frontMatter:()=>l,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"databases-sql/mysql/thread-states","title":"Thread States","description":"The following list describes thread State values that are associated with general query processing and not more specialized activities such as replication. Many of these are useful only for finding bugs in the server.","source":"@site/docs/databases-sql/mysql/thread-states.md","sourceDirName":"databases-sql/mysql","slug":"/databases-sql/mysql/thread-states","permalink":"/databases-sql/mysql/thread-states","draft":false,"unlisted":false,"editUrl":"https://github.com/deepaksood619/deepaksood619.github.io/tree/master/docs/databases-sql/mysql/thread-states.md","tags":[],"version":"current","lastUpdatedBy":"Deepak","lastUpdatedAt":1749575438000,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"SQL / MySQL Tools","permalink":"/databases-sql/mysql/sql-mysql-tools"},"next":{"title":"Trasaction / Commit / Rollback","permalink":"/databases-sql/mysql/transaction-commit-rollback"}}');var i=t(474848),r=t(28453);const l={},a="Thread States",d={},c=[];function h(e){const n={a:"a",code:"code",em:"em",h1:"h1",header:"header",li:"li",p:"p",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"thread-states",children:"Thread States"})}),"\n",(0,i.jsxs)(n.p,{children:["The following list describes thread ",(0,i.jsx)(n.code,{children:"State"})," values that are associated with general query processing and not more specialized activities such as replication. Many of these are useful only for finding bugs in the server."]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"After create"})}),"\n",(0,i.jsx)(n.p,{children:"This occurs when the thread creates a table (including internal temporary tables), at the end of the function that creates the table. This state is used even if the table could not be created due to some error."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"altering table"})}),"\n",(0,i.jsxs)(n.p,{children:["The server is in the process of executing an in-place ",(0,i.jsx)(n.a,{href:"https://dev.mysql.com/doc/refman/8.0/en/alter-table.html",title:"15.1.9 ALTER TABLE Statement",children:(0,i.jsx)(n.code,{children:"ALTER TABLE"})}),"."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"Analyzing"})}),"\n",(0,i.jsxs)(n.p,{children:["The thread is calculating a ",(0,i.jsx)(n.code,{children:"MyISAM"})," table key distributions (for example, for ",(0,i.jsx)(n.a,{href:"https://dev.mysql.com/doc/refman/8.0/en/analyze-table.html",title:"15.7.3.1 ANALYZE TABLE Statement",children:(0,i.jsx)(n.code,{children:"ANALYZE TABLE"})}),")."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"checking permissions"})}),"\n",(0,i.jsx)(n.p,{children:"The thread is checking whether the server has the required privileges to execute the statement."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"Checking table"})}),"\n",(0,i.jsx)(n.p,{children:"The thread is performing a table check operation."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"cleaning up"})}),"\n",(0,i.jsx)(n.p,{children:"The thread has processed one command and is preparing to free memory and reset certain state variables."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"closing tables"})}),"\n",(0,i.jsx)(n.p,{children:"The thread is flushing the changed table data to disk and closing the used tables. This should be a fast operation. If not, verify that you do not have a full disk and that the disk is not in very heavy use."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"committing alter table to storage engine"})}),"\n",(0,i.jsxs)(n.p,{children:["The server has finished an in-place ",(0,i.jsx)(n.a,{href:"https://dev.mysql.com/doc/refman/8.0/en/alter-table.html",title:"15.1.9 ALTER TABLE Statement",children:(0,i.jsx)(n.code,{children:"ALTER TABLE"})})," and is committing the result."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"converting HEAP to ondisk"})}),"\n",(0,i.jsxs)(n.p,{children:["The thread is converting an internal temporary table from a ",(0,i.jsx)(n.code,{children:"MEMORY"})," table to an on-disk table."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"copy to tmp table"})}),"\n",(0,i.jsxs)(n.p,{children:["The thread is processing an ",(0,i.jsx)(n.a,{href:"https://dev.mysql.com/doc/refman/8.0/en/alter-table.html",title:"15.1.9 ALTER TABLE Statement",children:(0,i.jsx)(n.code,{children:"ALTER TABLE"})})," statement. This state occurs after the table with the new structure has been created but before rows are copied into it."]}),"\n",(0,i.jsxs)(n.p,{children:["For a thread in this state, the Performance Schema can be used to obtain about the progress of the copy operation. See ",(0,i.jsx)(n.a,{href:"https://dev.mysql.com/doc/refman/8.0/en/performance-schema-stage-tables.html",title:"29.12.5 Performance Schema Stage Event Tables",children:'Section 29.12.5, "Performance Schema Stage Event Tables"'}),"."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"Copying to group table"})}),"\n",(0,i.jsxs)(n.p,{children:["If a statement has different ",(0,i.jsx)(n.code,{children:"ORDER BY"})," and ",(0,i.jsx)(n.code,{children:"GROUP BY"})," criteria, the rows are sorted by group and copied to a temporary table."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"Copying to tmp table"})}),"\n",(0,i.jsx)(n.p,{children:"The server is copying to a temporary table in memory."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"Copying to tmp table on disk"})}),"\n",(0,i.jsxs)(n.p,{children:["The server is copying to a temporary table on disk. The temporary result set has become too large (see ",(0,i.jsx)(n.a,{href:"https://dev.mysql.com/doc/refman/8.0/en/internal-temporary-tables.html",title:"10.4.4 Internal Temporary Table Use in MySQL",children:'Section 10.4.4, "Internal Temporary Table Use in MySQL"'}),"). Consequently, the thread is changing the temporary table from in-memory to disk-based format to save memory."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"Creating index"})}),"\n",(0,i.jsxs)(n.p,{children:["The thread is processing ",(0,i.jsx)(n.code,{children:"ALTER TABLE ... ENABLE KEYS"})," for a ",(0,i.jsx)(n.code,{children:"MyISAM"})," table."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"Creating sort index"})}),"\n",(0,i.jsxs)(n.p,{children:["The thread is processing a ",(0,i.jsx)(n.a,{href:"https://dev.mysql.com/doc/refman/8.0/en/select.html",title:"15.2.13 SELECT Statement",children:(0,i.jsx)(n.code,{children:"SELECT"})})," that is resolved using an internal temporary table."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"creating table"})}),"\n",(0,i.jsx)(n.p,{children:"The thread is creating a table. This includes creation of temporary tables."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"Creating tmp table"})}),"\n",(0,i.jsxs)(n.p,{children:["The thread is creating a temporary table in memory or on disk. If the table is created in memory but later is converted to an on-disk table, the state during that operation is ",(0,i.jsx)(n.code,{children:"Copying to tmp table on disk"}),"."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"deleting from main table"})}),"\n",(0,i.jsx)(n.p,{children:"The server is executing the first part of a multiple-table delete. It is deleting only from the first table, and saving columns and offsets to be used for deleting from the other (reference) tables."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"deleting from reference tables"})}),"\n",(0,i.jsx)(n.p,{children:"The server is executing the second part of a multiple-table delete and deleting the matched rows from the other tables."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"discard_or_import_tablespace"})}),"\n",(0,i.jsxs)(n.p,{children:["The thread is processing an ",(0,i.jsx)(n.code,{children:"ALTER TABLE ... DISCARD TABLESPACE"})," or ",(0,i.jsx)(n.code,{children:"ALTER TABLE ... IMPORT TABLESPACE"})," statement."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"end"})}),"\n",(0,i.jsxs)(n.p,{children:["This occurs at the end but before the cleanup of ",(0,i.jsx)(n.a,{href:"https://dev.mysql.com/doc/refman/8.0/en/alter-table.html",title:"15.1.9 ALTER TABLE Statement",children:(0,i.jsx)(n.code,{children:"ALTER TABLE"})}),", ",(0,i.jsx)(n.a,{href:"https://dev.mysql.com/doc/refman/8.0/en/create-view.html",title:"15.1.23 CREATE VIEW Statement",children:(0,i.jsx)(n.code,{children:"CREATE VIEW"})}),", ",(0,i.jsx)(n.a,{href:"https://dev.mysql.com/doc/refman/8.0/en/delete.html",title:"15.2.2 DELETE Statement",children:(0,i.jsx)(n.code,{children:"DELETE"})}),", ",(0,i.jsx)(n.a,{href:"https://dev.mysql.com/doc/refman/8.0/en/insert.html",title:"15.2.7 INSERT Statement",children:(0,i.jsx)(n.code,{children:"INSERT"})}),", ",(0,i.jsx)(n.a,{href:"https://dev.mysql.com/doc/refman/8.0/en/select.html",title:"15.2.13 SELECT Statement",children:(0,i.jsx)(n.code,{children:"SELECT"})}),", or ",(0,i.jsx)(n.a,{href:"https://dev.mysql.com/doc/refman/8.0/en/update.html",title:"15.2.17 UPDATE Statement",children:(0,i.jsx)(n.code,{children:"UPDATE"})})," statements."]}),"\n",(0,i.jsxs)(n.p,{children:["For the ",(0,i.jsx)(n.code,{children:"end"})," state, the following operations could be happening:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Writing an event to the binary log"}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Freeing memory buffers, including for blobs"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"executing"})}),"\n",(0,i.jsx)(n.p,{children:"The thread has begun executing a statement."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"Execution of init_command"})}),"\n",(0,i.jsxs)(n.p,{children:["The thread is executing statements in the value of the ",(0,i.jsx)(n.code,{children:"init_command"})," system variable."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"freeing items"})}),"\n",(0,i.jsxs)(n.p,{children:["The thread has executed a command. This state is usually followed by ",(0,i.jsx)(n.code,{children:"cleaning up"}),"."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"FULLTEXT initialization"})}),"\n",(0,i.jsx)(n.p,{children:"The server is preparing to perform a natural-language full-text search."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"init"})}),"\n",(0,i.jsxs)(n.p,{children:["This occurs before the initialization of ",(0,i.jsx)(n.a,{href:"https://dev.mysql.com/doc/refman/8.0/en/alter-table.html",title:"15.1.9 ALTER TABLE Statement",children:(0,i.jsx)(n.code,{children:"ALTER TABLE"})}),", ",(0,i.jsx)(n.a,{href:"https://dev.mysql.com/doc/refman/8.0/en/delete.html",title:"15.2.2 DELETE Statement",children:(0,i.jsx)(n.code,{children:"DELETE"})}),", ",(0,i.jsx)(n.a,{href:"https://dev.mysql.com/doc/refman/8.0/en/insert.html",title:"15.2.7 INSERT Statement",children:(0,i.jsx)(n.code,{children:"INSERT"})}),", ",(0,i.jsx)(n.a,{href:"https://dev.mysql.com/doc/refman/8.0/en/select.html",title:"15.2.13 SELECT Statement",children:(0,i.jsx)(n.code,{children:"SELECT"})}),", or ",(0,i.jsx)(n.a,{href:"https://dev.mysql.com/doc/refman/8.0/en/update.html",title:"15.2.17 UPDATE Statement",children:(0,i.jsx)(n.code,{children:"UPDATE"})})," statements. Actions taken by the server in this state include flushing the binary log and the ",(0,i.jsx)(n.code,{children:"InnoDB"})," log."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"Killed"})}),"\n",(0,i.jsxs)(n.p,{children:["Someone has sent a ",(0,i.jsx)(n.a,{href:"https://dev.mysql.com/doc/refman/8.0/en/kill.html",title:"15.7.8.4 KILL Statement",children:(0,i.jsx)(n.code,{children:"KILL"})})," statement to the thread and it should abort next time it checks the kill flag. The flag is checked in each major loop in MySQL, but in some cases it might still take a short time for the thread to die. If the thread is locked by some other thread, the kill takes effect as soon as the other thread releases its lock."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"Locking system tables"})}),"\n",(0,i.jsx)(n.p,{children:"The thread is trying to lock a system table (for example, a time zone or log table)."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"logging slow query"})}),"\n",(0,i.jsx)(n.p,{children:"The thread is writing a statement to the slow-query log."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"login"})}),"\n",(0,i.jsx)(n.p,{children:"The initial state for a connection thread until the client has been authenticated successfully."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"manage keys"})}),"\n",(0,i.jsx)(n.p,{children:"The server is enabling or disabling a table index."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"Opening system tables"})}),"\n",(0,i.jsx)(n.p,{children:"The thread is trying to open a system table (for example, a time zone or log table)."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"Opening tables"})}),"\n",(0,i.jsxs)(n.p,{children:["The thread is trying to open a table. This is should be very fast procedure, unless something prevents opening. For example, an ",(0,i.jsx)(n.a,{href:"https://dev.mysql.com/doc/refman/8.0/en/alter-table.html",title:"15.1.9 ALTER TABLE Statement",children:(0,i.jsx)(n.code,{children:"ALTER TABLE"})})," or a ",(0,i.jsx)(n.a,{href:"https://dev.mysql.com/doc/refman/8.0/en/lock-tables.html",title:"15.3.6 LOCK TABLES and UNLOCK TABLES Statements",children:(0,i.jsx)(n.code,{children:"LOCK TABLE"})})," statement can prevent opening a table until the statement is finished. It is also worth checking that your ",(0,i.jsx)(n.a,{href:"https://dev.mysql.com/doc/refman/8.0/en/server-system-variables.html#sysvar_table_open_cache",children:(0,i.jsx)(n.code,{children:"table_open_cache"})})," value is large enough."]}),"\n",(0,i.jsxs)(n.p,{children:["For system tables, the ",(0,i.jsx)(n.code,{children:"Opening system tables"})," state is used instead."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"optimizing"})}),"\n",(0,i.jsx)(n.p,{children:"The server is performing initial optimizations for a query."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"preparing"})}),"\n",(0,i.jsx)(n.p,{children:"This state occurs during query optimization."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"preparing for alter table"})}),"\n",(0,i.jsxs)(n.p,{children:["The server is preparing to execute an in-place ",(0,i.jsx)(n.a,{href:"https://dev.mysql.com/doc/refman/8.0/en/alter-table.html",title:"15.1.9 ALTER TABLE Statement",children:(0,i.jsx)(n.code,{children:"ALTER TABLE"})}),"."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"Purging old relay logs"})}),"\n",(0,i.jsx)(n.p,{children:"The thread is removing unneeded relay log files."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"query end"})}),"\n",(0,i.jsxs)(n.p,{children:["This state occurs after processing a query but before the ",(0,i.jsx)(n.code,{children:"freeing items"})," state."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"Receiving from client"})}),"\n",(0,i.jsx)(n.p,{children:"The server is reading a packet from the client."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"Removing duplicates"})}),"\n",(0,i.jsxs)(n.p,{children:["The query was using ",(0,i.jsx)(n.a,{href:"https://dev.mysql.com/doc/refman/8.0/en/select.html",title:"15.2.13 SELECT Statement",children:(0,i.jsx)(n.code,{children:"SELECT DISTINCT"})})," in such a way that MySQL could not optimize away the distinct operation at an early stage. Because of this, MySQL requires an extra stage to remove all duplicated rows before sending the result to the client."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"removing tmp table"})}),"\n",(0,i.jsxs)(n.p,{children:["The thread is removing an internal temporary table after processing a ",(0,i.jsx)(n.a,{href:"https://dev.mysql.com/doc/refman/8.0/en/select.html",title:"15.2.13 SELECT Statement",children:(0,i.jsx)(n.code,{children:"SELECT"})})," statement. This state is not used if no temporary table was created."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"rename"})}),"\n",(0,i.jsx)(n.p,{children:"The thread is renaming a table."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"rename result table"})}),"\n",(0,i.jsxs)(n.p,{children:["The thread is processing an ",(0,i.jsx)(n.a,{href:"https://dev.mysql.com/doc/refman/8.0/en/alter-table.html",title:"15.1.9 ALTER TABLE Statement",children:(0,i.jsx)(n.code,{children:"ALTER TABLE"})})," statement, has created the new table, and is renaming it to replace the original table."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"Reopen tables"})}),"\n",(0,i.jsx)(n.p,{children:"The thread got a lock for the table, but noticed after getting the lock that the underlying table structure changed. It has freed the lock, closed the table, and is trying to reopen it."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"Repair by sorting"})}),"\n",(0,i.jsx)(n.p,{children:"The repair code is using a sort to create indexes."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"Repair done"})}),"\n",(0,i.jsxs)(n.p,{children:["The thread has completed a multithreaded repair for a ",(0,i.jsx)(n.code,{children:"MyISAM"})," table."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"Repair with keycache"})}),"\n",(0,i.jsxs)(n.p,{children:["The repair code is using creating keys one by one through the key cache. This is much slower than ",(0,i.jsx)(n.code,{children:"Repair by sorting"}),"."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"Rolling back"})}),"\n",(0,i.jsx)(n.p,{children:"The thread is rolling back a transaction."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"Saving state"})}),"\n",(0,i.jsxs)(n.p,{children:["For ",(0,i.jsx)(n.code,{children:"MyISAM"})," table operations such as repair or analysis, the thread is saving the new table state to the ",(0,i.jsx)(n.code,{children:".MYI"})," file header. State includes information such as number of rows, the ",(0,i.jsx)(n.code,{children:"AUTO_INCREMENT"})," counter, and key distributions."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"Searching rows for update"})}),"\n",(0,i.jsxs)(n.p,{children:["The thread is doing a first phase to find all matching rows before updating them. This has to be done if the ",(0,i.jsx)(n.a,{href:"https://dev.mysql.com/doc/refman/8.0/en/update.html",title:"15.2.17 UPDATE Statement",children:(0,i.jsx)(n.code,{children:"UPDATE"})})," is changing the index that is used to find the involved rows."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"Sending data"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.em,{children:"Prior to MySQL 8.0.17"}),": The thread is reading and processing rows for a ",(0,i.jsx)(n.a,{href:"https://dev.mysql.com/doc/refman/8.0/en/select.html",title:"15.2.13 SELECT Statement",children:(0,i.jsx)(n.code,{children:"SELECT"})})," statement, and sending data to the client. Because operations occurring during this state tend to perform large amounts of disk access (reads), it is often the longest-running state over the lifetime of a given query. ",(0,i.jsx)(n.em,{children:"MySQL 8.0.17 and later"}),": This state is no longer indicated separately, but rather is included in the ",(0,i.jsx)(n.code,{children:"Executing"})," state."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"Sending to client"})}),"\n",(0,i.jsx)(n.p,{children:"The server is writing a packet to the client."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"setup"})}),"\n",(0,i.jsxs)(n.p,{children:["The thread is beginning an ",(0,i.jsx)(n.a,{href:"https://dev.mysql.com/doc/refman/8.0/en/alter-table.html",title:"15.1.9 ALTER TABLEauro Statement",children:(0,i.jsx)(n.code,{children:"ALTER TABLE"})})," operation."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"Sorting for group"})}),"\n",(0,i.jsxs)(n.p,{children:["The thread is doing a sort to satisfy a ",(0,i.jsx)(n.code,{children:"GROUP BY"}),"."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"Sorting for order"})}),"\n",(0,i.jsxs)(n.p,{children:["The thread is doing a sort to satisfy an ",(0,i.jsx)(n.code,{children:"ORDER BY"}),"."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"Sorting index"})}),"\n",(0,i.jsxs)(n.p,{children:["The thread is sorting index pages for more efficient access during a ",(0,i.jsx)(n.code,{children:"MyISAM"})," table optimization operation."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"Sorting result"})}),"\n",(0,i.jsxs)(n.p,{children:["For a ",(0,i.jsx)(n.a,{href:"https://dev.mysql.com/doc/refman/8.0/en/select.html",title:"15.2.13 SELECT Statement",children:(0,i.jsx)(n.code,{children:"SELECT"})})," statement, this is similar to ",(0,i.jsx)(n.code,{children:"Creating sort index"}),", but for nontemporary tables."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"starting"})}),"\n",(0,i.jsx)(n.p,{children:"The first stage at the beginning of statement execution."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"statistics"})}),"\n",(0,i.jsx)(n.p,{children:"The server is calculating statistics to develop a query execution plan. If a thread is in this state for a long time, the server is probably disk-bound performing other work."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"System lock"})}),"\n",(0,i.jsxs)(n.p,{children:["The thread has called ",(0,i.jsx)(n.code,{children:"mysql_lock_tables()"})," and the thread state has not been updated since. This is a very general state that can occur for many reasons."]}),"\n",(0,i.jsxs)(n.p,{children:["For example, the thread is going to request or is waiting for an internal or external system lock for the table. This can occur when ",(0,i.jsx)(n.a,{href:"https://dev.mysql.com/doc/refman/8.0/en/innodb-storage-engine.html",title:"Chapter 17 The InnoDB Storage Engine",children:(0,i.jsx)(n.code,{children:"InnoDB"})})," waits for a table-level lock during execution of ",(0,i.jsx)(n.a,{href:"https://dev.mysql.com/doc/refman/8.0/en/lock-tables.html",title:"15.3.6 LOCK TABLES and UNLOCK TABLES Statements",children:(0,i.jsx)(n.code,{children:"LOCK TABLES"})}),". If this state is being caused by requests for external locks and you are not using multiple ",(0,i.jsx)(n.a,{href:"https://dev.mysql.com/doc/refman/8.0/en/mysqld.html",title:"6.3.1 mysqld \u2014 The MySQL Server",children:(0,i.jsx)(n.strong,{children:"mysqld"})})," servers that are accessing the same ",(0,i.jsx)(n.a,{href:"https://dev.mysql.com/doc/refman/8.0/en/myisam-storage-engine.html",title:"18.2 The MyISAM Storage Engine",children:(0,i.jsx)(n.code,{children:"MyISAM"})})," tables, you can disable external system locks with the ",(0,i.jsx)(n.a,{href:"https://dev.mysql.com/doc/refman/8.0/en/server-options.html#option_mysqld_external-locking",children:(0,i.jsx)(n.code,{children:"--skip-external-locking"})})," option. However, external locking is disabled by default, so it is likely that this option has no effect. For ",(0,i.jsx)(n.a,{href:"https://dev.mysql.com/doc/refman/8.0/en/show-profile.html",title:"15.7.7.30 SHOW PROFILE Statement",children:(0,i.jsx)(n.code,{children:"SHOW PROFILE"})}),", this state means the thread is requesting the lock (not waiting for it)."]}),"\n",(0,i.jsxs)(n.p,{children:["For system tables, the ",(0,i.jsx)(n.code,{children:"Locking system tables"})," state is used instead."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"update"})}),"\n",(0,i.jsx)(n.p,{children:"The thread is getting ready to start updating the table."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"Updating"})}),"\n",(0,i.jsx)(n.p,{children:"The thread is searching for rows to update and is updating them."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"updating main table"})}),"\n",(0,i.jsx)(n.p,{children:"The server is executing the first part of a multiple-table update. It is updating only the first table, and saving columns and offsets to be used for updating the other (reference) tables."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"updating reference tables"})}),"\n",(0,i.jsx)(n.p,{children:"The server is executing the second part of a multiple-table update and updating the matched rows from the other tables."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"User lock"})}),"\n",(0,i.jsxs)(n.p,{children:["The thread is going to request or is waiting for an advisory lock requested with a ",(0,i.jsx)(n.a,{href:"https://dev.mysql.com/doc/refman/8.0/en/locking-functions.html#function_get-lock",children:(0,i.jsx)(n.code,{children:"GET_LOCK()"})})," call. For ",(0,i.jsx)(n.a,{href:"https://dev.mysql.com/doc/refman/8.0/en/show-profile.html",title:"15.7.7.30 SHOW PROFILE Statement",children:(0,i.jsx)(n.code,{children:"SHOW PROFILE"})}),", this state means the thread is requesting the lock (not waiting for it)."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"User sleep"})}),"\n",(0,i.jsxs)(n.p,{children:["The thread has invoked a ",(0,i.jsx)(n.a,{href:"https://dev.mysql.com/doc/refman/8.0/en/miscellaneous-functions.html#function_sleep",children:(0,i.jsx)(n.code,{children:"SLEEP()"})})," call."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"Waiting for commit lock"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.a,{href:"https://dev.mysql.com/doc/refman/8.0/en/flush.html#flush-tables-with-read-lock",children:(0,i.jsx)(n.code,{children:"FLUSH TABLES WITH READ LOCK"})})," is waiting for a commit lock."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"waiting for handler commit"})}),"\n",(0,i.jsx)(n.p,{children:"The thread is waiting for a transaction to commit versus other parts of query processing."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"Waiting for tables"})}),"\n",(0,i.jsx)(n.p,{children:"The thread got a notification that the underlying structure for a table has changed and it needs to reopen the table to get the new structure. However, to reopen the table, it must wait until all other threads have closed the table in question."}),"\n",(0,i.jsxs)(n.p,{children:["This notification takes place if another thread has used ",(0,i.jsx)(n.a,{href:"https://dev.mysql.com/doc/refman/8.0/en/flush.html#flush-tables",children:(0,i.jsx)(n.code,{children:"FLUSH TABLES"})})," or one of the following statements on the table in question: ",(0,i.jsx)(n.code,{children:"FLUSH TABLES _`tbl_name`_"}),", ",(0,i.jsx)(n.a,{href:"https://dev.mysql.com/doc/refman/8.0/en/alter-table.html",title:"15.1.9 ALTER TABLE Statement",children:(0,i.jsx)(n.code,{children:"ALTER TABLE"})}),", ",(0,i.jsx)(n.a,{href:"https://dev.mysql.com/doc/refman/8.0/en/rename-table.html",title:"15.1.36 RENAME TABLE Statement",children:(0,i.jsx)(n.code,{children:"RENAME TABLE"})}),", ",(0,i.jsx)(n.a,{href:"https://dev.mysql.com/doc/refman/8.0/en/repair-table.html",title:"15.7.3.5 REPAIR TABLE Statement",children:(0,i.jsx)(n.code,{children:"REPAIR TABLE"})}),", ",(0,i.jsx)(n.a,{href:"https://dev.mysql.com/doc/refman/8.0/en/analyze-table.html",title:"15.7.3.1 ANALYZE TABLE Statement",children:(0,i.jsx)(n.code,{children:"ANALYZE TABLE"})}),", or ",(0,i.jsx)(n.a,{href:"https://dev.mysql.com/doc/refman/8.0/en/optimize-table.html",title:"15.7.3.4 OPTIMIZE TABLE Statement",children:(0,i.jsx)(n.code,{children:"OPTIMIZE TABLE"})}),"."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"Waiting for table flush"})}),"\n",(0,i.jsxs)(n.p,{children:["The thread is executing ",(0,i.jsx)(n.a,{href:"https://dev.mysql.com/doc/refman/8.0/en/flush.html#flush-tables",children:(0,i.jsx)(n.code,{children:"FLUSH TABLES"})})," and is waiting for all threads to close their tables, or the thread got a notification that the underlying structure for a table has changed and it needs to reopen the table to get the new structure. However, to reopen the table, it must wait until all other threads have closed the table in question."]}),"\n",(0,i.jsxs)(n.p,{children:["This notification takes place if another thread has used ",(0,i.jsx)(n.a,{href:"https://dev.mysql.com/doc/refman/8.0/en/flush.html#flush-tables",children:(0,i.jsx)(n.code,{children:"FLUSH TABLES"})})," or one of the following statements on the table in question: ",(0,i.jsx)(n.code,{children:"FLUSH TABLES _`tbl_name`_"}),", ",(0,i.jsx)(n.a,{href:"https://dev.mysql.com/doc/refman/8.0/en/alter-table.html",title:"15.1.9 ALTER TABLE Statement",children:(0,i.jsx)(n.code,{children:"ALTER TABLE"})}),", ",(0,i.jsx)(n.a,{href:"https://dev.mysql.com/doc/refman/8.0/en/rename-table.html",title:"15.1.36 RENAME TABLE Statement",children:(0,i.jsx)(n.code,{children:"RENAME TABLE"})}),", ",(0,i.jsx)(n.a,{href:"https://dev.mysql.com/doc/refman/8.0/en/repair-table.html",title:"15.7.3.5 REPAIR TABLE Statement",children:(0,i.jsx)(n.code,{children:"REPAIR TABLE"})}),", ",(0,i.jsx)(n.a,{href:"https://dev.mysql.com/doc/refman/8.0/en/analyze-table.html",title:"15.7.3.1 ANALYZE TABLE Statement",children:(0,i.jsx)(n.code,{children:"ANALYZE TABLE"})}),", or ",(0,i.jsx)(n.a,{href:"https://dev.mysql.com/doc/refman/8.0/en/optimize-table.html",title:"15.7.3.4 OPTIMIZE TABLE Statement",children:(0,i.jsx)(n.code,{children:"OPTIMIZE TABLE"})}),"."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"Waiting for _`lock_type`_ lock"})}),"\n",(0,i.jsxs)(n.p,{children:["The server is waiting to acquire a ",(0,i.jsx)(n.code,{children:"THR_LOCK"})," lock or a lock from the metadata locking subsystem, where ",(0,i.jsx)(n.em,{children:(0,i.jsx)(n.code,{children:"lock_type"})})," indicates the type of lock."]}),"\n",(0,i.jsxs)(n.p,{children:["This state indicates a wait for a ",(0,i.jsx)(n.code,{children:"THR_LOCK"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"Waiting for table level lock"})}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"These states indicate a wait for a metadata lock:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"Waiting for event metadata lock"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"Waiting for global read lock"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"Waiting for schema metadata lock"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"Waiting for stored function metadata lock"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"Waiting for stored procedure metadata lock"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"Waiting for table metadata lock"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"Waiting for trigger metadata lock"})}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"Waiting on cond"})}),"\n",(0,i.jsx)(n.p,{children:"A generic state in which the thread is waiting for a condition to become true. No specific state information is available."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"Writing to net"})}),"\n",(0,i.jsx)(n.p,{children:"The server is writing a packet to the network."}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.a,{href:"https://dev.mysql.com/doc/refman/8.0/en/general-thread-states.html",children:"10.14.3 General Thread States"})})]})}function o(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}},28453:(e,n,t)=>{t.d(n,{R:()=>l,x:()=>a});var s=t(296540);const i={},r=s.createContext(i);function l(e){const n=s.useContext(r);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),s.createElement(r.Provider,{value:n},e.children)}}}]);