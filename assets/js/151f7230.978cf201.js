"use strict";(self.webpackChunkdeep_notes=self.webpackChunkdeep_notes||[]).push([[76122],{86904:(e,s,t)=>{t.r(s),t.d(s,{assets:()=>c,contentTitle:()=>a,default:()=>d,frontMatter:()=>o,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"devops/monitoring/prometheus/intro","title":"Prometheus","description":"A CNCF (Cloud Native Computing Foundation) project, is a systems and service monitoring system. It collects metrics from configured targets at given intervals, evaluates rule expressions, displays the results, and can trigger alerts if some condition is observed to be true.","source":"@site/docs/devops/monitoring/prometheus/intro.md","sourceDirName":"devops/monitoring/prometheus","slug":"/devops/monitoring/prometheus/intro","permalink":"/devops/monitoring/prometheus/intro","draft":false,"unlisted":false,"editUrl":"https://github.com/deepaksood619/deepaksood619.github.io/tree/master/docs/devops/monitoring/prometheus/intro.md","tags":[],"version":"current","lastUpdatedBy":"Deepak","lastUpdatedAt":1752691234000,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Alert Manager","permalink":"/devops/monitoring/prometheus/alert-manager"},"next":{"title":"Prometheus Architecture","permalink":"/devops/monitoring/prometheus/prometheus-architecture"}}');var n=t(474848),i=t(28453);const o={},a="Prometheus",c={},l=[{value:"Features",id:"features",level:2},{value:"Components",id:"components",level:2},{value:"Architecture Overview",id:"architecture-overview",level:2},{value:"Concepts",id:"concepts",level:2},{value:"Dashboards",id:"dashboards",level:2},{value:"Metrics",id:"metrics",level:2},{value:"Scraping config",id:"scraping-config",level:2},{value:"Tools",id:"tools",level:2},{value:"Deployment",id:"deployment",level:2},{value:"References",id:"references",level:2}];function h(e){const s={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.header,{children:(0,n.jsx)(s.h1,{id:"prometheus",children:"Prometheus"})}),"\n",(0,n.jsx)(s.p,{children:"A CNCF (Cloud Native Computing Foundation) project, is a systems and service monitoring system. It collects metrics from configured targets at given intervals, evaluates rule expressions, displays the results, and can trigger alerts if some condition is observed to be true."}),"\n",(0,n.jsx)(s.h2,{id:"features",children:"Features"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:"amulti-dimensionaldata model (timeseries defined by metric name and set of key/value dimensions)"}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.strong,{children:"PromQL"}),", aflexible query languageto leverage this dimensionality"]}),"\n",(0,n.jsx)(s.li,{children:"no dependency on distributed storage;single server nodes are autonomous"}),"\n",(0,n.jsx)(s.li,{children:"timeseries collection happens via apull modelover HTTP"}),"\n",(0,n.jsx)(s.li,{children:"pushing timeseriesis supported via an intermediary gateway"}),"\n",(0,n.jsx)(s.li,{children:"targets are discovered viaservice discoveryorstatic configuration"}),"\n",(0,n.jsx)(s.li,{children:"multiple modes ofgraphing and dashboarding support"}),"\n",(0,n.jsx)(s.li,{children:"support for hierarchical and horizontalfederation"}),"\n"]}),"\n",(0,n.jsx)(s.h2,{id:"components",children:"Components"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:["the main ",(0,n.jsx)(s.a,{href:"https://github.com/prometheus/prometheus",children:"Prometheus server"})," which scrapes and stores time series data"]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.a,{href:"https://prometheus.io/docs/instrumenting/clientlibs/",children:"client libraries"})," for instrumenting application code"]}),"\n",(0,n.jsxs)(s.li,{children:["a ",(0,n.jsx)(s.a,{href:"https://github.com/prometheus/pushgateway",children:"push gateway"})," for supporting short-lived jobs"]}),"\n",(0,n.jsxs)(s.li,{children:["special-purpose ",(0,n.jsx)(s.a,{href:"https://prometheus.io/docs/instrumenting/exporters/",children:"exporters"})," for services like HAProxy, StatsD, Graphite, etc."]}),"\n",(0,n.jsxs)(s.li,{children:["an ",(0,n.jsx)(s.a,{href:"https://github.com/prometheus/alertmanager",children:"alertmanager"})," to handle alerts"]}),"\n",(0,n.jsx)(s.li,{children:"various support tools"}),"\n"]}),"\n",(0,n.jsx)(s.h2,{id:"architecture-overview",children:"Architecture Overview"}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.img,{alt:"image",src:t(171879).A+"",width:"999",height:"683"})}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.img,{alt:"image",src:t(909304).A+"",width:"998",height:"488"})}),"\n",(0,n.jsx)(s.h2,{id:"concepts",children:"Concepts"}),"\n",(0,n.jsxs)(s.ol,{children:["\n",(0,n.jsx)(s.li,{children:"Data model"}),"\n",(0,n.jsx)(s.li,{children:"Metric types"}),"\n",(0,n.jsx)(s.li,{children:"Jobs and instances"}),"\n"]}),"\n",(0,n.jsx)(s.h2,{id:"dashboards",children:"Dashboards"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.a,{href:"http://localhost:9090/metrics",children:"http://localhost:9090/metrics"})," # for seeing all metrics that are currently scraped"]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.a,{href:"http://localhost:9090/graph",children:"http://localhost:9090/graph"})," # for visualizing graphs for the metrics"]}),"\n",(0,n.jsx)(s.li,{children:(0,n.jsx)(s.a,{href:"https://grafana.com/docs/grafana-cloud/monitor-infrastructure/kubernetes-monitoring/intro-kubernetes-monitoring/",children:"Introduction to Kubernetes Monitoring | Grafana Cloud documentation"})}),"\n"]}),"\n",(0,n.jsx)(s.h2,{id:"metrics",children:"Metrics"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsx)(s.p,{children:"Node metrics (related to physical or virtual machines)"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:"CPU, RAM, disk usage on the whole node"}),"\n",(0,n.jsx)(s.li,{children:"Total number of processes running, and their states"}),"\n",(0,n.jsx)(s.li,{children:"Number of open files, sockets, and their states"}),"\n",(0,n.jsx)(s.li,{children:"I/O activity (disk, network), per operation or volume"}),"\n",(0,n.jsx)(s.li,{children:"Physical/hardware (when applicable): temperature, fan speed ..."}),"\n"]}),"\n"]}),"\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsx)(s.p,{children:"Container metrics (resource usage per container)"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:"Similar to node metrics, but not totally identical"}),"\n",(0,n.jsxs)(s.li,{children:["RAM breakdown will be different","\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:"active vs inactive memory"}),"\n",(0,n.jsx)(s.li,{children:"some memory issharedbetween containers, and accounted specially"}),"\n"]}),"\n"]}),"\n",(0,n.jsxs)(s.li,{children:["I/O activity is also harder to track","\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:'async writes can cause deferred "charges"'}),"\n",(0,n.jsx)(s.li,{children:"some page-ins are also shared between containers"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.a,{href:"http://jpetazzo.github.io/2013/10/08/docker-containers-metrics",children:"http://jpetazzo.github.io/2013/10/08/docker-containers-metrics"})}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsx)(s.p,{children:"Application Metrics"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:"Arbitrary metrics related to your application and business"}),"\n",(0,n.jsx)(s.li,{children:"System performance: request latency, error rate ..."}),"\n",(0,n.jsx)(s.li,{children:"Volume information: number of rows in database, message queue size ..."}),"\n",(0,n.jsx)(s.li,{children:"Business data: inventory, items sold, revenue ..."}),"\n"]}),"\n"]}),"\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsx)(s.p,{children:"Databases, message queues, load balancers, ..."}),"\n"]}),"\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsx)(s.p,{children:"Instrumentation (=deluxeprintffor our code)"}),"\n"]}),"\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsx)(s.p,{children:"Business metrics (customers served, revenue, ...)"}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(s.h2,{id:"scraping-config",children:"Scraping config"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-bash",children:"additionalScrapeConfigs:\n\n- job_name: 'kubernetes-pods'\nkubernetes_sd_configs:\n- role: pod\nrelabel_configs:\n- source_labels: [__meta_kubernetes_pod_annotation_prometheus_io_scrape]\naction: keep\nregex: true\n- source_labels: [__meta_kubernetes_pod_annotation_prometheus_io_path]\naction: replace\ntarget_label: **metrics_path**\nregex: (.+)\n- source_labels: [**address**, __meta_kubernetes_pod_annotation_prometheus_io_port]\naction: replace\nregex: ([^:]+)(?::d+)?;(d+)\nreplacement: $1:$2\ntarget_label: **address**\n- action: labelmap\nregex: __meta_kubernetes_pod_label_(.+)\n- source_labels: [__meta_kubernetes_namespace]\naction: replace\ntarget_label: kubernetes_namespace\n- source_labels: [__meta_kubernetes_pod_name]\naction: replace\ntarget_label: kubernetes_pod_name\n"})}),"\n",(0,n.jsx)(s.h2,{id:"tools",children:"Tools"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:"M3DB"}),"\n"]}),"\n",(0,n.jsx)(s.p,{children:"Distributed TSDB, Aggregator and Query Engine, Prometheus Sidecar, Metrics Platform"}),"\n",(0,n.jsx)(s.p,{children:"The fully open source metrics platform built on M3DB, a distributed timeseries database"}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.a,{href:"https://github.com/m3db/m3",children:"https://github.com/m3db/m3"})}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.a,{href:"https://m3db.io",children:"https://m3db.io"})}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:"PushGateway"}),"\n"]}),"\n",(0,n.jsx)(s.p,{children:"The Prometheus Pushgateway exists to allow ephemeral and batch jobs to expose their metrics to Prometheus. Since these kinds of jobs may not exist long enough to be scraped, they can instead push their metrics to a Pushgateway. The Pushgateway then exposes these metrics to Prometheus."}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.a,{href:"https://github.com/prometheus/pushgateway",children:"https://github.com/prometheus/pushgateway"})}),"\n",(0,n.jsx)(s.h2,{id:"deployment",children:"Deployment"}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.a,{href:"https://github.com/prometheus-community/helm-charts/tree/main/charts/kube-prometheus-stack",children:"helm-charts/charts/kube-prometheus-stack at main \xb7 prometheus-community/helm-charts \xb7 GitHub"})}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:(0,n.jsx)(s.a,{href:"https://medium.com/israeli-tech-radar/how-to-create-a-monitoring-stack-using-kube-prometheus-stack-part-1-eff8bf7ba9a9",children:"How to create a Monitoring Stack using Kube-Prometheus-stack (Part 1) | by Matan Amiel | Israeli Tech Radar | Medium"})}),"\n"]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-bash",children:"helm repo add prometheus-community https://prometheus-community.github.io/helm-charts\nhelm repo update\n\nhelm show values prometheus-community/kube-prometheus-stack\n\nhelm install -f values.yaml straw prometheus-community/kube-prometheus-stack -n promstack\n\n# otherwise\nhelm install straw prometheus-community/kube-prometheus-stack -n promstack\n\nkubectl --namespace promstack get pods -l \"release=straw\"\n\nhelm upgrade -f values.yaml straw prometheus-community/kube-prometheus-stack -n promstack\n\nkubectl port-forward svc/straw-grafana 3000:80 -n promstack --address='0.0.0.0'\nkubectl port-forward service/straw-kube-prometheus-stac-alertmanager 3000:8080 -n promstack --address='0.0.0.0'\n\nusername - admin\ndefault - prom-operator\n\nkubectl get secret grafana -o jsonpath=\"{.data.admin-password}\" | base64 --decode ; echo\n\nhelm uninstall straw\n"})}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.a,{href:"https://github.com/prometheus-operator/prometheus-operator",children:"GitHub - prometheus-operator/prometheus-operator: Prometheus Operator creates/configures/manages Prometheus clusters atop Kubernetes"})}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:(0,n.jsx)(s.a,{href:"https://prometheus-operator.dev/docs/prologue/quick-start/",children:"Quick Start - Prometheus Operator"})}),"\n"]}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.a,{href:"https://stackoverflow.com/questions/54422566/what-is-the-difference-between-the-core-os-projects-kube-prometheus-and-promethe",children:"kubernetes - What is the difference between the core os projects kube-prometheus and prometheus operator? - Stack Overflow"})}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.a,{href:"https://www.datadoghq.com/blog/monitoring-kubernetes-era/",children:"Monitoring in the Kubernetes Era | Datadog"})}),"\n",(0,n.jsx)(s.h2,{id:"references",children:"References"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:(0,n.jsx)(s.a,{href:"https://github.com/prometheus/prometheus",children:"https://github.com/prometheus/prometheus"})}),"\n",(0,n.jsx)(s.li,{children:(0,n.jsx)(s.a,{href:"https://prometheus.io",children:"https://prometheus.io"})}),"\n",(0,n.jsx)(s.li,{children:(0,n.jsx)(s.a,{href:"https://prometheus.io/docs/introduction/overview",children:"https://prometheus.io/docs/introduction/overview"})}),"\n",(0,n.jsxs)(s.li,{children:["TSDB - ",(0,n.jsx)(s.a,{href:"https://fabxc.org/tsdb",children:"https://fabxc.org/tsdb"})]}),"\n",(0,n.jsxs)(s.li,{children:["On Kubernetes - ",(0,n.jsx)(s.a,{href:"https://github.com/coreos/prometheus-operator/tree/master/contrib/kube-prometheus",children:"https://github.com/coreos/prometheus-operator/tree/master/contrib/kube-prometheus"})]}),"\n",(0,n.jsx)(s.li,{children:(0,n.jsx)(s.a,{href:"https://github.com/prometheus-community/helm-charts/tree/main/charts/kube-prometheus-stack",children:"https://github.com/prometheus-community/helm-charts/tree/main/charts/kube-prometheus-stack"})}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.a,{href:"https://victoriametrics.com/",children:"VictoriaMetrics: Simple & Reliable Monitoring for Everyone"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:(0,n.jsx)(s.a,{href:"https://github.com/VictoriaMetrics/VictoriaMetrics",children:"GitHub - VictoriaMetrics/VictoriaMetrics: VictoriaMetrics: fast, cost-effective monitoring solution and time series database"})}),"\n"]}),"\n"]}),"\n"]})]})}function d(e={}){const{wrapper:s}={...(0,i.R)(),...e.components};return s?(0,n.jsx)(s,{...e,children:(0,n.jsx)(h,{...e})}):h(e)}},171879:(e,s,t)=>{t.d(s,{A:()=>r});const r=t.p+"assets/images/DevOps-Monitoring-Prometheus-image1-39bea4a41602da1d021ade67a924d806.jpg"},909304:(e,s,t)=>{t.d(s,{A:()=>r});const r=t.p+"assets/images/DevOps-Monitoring-Prometheus-image2-878eac640e305b13c827417ff7e8be15.jpg"},28453:(e,s,t)=>{t.d(s,{R:()=>o,x:()=>a});var r=t(296540);const n={},i=r.createContext(n);function o(e){const s=r.useContext(i);return r.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function a(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:o(e.components),r.createElement(i.Provider,{value:s},e.children)}}}]);