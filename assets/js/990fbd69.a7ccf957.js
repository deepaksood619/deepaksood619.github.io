"use strict";(self.webpackChunkdeep_notes=self.webpackChunkdeep_notes||[]).push([[61234],{490039:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>i,contentTitle:()=>s,default:()=>f,frontMatter:()=>a,metadata:()=>o,toc:()=>c});const o=JSON.parse('{"id":"technologies/confluent/confluent-for-kubernetes-cfk","title":"Confluent for Kubernetes (CFK)","description":"Confluent for Kubernetes (CFK) is a cloud-native management control plane for deploying and managing Confluent in your Kubernetes private cloud environment. It provides a standard and simple interface to customize, deploy, and manage Confluent Platform through declarative API.","source":"@site/docs/technologies/confluent/confluent-for-kubernetes-cfk.md","sourceDirName":"technologies/confluent","slug":"/technologies/confluent/confluent-for-kubernetes-cfk","permalink":"/technologies/confluent/confluent-for-kubernetes-cfk","draft":false,"unlisted":false,"editUrl":"https://github.com/deepaksood619/deepaksood619.github.io/tree/master/docs/technologies/confluent/confluent-for-kubernetes-cfk.md","tags":[],"version":"current","lastUpdatedBy":"Deeapak Sood","lastUpdatedAt":1768059655000,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Confluent Cluster types","permalink":"/technologies/confluent/confluent-cluster-types"},"next":{"title":"Confluent Intelligence","permalink":"/technologies/confluent/confluent-intelligence"}}');var l=t(474848),r=t(28453);const a={},s="Confluent for Kubernetes (CFK)",i={},c=[{value:"Features",id:"features",level:2},{value:"Quickstart",id:"quickstart",level:2},{value:"Bonus: Install and use Confluent kubectl plugin",id:"bonus-install-and-use-confluent-kubectl-plugin",level:3},{value:"Flink",id:"flink",level:2},{value:"Deploy Flink Jobs",id:"deploy-flink-jobs",level:3},{value:"Links",id:"links",level:2}];function u(e){const n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.header,{children:(0,l.jsx)(n.h1,{id:"confluent-for-kubernetes-cfk",children:"Confluent for Kubernetes (CFK)"})}),"\n",(0,l.jsx)(n.p,{children:"Confluent for Kubernetes (CFK) is a cloud-native management control plane for deploying and managing Confluent in your Kubernetes private cloud environment. It provides a standard and simple interface to customize, deploy, and manage Confluent Platform through declarative API."}),"\n",(0,l.jsx)(n.p,{children:"CFK is a Kubernetes Deployment whose lifecycle is managed by Helm, but all the various Confluent components have their custom resource definitions (CRDs) that can be managed just like any other Kubernetes resource."}),"\n",(0,l.jsx)(n.p,{children:"CFK actively monitors the custom resources to ensure their state matches the desired state."}),"\n",(0,l.jsx)(n.p,{children:"The following shows the high-level architecture of CFK and Confluent Platform in Kubernetes. Note that CFK also supports Confluent REST Proxy that is not shown in the diagram."}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.img,{src:"https://docs.confluent.io/operator/3.1/_images/co-architecture.png",alt:"_images/co-architecture.png"})}),"\n",(0,l.jsx)(n.h2,{id:"features",children:"Features"}),"\n",(0,l.jsx)(n.p,{children:"The following are summaries of the main, notable features of CFK."}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Cloud Native Declarative API"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Declarative Kubernetes-native API approach to configure, deploy, and manage Confluent Platform components (namely Apache Kafka\xae, Connect workers, ksqlDB, Schema Registry, Confluent Control Center, Confluent REST Proxy) and application resources (such as topics, rolebindings) through Infrastructure as Code (IaC)."}),"\n",(0,l.jsxs)(n.li,{children:["Provides built-in automation for cloud-native security best practices:","\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Complete granular RBAC, authentication and TLS network encryption"}),"\n",(0,l.jsx)(n.li,{children:"Auto-generated certificates"}),"\n",(0,l.jsx)(n.li,{children:"Support for credential management systems, such as HashiCorp Vault, to inject sensitive configurations in memory to Confluent deployments"}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.li,{children:"Provides server properties, JVM, Log4j, and Log4j 2 configuration overrides for customization of all Confluent Platform components."}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Upgrades"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Provides automated rolling updates for configuration changes."}),"\n",(0,l.jsx)(n.li,{children:"Provides automated rolling upgrades with no impact to Kafka availability."}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Scaling"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Provides single command, automated scaling and reliability checks of Confluent Platform."}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Resiliency"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Restores a Kafka pod with the same Kafka broker ID, configuration, and persistent storage volumes if a failure occurs."}),"\n",(0,l.jsx)(n.li,{children:"Provides automated rack awareness to spread replicas of a partition across different racks (or zones), improving availability of Kafka brokers and limiting the risk of data loss."}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Scheduling"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Supports Kubernetes labels and annotations to provide useful context to DevOps teams and ecosystem tooling."}),"\n",(0,l.jsx)(n.li,{children:"Supports Kubernetes tolerations and pod/node affinity for efficient resource utilization and pod placement."}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Monitoring"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Supports metrics aggregation using JMX/Jolokia."}),"\n",(0,l.jsx)(n.li,{children:"Supports aggregated metrics export to Prometheus."}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"quickstart",children:"Quickstart"}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.a,{href:"https://docs.confluent.io/operator/current/co-quickstart.html",children:"Confluent for Kubernetes Quick Start | Confluent Documentation"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:'export TUTORIAL_HOME="https://raw.githubusercontent.com/confluentinc/confluent-kubernetes-examples/master/quickstart-deploy/kraft-quickstart"\n\nkubectl create namespace confluent\nkubectl config set-context --current --namespace confluent\n\nbrew install helm\nhelm repo add confluentinc https://packages.confluent.io/helm\nhelm repo update\n\nhelm upgrade --install confluent-operator confluentinc/confluent-for-kubernetes\n\n# Deploy the KRaft controller and the Kafka brokers:\nkubectl apply -f $TUTORIAL_HOME/confluent-platform-c3++.yaml\n\n# Install the sample producer app and topic:\nkubectl apply -f $TUTORIAL_HOME/producer-app-data.yaml\n\n# Set up port forwarding to Control Center web UI from your local machine:\nkubectl port-forward controlcenter-0 9021:9021\n# http://localhost:9021\n\n# Delete\nkubectl delete -f $TUTORIAL_HOME/producer-app-data.yaml\nkubectl delete -f $TUTORIAL_HOME/confluent-platform-c3++.yaml\nhelm uninstall confluent-operator\nkubectl delete namespace confluent\n'})}),"\n",(0,l.jsx)(n.h3,{id:"bonus-install-and-use-confluent-kubectl-plugin",children:"Bonus: Install and use Confluent kubectl plugin"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"curl -O https://packages.confluent.io/bundle/cfk/confluent-for-kubernetes-3.1.1.tar.gz\n\n# unarchive and for macos, move kubectl-confluent to /usr/local/bin\ntar -xvf kubectl-plugin/kubectl-confluent-darwin-arm64.tar.gz -C /usr/local/bin/\n\nkubectl confluent dashboard controlcenter\n\nkubectl confluent version\n"})}),"\n",(0,l.jsx)(n.h2,{id:"flink",children:"Flink"}),"\n",(0,l.jsxs)(n.p,{children:["You must install the Confluent Platform for Apache Flink Kubernetes operator\xa0",(0,l.jsx)(n.em,{children:"before"}),"\xa0you install CMF because CMF uses the operator to manage the Flink clusters."]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Confluent Manager for Apache Flink (CMF)"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:'# Install the certificate manager\nkubectl create -f https://github.com/jetstack/cert-manager/releases/download/v1.18.2/cert-manager.yaml\n\nhelm upgrade --install cp-flink-kubernetes-operator --version "~1.130.0" confluentinc/flink-kubernetes-operator\n\n# Create a CMF database encryption key into a Kubernetes secret\nopenssl rand -out cmf.key 32\nkubectl create secret generic cmf-encryption-key \\\n  --from-file=encryption-key=cmf.key \\\n  -n confluent\nhelm upgrade --install cmf --version "~2.1.0" \\\n        confluentinc/confluent-manager-for-apache-flink \\\n        --namespace confluent \\\n        --set encryption.key.kubernetesSecretName=cmf-encryption-key \\\n        --set encryption.key.kubernetesSecretProperty=encryption-key\n'})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.a,{href:"https://docs.confluent.io/platform/current/flink/installation/helm.html",children:"How to Install Confluent Manager for Apache Flink with Helm | Confluent Documentation"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.a,{href:"https://docs.confluent.io/operator/current/co-manage-flink.html",children:"Manage Confluent Platform for Apache Flink Applications Using Confluent for Kubernetes | Confluent Documentation"})}),"\n",(0,l.jsx)(n.h3,{id:"deploy-flink-jobs",children:"Deploy Flink Jobs"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"kubectl port-forward svc/cmf-service 8080:80\n\nconfluent flink environment create env1 --url http://localhost:8080 --kubernetes-namespace confluent\n\n# delete env\nconfluent flink environment delete env1 --url http://localhost:8080\n"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Create the JSON application file"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-json",metastring:'title="application.json"',children:'{\n"apiVersion": "cmf.confluent.io/v1",\n"kind": "FlinkApplication",\n"metadata": {\n   "name": "basic-example"\n},\n"spec": {\n   "flinkConfiguration": {\n      "metrics.reporter.prom.factory.class": "org.apache.flink.metrics.prometheus.PrometheusReporterFactory",\n      "metrics.reporter.prom.port": "9249-9250",\n      "taskmanager.numberOfTaskSlots": "1"\n   },\n   "flinkVersion": "v2_0",\n   "image": "confluentinc/cp-flink:2.0.0-cp1",\n   "job": {\n      "jarURI": "local:///opt/flink/examples/streaming/StateMachineExample.jar",\n      "parallelism": 3,\n      "state": "running",\n      "upgradeMode": "stateless"\n   },\n   "jobManager": {\n      "resource": {\n      "cpu": 1,\n      "memory": "1024m"\n      }\n   },\n   "serviceAccount": "flink",\n   "taskManager": {\n      "resource": {\n      "cpu": 1,\n      "memory": "1024m"\n      }\n   }\n}\n}\n'})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"confluent flink application create application.json --environment env1 --url http://localhost:8080\n\nconfluent flink application web-ui-forward basic-example --environment env1 --port 8090 --url http://localhost:8080\n\n# delete application\nconfluent flink application delete basic-example --environment env1 --url http://localhost:8080\n"})}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Example -"})," ",(0,l.jsx)(n.a,{href:"https://github.com/apache/flink/blob/master/flink-examples/flink-examples-streaming/src/main/java/org/apache/flink/streaming/examples/statemachine/StateMachineExample.java",children:"https://github.com/apache/flink/blob/master/flink-examples/flink-examples-streaming/src/main/java/org/apache/flink/streaming/examples/statemachine/StateMachineExample.java"})]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.a,{href:"https://docs.confluent.io/platform/current/flink/overview.html",children:"Confluent Platform for Apache Flink Overview | Confluent Documentation"})}),"\n",(0,l.jsx)(n.h2,{id:"links",children:"Links"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://docs.confluent.io/operator/3.1/overview.html",children:"Deploy and Manage Confluent Platform Using Confluent for Kubernetes | Confluent Documentation"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://www.youtube.com/watch?v=3UUGrBK0BIQ",children:"Demo: Confluent for Kubernetes - YouTube"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://github.com/confluentinc/confluent-kubernetes-examples",children:"GitHub - confluentinc/confluent-kubernetes-examples: Example scenario workflows for Confluent for Kubernetes"})}),"\n"]})]})}function f(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(u,{...e})}):u(e)}},28453:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>s});var o=t(296540);const l={},r=o.createContext(l);function a(e){const n=o.useContext(r);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:a(e.components),o.createElement(r.Provider,{value:n},e.children)}}}]);