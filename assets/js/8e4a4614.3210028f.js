"use strict";(self.webpackChunkdeep_notes=self.webpackChunkdeep_notes||[]).push([[96638],{963839:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>l,default:()=>h,frontMatter:()=>r,metadata:()=>s,toc:()=>o});const s=JSON.parse('{"id":"databases-nosql/aws-dynamodb/working","title":"Working","description":"DynamoDB Item Sizes","source":"@site/docs/databases-nosql/aws-dynamodb/working.md","sourceDirName":"databases-nosql/aws-dynamodb","slug":"/databases-nosql/aws-dynamodb/working","permalink":"/databases-nosql/aws-dynamodb/working","draft":false,"unlisted":false,"editUrl":"https://github.com/deepaksood619/deepaksood619.github.io/tree/master/docs/databases-nosql/aws-dynamodb/working.md","tags":[],"version":"current","lastUpdatedBy":"Deepak","lastUpdatedAt":1749576162000,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Table Classes","permalink":"/databases-nosql/aws-dynamodb/table-classes"},"next":{"title":"Cassandra","permalink":"/databases-nosql/cassandra/"}}');var t=i(474848),a=i(28453);const r={},l="Working",d={},o=[{value:"DynamoDB Item Sizes",id:"dynamodb-item-sizes",level:2},{value:"Scan vs Query",id:"scan-vs-query",level:2},{value:"Working",id:"working-1",level:2},{value:"NoSQL Data Modeling",id:"nosql-data-modeling",level:2},{value:"Common NoSQL Design Patterns",id:"common-nosql-design-patterns",level:2},{value:"Vertical Partitioning",id:"vertical-partitioning",level:2},{value:"Modeling Real Applications",id:"modeling-real-applications",level:2},{value:"Selecting a partition key",id:"selecting-a-partition-key",level:2},{value:"Selecting a sort key",id:"selecting-a-sort-key",level:2},{value:"Advanced Data Modeling",id:"advanced-data-modeling",level:2},{value:"Write Sharding (Shard write-heavy partition keys)",id:"write-sharding-shard-write-heavy-partition-keys",level:2},{value:"Calculating partition counts (reads)",id:"calculating-partition-counts-reads",level:2},{value:"Time-based workflows",id:"time-based-workflows",level:2},{value:"Adjacency lists and materialized graphs",id:"adjacency-lists-and-materialized-graphs",level:2}];function c(e){const n={a:"a",h1:"h1",h2:"h2",header:"header",img:"img",li:"li",p:"p",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"working",children:"Working"})}),"\n",(0,t.jsx)(n.h2,{id:"dynamodb-item-sizes",children:"DynamoDB Item Sizes"}),"\n",(0,t.jsx)(n.p,{children:"DynamoDB tables are schemaless, except for the primary key, so the items in a table can all have different attributes, sizes, and data types."}),"\n",(0,t.jsx)(n.p,{children:"The total size of an item is the sum of the lengths of its attribute names and values. You can use the following guidelines to estimate attribute sizes:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Strings are Unicode with UTF-8 binary encoding. The size of a string is(length of attribute name) + (number of UTF-8-encoded bytes)."}),"\n",(0,t.jsx)(n.li,{children:"Numbers are variable length, with up to 38 significant digits. Leading and trailing zeroes are trimmed. The size of a number is approximately(length of attribute name) + (1 byte per two significant digits) + (1 byte)."}),"\n",(0,t.jsx)(n.li,{children:"A binary value must be encoded in base64 format before it can be sent to DynamoDB, but the value's raw byte length is used for calculating size. The size of a binary attribute is(length of attribute name) + (number of raw bytes)."}),"\n",(0,t.jsx)(n.li,{children:"The size of a null attribute or a Boolean attribute is(length of attribute name) + (1 byte)."}),"\n",(0,t.jsx)(n.li,{children:"An attribute of typeListorMaprequires 3 bytes of overhead, regardless of its contents. The size of aListorMapis(length of attribute name) + sum (size of nested elements) + (3 bytes). The size of an emptyListorMapis(length of attribute name) + (3 bytes)."}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.a,{href:"https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/CapacityUnitCalculations.html",children:"https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/CapacityUnitCalculations.html"})}),"\n",(0,t.jsx)(n.h2,{id:"scan-vs-query",children:"Scan vs Query"}),"\n",(0,t.jsx)(n.p,{children:"A query operation searches only primary key attribute values and supports a subset of comparison operators on key attribute values to refine the search process."}),"\n",(0,t.jsx)(n.p,{children:"Getqueryyou are using a primary key inwherecondition, The computation complexity islog(n)as the most of key structure is binary tree.\nA scan operation scans the entire table. You can specify filters to apply to the results to refine the values returned to you, after the complete scan."}),"\n",(0,t.jsx)(n.p,{children:"whilescanquery you have to scan whole table then apply filter on every singlerowto find the right result. The performance isO(n). Its much slower if your table is big.\nAlso, think about the global secondary index to support a different kind of queries on different keys to gain performance objective"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.a,{href:"https://stackoverflow.com/questions/43452219/what-is-the-difference-between-scan-and-query-in-dynamodb-when-use-scan-query",children:"https://stackoverflow.com/questions/43452219/what-is-the-difference-between-scan-and-query-in-dynamodb-when-use-scan-query"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.a,{href:"https://medium.com/@amos.shahar/dynamodb-query-vs-scan-sql-syntax-and-join-tables-part-1-371288a7cb8f",children:"https://medium.com/@amos.shahar/dynamodb-query-vs-scan-sql-syntax-and-join-tables-part-1-371288a7cb8f"})}),"\n",(0,t.jsx)(n.h2,{id:"working-1",children:"Working"}),"\n",(0,t.jsx)(n.p,{children:"Read capacity unit (RCU)"}),"\n",(0,t.jsx)(n.p,{children:"Write capacity unit (WCU)"}),"\n",(0,t.jsxs)(n.p,{children:["Replicated write capacity unit (rWCU)- One ",(0,t.jsx)(n.strong,{children:"read capacity unit"})," represents one strongly consistent read per second, or two eventually consistent reads per second, for items up to 4 KB in size. If you need to read an item that is larger than 4 KB, DynamoDB will need to consume additional read capacity units. The total number of read capacity units required depends on the item size, and whether you want an eventually consistent or strongly consistent read."]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["One ",(0,t.jsx)(n.strong,{children:"write capacity unit"})," represents one write per second for items up to 1 KB in size. If you need to write an item that is larger than 1 KB, DynamoDB will need to consume additional write capacity units. The total number of write capacity units required depends on the item size."]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"image",src:i(5938).A+"",width:"999",height:"625"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Secondary Indexes","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Local secondary indexes"}),"\n",(0,t.jsx)(n.li,{children:"Global secondary indexes (asynchronous)"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.a,{href:"https://aws.amazon.com/dynamodb/pricing/provisioned",children:"https://aws.amazon.com/dynamodb/pricing/provisioned"})}),"\n",(0,t.jsx)(n.h2,{id:"nosql-data-modeling",children:"NoSQL Data Modeling"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Normalized vs De-normalized schema"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"common-nosql-design-patterns",children:"Common NoSQL Design Patterns"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Composite Keys"}),"\n",(0,t.jsx)(n.li,{children:"Hierarchical Data"}),"\n",(0,t.jsx)(n.li,{children:"Relational Data"}),"\n",(0,t.jsx)(n.li,{children:"Query Filters"}),"\n",(0,t.jsx)(n.li,{children:"Sparse Indexes"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"vertical-partitioning",children:"Vertical Partitioning"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Large items"}),"\n",(0,t.jsx)(n.li,{children:"Filters vs indexes"}),"\n",(0,t.jsxs)(n.li,{children:["M",":N"," modeling - inbox and outbox"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"modeling-real-applications",children:"Modeling Real Applications"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Partitions are 3 way replicated","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Acknowledgement when 2 out of 3 replicas acknowledges"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["Local Secondary Indexes","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"allows you to resort the data in the partition"}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.li,{children:"Global Secondary Indexes"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"selecting-a-partition-key",children:"Selecting a partition key"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Large number of distinct values"}),"\n",(0,t.jsx)(n.li,{children:"Items are uniformly requested and randomly distributed"}),"\n",(0,t.jsxs)(n.li,{children:["Examples","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Bad: Status, Gender"}),"\n",(0,t.jsx)(n.li,{children:"Good: CustomerId, DeviceId"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"selecting-a-sort-key",children:"Selecting a sort key"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Model 1",":n"," and n",":n"," relationships"]}),"\n",(0,t.jsxs)(n.li,{children:["Efficient/selective patterns","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Query multiple entities"}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.li,{children:"Leverage range queries"}),"\n",(0,t.jsxs)(n.li,{children:["Examples","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Orders and OrderItems- Composite Keys"}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.li,{children:"Multi-value Sorts and Filters"}),"\n",(0,t.jsxs)(n.li,{children:["DynamoDB Transactions API","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Transact WriteItems","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Synchronous update, put, delete, and check","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Atomic"}),"\n",(0,t.jsx)(n.li,{children:"Automated Rollbacks"}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.li,{children:"Up to 10 items within a transaction"}),"\n",(0,t.jsx)(n.li,{children:"Supports multiple tables"}),"\n",(0,t.jsx)(n.li,{children:"Complex conditional checks"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["Good use cases","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Commit changes across items"}),"\n",(0,t.jsx)(n.li,{children:"Conditional batch inserts/updates"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["Bad use case","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Maintaining normalized data"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"advanced-data-modeling",children:"Advanced Data Modeling"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["How OLTP Apps use data","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Mostly hierarchical structures"}),"\n",(0,t.jsx)(n.li,{children:"Entity driven workflows"}),"\n",(0,t.jsx)(n.li,{children:"Data spread across tables"}),"\n",(0,t.jsx)(n.li,{children:"Requires complex queries"}),"\n",(0,t.jsx)(n.li,{children:"Primary driver for ACID"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsxs)(n.a,{href:"https://www.youtube.com/watch?v=HaEPXoXVf2k",children:["AWS re",":Invent"," 2018: Amazon DynamoDB Deep Dive: Advanced Design Patterns for DynamoDB (DAT401)"]})}),"\n",(0,t.jsx)(n.h2,{id:"write-sharding-shard-write-heavy-partition-keys",children:"Write Sharding (Shard write-heavy partition keys)"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["If there are a lot of writes coming in, then create different partitions and randomly add data to partitions","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:'Insert "CandidateA_" + rand(0, 10)'}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.li,{children:"Scatter gather pattern for shard aggregation"}),"\n",(0,t.jsx)(n.li,{children:"Increase throughput with concurrency"}),"\n",(0,t.jsx)(n.li,{children:"Consider RCU/WCU per key, item size and request rate"}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Important when:"})," your write workload is not horizontally scalable"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"calculating-partition-counts-reads",children:"Calculating partition counts (reads)"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"image",src:i(143741).A+"",width:"790",height:"240"})}),"\n",(0,t.jsx)(n.h2,{id:"time-based-workflows",children:"Time-based workflows"}),"\n",(0,t.jsx)(n.p,{children:"Processing the entire table efficiently"}),"\n",(0,t.jsx)(n.h2,{id:"adjacency-lists-and-materialized-graphs",children:"Adjacency lists and materialized graphs"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Partition table on node ID, add edges to define adjacency list"}),"\n",(0,t.jsx)(n.li,{children:"Define a default edge for every node type to describe the node itself"}),"\n",(0,t.jsx)(n.li,{children:"Use partitioned GSIs to query large nodes (dates, places, etc.)"}),"\n",(0,t.jsxs)(n.li,{children:["Use DynamoDB Streams/Lambda/EMR for graph query projections","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Neighbor entity state"}),"\n",(0,t.jsx)(n.li,{children:"Subtree aggregations"}),"\n",(0,t.jsx)(n.li,{children:"Breadth first search"}),"\n",(0,t.jsx)(n.li,{children:"Node ranking"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsxs)(n.a,{href:"https://www.youtube.com/watch?v=6yqfmXiZTlM",children:["AWS re",":Invent"," 2019: [REPEAT 1] Amazon DynamoDB deep dive: Advanced design patterns (DAT403-R1)"]})})]})}function h(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}},5938:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/AWS-DynamoDB_Working-image1-a813b4f60e4016ed43d505ccd66296bf.jpg"},143741:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/AWS-DynamoDB_Working-image2-d6284a61f21279cb4e6b34ad205bd686.jpg"},28453:(e,n,i)=>{i.d(n,{R:()=>r,x:()=>l});var s=i(296540);const t={},a=s.createContext(t);function r(e){const n=s.useContext(a);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:r(e.components),s.createElement(a.Provider,{value:n},e.children)}}}]);