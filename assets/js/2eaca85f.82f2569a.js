"use strict";(self.webpackChunkdeep_notes=self.webpackChunkdeep_notes||[]).push([[86122],{241644:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>o,contentTitle:()=>c,default:()=>h,frontMatter:()=>r,metadata:()=>a,toc:()=>d});const a=JSON.parse('{"id":"decentralized-applications/ethereum/06-transactions","title":"Transactions","description":"Transactions are cryptographically signed instructions from accounts. An account will initiate a transaction to update the state of the Ethereum network. The simplest transaction is transferring ETH from one account to another.","source":"@site/docs/decentralized-applications/ethereum/06-transactions.md","sourceDirName":"decentralized-applications/ethereum","slug":"/decentralized-applications/ethereum/06-transactions","permalink":"/decentralized-applications/ethereum/06-transactions","draft":false,"unlisted":false,"editUrl":"https://github.com/deepaksood619/deepaksood619.github.io/tree/master/docs/decentralized-applications/ethereum/06-transactions.md","tags":[],"version":"current","lastUpdatedBy":"Deepak","lastUpdatedAt":1746694125000,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Ethereum Accounts","permalink":"/decentralized-applications/ethereum/05-accounts"},"next":{"title":"Blocks","permalink":"/decentralized-applications/ethereum/07-blocks"}}');var s=t(474848),i=t(28453);const r={},c="Transactions",o={},d=[{value:"What&#39;s a transaction?",id:"whats-a-transaction",level:2},{value:"The data field",id:"the-data-field",level:3},{value:"Types of transactions",id:"types-of-transactions",level:2},{value:"On gas",id:"on-gas",level:3},{value:"Transaction lifecycle",id:"transaction-lifecycle",level:2},{value:"A visual demo",id:"a-visual-demo",level:2},{value:"Typed Transaction Envelope",id:"typed-transaction-envelope",level:2},{value:"Coinbase Transactions",id:"coinbase-transactions",level:2},{value:"Characteristics of Coinbase Transactions",id:"characteristics-of-coinbase-transactions",level:3},{value:"Further reading",id:"further-reading",level:2}];function l(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"transactions",children:"Transactions"})}),"\n",(0,s.jsx)(n.p,{children:"Transactions are cryptographically signed instructions from accounts. An account will initiate a transaction to update the state of the Ethereum network. The simplest transaction is transferring ETH from one account to another."}),"\n",(0,s.jsx)(n.h2,{id:"whats-a-transaction",children:"What's a transaction?"}),"\n",(0,s.jsx)(n.p,{children:"An Ethereum transaction refers to an action initiated by an externally-owned account, in other words an account managed by a human, not a contract. For example, if Bob sends Alice 1 ETH, Bob's account must be debited and Alice's must be credited. This state-changing action takes place within a transaction."}),"\n",(0,s.jsx)(n.p,{children:"Transactions, which change the state of the EVM, need to be broadcast to the whole network. Any node can broadcast a request for a transaction to be executed on the EVM; after this happens, a validator will execute the transaction and propagate the resulting state change to the rest of the network."}),"\n",(0,s.jsx)(n.p,{children:"Transactions require a fee and must be included in a validated block. To make this overview simpler we'll cover gas fees and validation elsewhere."}),"\n",(0,s.jsx)(n.p,{children:"A submitted transaction includes the following information:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"from"})," - the address of the sender, that will be signing the transaction. This will be an externally-owned account as contract accounts cannot send transactions."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"recipient"})," - the receiving address (if an externally-owned account, the transaction will transfer value. If a contract account, the transaction will execute the contract code)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"signature"})," - the identifier of the sender. This is generated when the sender's private key signs the transaction and confirms the sender has authorized this transaction"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"nonce"})," - a sequencially incrementing counter which indicates the transaction number from the account"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"value"})," - amount of ETH to transfer from sender to recipient (denominated in WEI, where 1ETH equals 1e+18wei)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"data"})," - optional field to include arbitrary data"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"gasLimit"})," - the maximum amount of gas units that can be consumed by the transaction. The ",(0,s.jsx)(n.a,{href:"https://ethereum.org/en/developers/docs/evm/opcodes",children:"EVM"})," specifies the units of gas required by each computational step"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"maxPriorityFeePerGas"})," - the maximum price of the consumed gas to be included as a tip to the validator"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"maxFeePerGas"})," - the maximum fee per unit of gas willing to be paid for the transaction (inclusive of ",(0,s.jsx)(n.code,{children:"baseFeePerGas"})," and ",(0,s.jsx)(n.code,{children:"maxPriorityFeePerGas"}),")"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["Gas is a reference to the computation required to process the transaction by a validator. Users have to pay a fee for this computation. The ",(0,s.jsx)(n.code,{children:"gasLimit"}),", and ",(0,s.jsx)(n.code,{children:"maxPriorityFeePerGas"})," determine the maximum transaction fee paid to the validator. ",(0,s.jsx)(n.a,{href:"https://ethereum.org/en/developers/docs/gas/",children:"More on Gas"}),"."]}),"\n",(0,s.jsx)(n.p,{children:"The transaction object will look a little like this:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  from: "0xEA674fdDe714fd979de3EdF0F56AA9716B898ec8",\n  to: "0xac03bb73b6a9e108530aff4df5077c2b3d481e5a",\n  gasLimit: "21000",\n  maxFeePerGas: "300",\n  maxPriorityFeePerGas: "10",\n  nonce: "0",\n  value: "10000000000"\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:"But a transaction object needs to be signed using the sender's private key. This proves that the transaction could only have come from the sender and was not sent fraudulently."}),"\n",(0,s.jsx)(n.p,{children:"An Ethereum client like Geth will handle this signing process."}),"\n",(0,s.jsxs)(n.p,{children:["Example ",(0,s.jsx)(n.a,{href:"https://ethereum.org/en/developers/docs/apis/json-rpc/",children:"JSON-RPC"})," call:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "id": 2,\n  "jsonrpc": "2.0",\n  "method": "account_signTransaction",\n  "params": [\n    {\n      "from": "0x1923f626bb8dc025849e00f99c25fe2b2f7fb0db",\n      "gas": "0x55555",\n      "maxFeePerGas": "0x1234",\n      "maxPriorityFeePerGas": "0x1234",\n      "input": "0xabcd",\n      "nonce": "0x0",\n      "to": "0x07a565b7ed7d7a678680a4c162885bedbb695fe0",\n      "value": "0x1234"\n    }\n  ]\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:"Example response:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "jsonrpc": "2.0",\n  "id": 2,\n  "result": {\n    "raw": "0xf88380018203339407a565b7ed7d7a678680a4c162885bedbb695fe080a44401a6e4000000000000000000000000000000000000000000000000000000000000001226a0223a7c9bcf5531c99be5ea7082183816eb20cfe0bbc322e97cc5c7f71ab8b20ea02aadee6b34b45bb15bc42d9c09de4a6754e7000908da72d48cc7704971491663",\n    "tx": {\n      "nonce": "0x0",\n      "maxFeePerGas": "0x1234",\n      "maxPriorityFeePerGas": "0x1234",\n      "gas": "0x55555",\n      "to": "0x07a565b7ed7d7a678680a4c162885bedbb695fe0",\n      "value": "0x1234",\n      "input": "0xabcd",\n      "v": "0x26",\n      "r": "0x223a7c9bcf5531c99be5ea7082183816eb20cfe0bbc322e97cc5c7f71ab8b20e",\n      "s": "0x2aadee6b34b45bb15bc42d9c09de4a6754e7000908da72d48cc7704971491663",\n      "hash": "0xeba2df809e7a612a0a0d444ccfa5c839624bdc00dd29e3340d46df3870f8a30e"\n    }\n  }\n}\n\n'})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["the ",(0,s.jsx)(n.code,{children:"raw"})," is the signed transaction in Recursive Length Prefix (RLP) encoded form"]}),"\n",(0,s.jsxs)(n.li,{children:["the ",(0,s.jsx)(n.code,{children:"tx"})," is the signed transaction in JSON form"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"With the signature hash, the transaction can be cryptographically proven that it came from the sender and submitted to the network."}),"\n",(0,s.jsx)(n.h3,{id:"the-data-field",children:"The data field"}),"\n",(0,s.jsxs)(n.p,{children:["The vast majority of transactions access a contract from an externally-owned account. Most contracts are written in Solidity and interpret their data field in accordance with the ",(0,s.jsx)(n.a,{href:"https://ethereum.org/en/glossary/#abi",children:"application binary interface (ABI)"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:["The first four bytes specify which function to call, using the hash of the function's name and arguments. You can sometimes identify the function from the selector using ",(0,s.jsx)(n.a,{href:"https://www.4byte.directory/signatures/",children:"this database"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:["The rest of the calldata is the arguments, ",(0,s.jsx)(n.a,{href:"https://docs.soliditylang.org/en/latest/abi-spec.html#formal-specification-of-the-encoding",children:"encoded as specified in the ABI specs"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:["For example, lets look at ",(0,s.jsx)(n.a,{href:"https://etherscan.io/tx/0xd0dcbe007569fcfa1902dae0ab8b4e078efe42e231786312289b1eee5590f6a1",children:"this transaction"}),". Use ",(0,s.jsx)(n.strong,{children:"Click to see More"})," to see the calldata."]}),"\n",(0,s.jsxs)(n.p,{children:["The function selector is ",(0,s.jsx)(n.code,{children:"0xa9059cbb"}),". There are several ",(0,s.jsx)(n.a,{href:"https://www.4byte.directory/signatures/?bytes4_signature=0xa9059cbb",children:"known functions with this signature"}),". In this case ",(0,s.jsx)(n.a,{href:"https://etherscan.io/address/0xa0b86991c6218b36c1d19d4a2e9eb0ce3606eb48#code",children:"the contract source code"})," has been uploaded to Etherscan, so we know the function is ",(0,s.jsx)(n.code,{children:"transfer(address,uint256)"}),"."]}),"\n",(0,s.jsx)(n.p,{children:"The rest of the data is:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-text",children:"0000000000000000000000004f6742badb049791cd9a37ea913f2bac38d01279\n000000000000000000000000000000000000000000000000000000003b0559f4\n"})}),"\n",(0,s.jsxs)(n.p,{children:["According to the ABI specifications, integer values (such as addresses, which are 20-byte integers) appear in the ABI as 32-byte words, padded with zeros in the front. So we know that the ",(0,s.jsx)(n.code,{children:"to"})," address is ",(0,s.jsx)(n.a,{href:"https://etherscan.io/address/0x4f6742badb049791cd9a37ea913f2bac38d01279",children:(0,s.jsx)(n.code,{children:"4f6742badb049791cd9a37ea913f2bac38d01279"})}),". The ",(0,s.jsx)(n.code,{children:"value"})," is 0x3b0559f4 = 990206452."]}),"\n",(0,s.jsx)(n.h2,{id:"types-of-transactions",children:"Types of transactions"}),"\n",(0,s.jsx)(n.p,{children:"On Ethereum there are a few different types of transactions:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Regular transactions:"})," a transaction from one account to another."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Contract deployment transactions:"})," a transaction without a 'to' address, where the data field is used for the contract code."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Execution of a contract:"})," a transaction that interacts with a deployed smart contract. In this case, 'to' address is the smart contract address."]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"on-gas",children:"On gas"}),"\n",(0,s.jsx)(n.p,{children:"As mentioned, transactions cost gas to execute. Simple transfer transactions require 21000 units of Gas."}),"\n",(0,s.jsxs)(n.p,{children:["So for Bob to send Alice 1 ETH at a ",(0,s.jsx)(n.code,{children:"baseFeePerGas"})," of 190 gwei and ",(0,s.jsx)(n.code,{children:"maxPriorityFeePerGas"})," of 10 gwei, Bob will need to pay the following fee:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"(190 + 10) * 21000 = 4,200,000 gwei\n--or--\n0.0042 ETH\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Bob's account will be debited ",(0,s.jsx)(n.strong,{children:"-1.0042 ETH"})," (1 ETH for Alice + 0.0042 ETH in gas fees)"]}),"\n",(0,s.jsxs)(n.p,{children:["Alice's account will be credited ",(0,s.jsx)(n.strong,{children:"+1.0 ETH"})]}),"\n",(0,s.jsxs)(n.p,{children:["The base fee will be burned ",(0,s.jsx)(n.strong,{children:"-0.00399 ETH"})]}),"\n",(0,s.jsxs)(n.p,{children:["Validator keeps the tip ",(0,s.jsx)(n.strong,{children:"+0.000210 ETH"})]}),"\n",(0,s.jsx)(n.p,{children:"Gas is required for any smart contract interaction too."}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"Diagram showing how unused gas is refunded",src:t(602606).A+"",width:"1000",height:"562"})}),"\n",(0,s.jsx)(n.p,{children:"Any gas not used in a transaction is refunded to the user account."}),"\n",(0,s.jsx)(n.h2,{id:"transaction-lifecycle",children:"Transaction lifecycle"}),"\n",(0,s.jsx)(n.p,{children:"Once the transaction has been submitted the following happens:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["A transaction hash is cryptographically generated: ",(0,s.jsx)(n.code,{children:"0x97d99bc7729211111a21b12c933c949d4f31684f1d6954ff477d0477538ff017"})]}),"\n",(0,s.jsx)(n.li,{children:"The transaction is then broadcasted to the network and added to a transaction pool consisting of all other pending network transactions."}),"\n",(0,s.jsx)(n.li,{children:'A validator must pick your transaction and include it in a block in order to verify the transaction and consider it "successful".'}),"\n",(0,s.jsx)(n.li,{children:'As time passes the block containing your transaction will be upgraded to "justified" then "finalized". These upgrades make it much more certain that your transaction was successful and will never be altered. Once a block is "finalized" it could only ever be changed by a network level attack that would cost many billions of dollars.'}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"a-visual-demo",children:"A visual demo"}),"\n",(0,s.jsx)(n.p,{children:"Watch Austin walk you through transactions, gas, and mining."}),"\n",(0,s.jsx)("iframe",{src:"https://www.youtube.com/embed/er-0ihqFQB0",frameborder:"0",title:"YouTube",allow:" accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowfullscreen:""}),"\n",(0,s.jsx)(n.h2,{id:"typed-transaction-envelope",children:"Typed Transaction Envelope"}),"\n",(0,s.jsx)(n.p,{children:"Ethereum originally had one format for transactions. Each transaction contained a nonce, gas price, gas limit, to address, value, data, v, r, and s. These fields are RLP-encoded, to look something like this:"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"RLP([nonce, gasPrice, gasLimit, to, value, data, v, r, s])"})}),"\n",(0,s.jsxs)(n.p,{children:["Ethereum has evolved to support multiple types of transactions to allow for new features such as access lists and ",(0,s.jsx)(n.a,{href:"https://eips.ethereum.org/EIPS/eip-1559",children:"EIP-1559"})," to be implemented without affecting legacy transaction formats."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.a,{href:"https://eips.ethereum.org/EIPS/eip-2718",children:"EIP-2718"})," is what allows for this behaviour. Transactions are interpreted as:"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"TransactionType || TransactionPayload"})}),"\n",(0,s.jsx)(n.p,{children:"Where the fields are defined as:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"TransactionType"})," - a number between 0 and 0x7f, for a total of 128 possible transaction types."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"TransactionPayload"})," - an arbitrary byte array defined by the transaction type."]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"coinbase-transactions",children:"Coinbase Transactions"}),"\n",(0,s.jsxs)(n.p,{children:["All transactions that take place on the cryptocurrency network are not the result of payment between two people. Some transactions are a little bit different. The first transaction that took place was in ",(0,s.jsx)(n.a,{href:"https://www.geeksforgeeks.org/what-is-bitcoin/",children:"Bitcoin"}),". It was a special transaction that formatted reward transactions for miners inside the genesis block (the very first block of a blockchain). Such reward transactions are specially allocated to the miner for their work. This type of transaction is known as a Coinbase transaction. These type of transactions generates new currencies that have never been spent (Like the printing of fiat currencies)."]}),"\n",(0,s.jsx)(n.h3,{id:"characteristics-of-coinbase-transactions",children:"Characteristics of Coinbase Transactions"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"1. The first transaction in a new block:"})," In most cases, the coinbase transaction is the first transaction in a new block. The reward generated by this transaction can be sent to a single or multiple wallet addresses like a normal cryptocurrency transaction."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"2. Spending the Cryptocurrency from a Coinbase Transaction:"})," The rewards earned by a coinbase transaction cannot be spent until they receive a certain number of confirmations in the ",(0,s.jsx)(n.a,{href:"https://www.geeksforgeeks.org/blockchain-technology-introduction/",children:"blockchain"}),". For bitcoin, the number is 100. Bitcoins earned from coinbase transactions cannot be spent until it reaches 100 confirmation in the blockchain."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"3. Halving:"})," After a certain number of successful blocks being added to the blockchain the reward generated for adding each successful block becomes reduced by 50%. This phenomenon is known as halving. This event occurs in bitcoin after every 210000 successful blocks are mined. For bitcoin the rewards for every successful block were 50BTC per block initially then it went to 25BTC currently came down to 12.5 BTC. The reward for each coinbase transaction is determined by this value."]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{href:"https://www.geeksforgeeks.org/what-is-coinbase-transaction/",children:"What is Coinbase Transaction? - GeeksforGeeks"})}),"\n",(0,s.jsx)(n.h2,{id:"further-reading",children:"Further reading"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://eips.ethereum.org/EIPS/eip-2718",children:"EIP-2718: Typed Transaction Envelope"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://ethereum.org/en/developers/docs/data-structures-and-encoding/rlp/",children:"Recursive-length prefix (RLP) serialization | ethereum.org"})}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},602606:(e,n,t)=>{t.d(n,{A:()=>a});const a=t.p+"assets/images/Pasted image 20230305171843-36456e39dbbd8f5c9922efcdd1a6e251.jpg"},28453:(e,n,t)=>{t.d(n,{R:()=>r,x:()=>c});var a=t(296540);const s={},i=a.createContext(s);function r(e){const n=a.useContext(i);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),a.createElement(i.Provider,{value:n},e.children)}}}]);