"use strict";(self.webpackChunkdeep_notes=self.webpackChunkdeep_notes||[]).push([[61907],{81858:(e,s,t)=>{t.r(s),t.d(s,{assets:()=>l,contentTitle:()=>r,default:()=>c,frontMatter:()=>o,metadata:()=>a,toc:()=>u});const a=JSON.parse('{"id":"cloud/aws/analytics/amazon-sqs","title":"Amazon SQS","description":"Managed Message Queues","source":"@site/docs/cloud/aws/analytics/amazon-sqs.md","sourceDirName":"cloud/aws/analytics","slug":"/cloud/aws/analytics/amazon-sqs","permalink":"/cloud/aws/analytics/amazon-sqs","draft":false,"unlisted":false,"editUrl":"https://github.com/deepaksood619/deepaksood619.github.io/tree/master/docs/cloud/aws/analytics/amazon-sqs.md","tags":[],"version":"current","lastUpdatedBy":"Deepak","lastUpdatedAt":1762888182000,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Amazon Opensearch","permalink":"/cloud/aws/analytics/amazon-opensearch"},"next":{"title":"AWS Glue","permalink":"/cloud/aws/analytics/aws-glue/"}}');var n=t(474848),i=t(28453);const o={},r="Amazon SQS",l={},u=[{value:"SQS FIFO Queues",id:"sqs-fifo-queues",level:2},{value:"Question",id:"question",level:3},{value:"SQS Temporary Queues",id:"sqs-temporary-queues",level:2},{value:"SQS Dead-Letter Queues",id:"sqs-dead-letter-queues",level:2},{value:"How does Amazon SQS handle messages that can&#39;t be processed?",id:"how-does-amazon-sqs-handle-messages-that-cant-be-processed",level:3},{value:"Can I use a dead letter queue with FIFO queues?",id:"can-i-use-a-dead-letter-queue-with-fifo-queues",level:3},{value:"SQS Delay Queues",id:"sqs-delay-queues",level:2},{value:"Configuration",id:"configuration",level:3},{value:"What is a visibility timeout?",id:"what-is-a-visibility-timeout",level:3},{value:"SQS Standard Queue",id:"sqs-standard-queue",level:2},{value:"Advantages",id:"advantages",level:3},{value:"Batching",id:"batching",level:3},{value:"How is Amazon SQS different from Amazon SNS?",id:"how-is-amazon-sqs-different-from-amazon-sns",level:2},{value:"Does Amazon SQS support message metadata?",id:"does-amazon-sqs-support-message-metadata",level:2},{value:"How can I determine the time-in-queue value?",id:"how-can-i-determine-the-time-in-queue-value",level:2},{value:"What is the typical latency for Amazon SQS?",id:"what-is-the-typical-latency-for-amazon-sqs",level:2},{value:"What is Amazon SQS long polling?",id:"what-is-amazon-sqs-long-polling",level:2},{value:"When should I use Amazon SQS long polling, and when should I use Amazon SQS short polling?",id:"when-should-i-use-amazon-sqs-long-polling-and-when-should-i-use-amazon-sqs-short-polling",level:2},{value:"What value should I use for my long-poll timeout?",id:"what-value-should-i-use-for-my-long-poll-timeout",level:2},{value:"Can I delete all messages in a message queue without deleting the message queue itself?",id:"can-i-delete-all-messages-in-a-message-queue-without-deleting-the-message-queue-itself",level:2},{value:"Which AWS CloudWatch metrics do Amazon SQS FIFO queues support?",id:"which-aws-cloudwatch-metrics-do-amazon-sqs-fifo-queues-support",level:2},{value:"What are message groups?",id:"what-are-message-groups",level:2},{value:"Do Amazon SQS FIFO queues support multiple producers?",id:"do-amazon-sqs-fifo-queues-support-multiple-producers",level:2},{value:"Do Amazon SQS FIFO queues support multiple consumers?",id:"do-amazon-sqs-fifo-queues-support-multiple-consumers",level:2},{value:"Why are there separate ReceiveMessage and DeleteMessage operations?",id:"why-are-there-separate-receivemessage-and-deletemessage-operations",level:2},{value:"Can a deleted message be received again?",id:"can-a-deleted-message-be-received-again",level:2},{value:"What happens if I issue a DeleteMessage request on a previously-deleted message?",id:"what-happens-if-i-issue-a-deletemessage-request-on-a-previously-deleted-message",level:2},{value:"How long can I keep my messages in Amazon SQS message queues?",id:"how-long-can-i-keep-my-messages-in-amazon-sqs-message-queues",level:2},{value:"Boto3",id:"boto3",level:2},{value:"sqs_consumer.py",id:"sqs_consumerpy",level:3},{value:"sqs_producer.py",id:"sqs_producerpy",level:3}];function d(e){const s={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.header,{children:(0,n.jsx)(s.h1,{id:"amazon-sqs",children:"Amazon SQS"})}),"\n",(0,n.jsx)(s.p,{children:"Managed Message Queues"}),"\n",(0,n.jsx)(s.p,{children:"Amazon Simple Queue Service (SQS) is a fully managed message queuing service that enables you to decouple and scale microservices, distributed systems, and serverless applications. SQS eliminates the complexity and overhead associated with managing and operating message oriented middleware, and empowers developers to focus on differentiating work. Using SQS, you can send, store, and receive messages between software components at any volume, without losing messages or requiring other services to be available. Get started with SQS in minutes using the AWS console, Command Line Interface or SDK of your choice, and three simple commands."}),"\n",(0,n.jsxs)(s.p,{children:["SQS offers two types of message queues. ",(0,n.jsx)(s.strong,{children:"Standard queues"})," offer maximum throughput, best-effort ordering, and at-least-once delivery. ",(0,n.jsx)(s.strong,{children:"SQS FIFO queues"})," are designed to guarantee that messages are processed exactly once, in the exact order that they are seen"]}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:"Dead letter queue support"}),"\n",(0,n.jsx)(s.li,{children:"Visibility timeout"}),"\n",(0,n.jsx)(s.li,{children:"Long pooling"}),"\n"]}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.a,{href:"https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/sqs-queue-types.html",children:"Amazon SQS queue types - Amazon Simple Queue Service"})}),"\n",(0,n.jsx)(s.h2,{id:"sqs-fifo-queues",children:"SQS FIFO Queues"}),"\n",(0,n.jsx)(s.p,{children:"By default, FIFO queues support up to 3,000 messages per second with batching, or up to 300 messages per second (300 send, receive, or delete operations per second) without batching. Therefore, using batching you can meet a throughput requirement of upto 3,000 messages per second."}),"\n",(0,n.jsx)(s.p,{children:"By default, FIFO queues support up to 300 messages per second (300 send, receive, or delete operations per second). When you batch 10 messages per operation (maximum), FIFO queues can support up to 3,000 messages per second. Therefore you need to process 4 messages per operation so that the FIFO queue can support up to 1200 messages per second, if you have a requirement of 1000 messages per second."}),"\n",(0,n.jsx)(s.p,{children:'If we don\'t specify a GroupID, then all the messages are in absolute order, but we can only have 1 consumer at most. To allow for multiple consumers to read data for each type of application, and to scale the number of consumers, we should use the "Group ID" attribute.'}),"\n",(0,n.jsx)(s.p,{children:"The name of a FIFO queue must end with the .fifo suffix. The suffix counts towards the 80-character queue name limit. To determine whether a queue is FIFO, you can check whether the queue name ends with the suffix."}),"\n",(0,n.jsx)(s.p,{children:"If you have an existing application that uses standard queues and you want to take advantage of the ordering or exactly-once processing features of FIFO queues, you need to configure the queue and your application correctly. You can't convert an existing standard queue into a FIFO queue. To make the move, you must either create a new FIFO queue for your application or delete your existing standard queue and recreate it as a FIFO queue."}),"\n",(0,n.jsx)(s.h3,{id:"question",children:"Question"}),"\n",(0,n.jsx)(s.p,{children:"The engineering team at an e-commerce company wants to migrate from Amazon Simple Queue Service (Amazon SQS) Standard queues to FIFO (First-In-First-Out) queues with batching. Migration checklist"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:"Make sure that the name of the FIFO (First-In-First-Out) queue ends with the .fifo suffix"}),"\n",(0,n.jsx)(s.li,{children:"Delete the existing standard queue and recreate it as a FIFO (First-In-First-Out) queue"}),"\n",(0,n.jsx)(s.li,{children:"Make sure that the throughput for the target FIFO (First-In-First-Out) queue does not exceed 3,000 messages per second"}),"\n"]}),"\n",(0,n.jsx)(s.h2,{id:"sqs-temporary-queues",children:"SQS Temporary Queues"}),"\n",(0,n.jsx)(s.p,{children:"Temporary queues help you save development time and deployment costs when using common message patterns such as request-response. You can use the Temporary Queue Client to create high-throughput, cost-effective, application-managed temporary queues."}),"\n",(0,n.jsx)(s.p,{children:"The client maps multiple temporary queues\u2014application-managed queues created on demand for a particular process\u2014onto a single Amazon SQS queue automatically. This allows your application to make fewer API calls and have a higher throughput when the traffic to each temporary queue is low. When a temporary queue is no longer in use, the client cleans up the temporary queue automatically, even if some processes that use the client aren't shut down cleanly."}),"\n",(0,n.jsx)(s.p,{children:"The following are the benefits of temporary queues:"}),"\n",(0,n.jsxs)(s.ol,{children:["\n",(0,n.jsx)(s.li,{children:"They serve as lightweight communication channels for specific threads or processes."}),"\n",(0,n.jsx)(s.li,{children:"They can be created and deleted without incurring additional costs."}),"\n",(0,n.jsx)(s.li,{children:"They are API-compatible with static (normal) Amazon SQS queues. This means that existing code that sends and receives messages can send messages to and receive messages from virtual queues."}),"\n"]}),"\n",(0,n.jsx)(s.p,{children:"To better support short-lived, lightweight messaging destinations, AWS recommends Amazon SQS Temporary Queue Client. This client makes it easy to create and delete many temporary messaging destinations without inflating your AWS bill. The key concept behind the client is the virtual queue. Virtual queues let you multiplex many low-traffic queues onto a single Amazon SQS queue. Creating a virtual queue only instantiates a local buffer to hold messages for consumers as they arrive; there is no API call to SQS and no costs associated with creating a virtual queue."}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.a,{href:"https://aws.amazon.com/blogs/compute/simple-two-way-messaging-using-the-amazon-sqs-temporary-queue-client/",children:"Simple Two-way Messaging using the Amazon SQS Temporary Queue Client | AWS Compute Blog"})}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.a,{href:"https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/sqs-temporary-queues.html",children:"Amazon SQS temporary queues - Amazon Simple Queue Service"})}),"\n",(0,n.jsx)(s.h2,{id:"sqs-dead-letter-queues",children:"SQS Dead-Letter Queues"}),"\n",(0,n.jsx)(s.p,{children:"Amazon SQS supports dead-letter queues, which other queues (source queues) can target for messages that can't be processed (consumed) successfully. Dead-letter queues are useful for debugging your application or messaging system because they let you isolate problematic messages to determine why their processing doesn't succeed. Amazon SQS does not create the dead-letter queue automatically. You must first create the queue before using it as a dead-letter queue."}),"\n",(0,n.jsx)(s.h3,{id:"how-does-amazon-sqs-handle-messages-that-cant-be-processed",children:"How does Amazon SQS handle messages that can't be processed?"}),"\n",(0,n.jsx)(s.p,{children:"In Amazon SQS, you can use the API or the console to configure dead-letter queues, which are queues that receive messages from other source queues."}),"\n",(0,n.jsx)(s.p,{children:"If you make a queue into a dead letter queue, it receives messages after a maximum number of processing attempts cannot be completed. You can use dead letter queues to isolate messages that can't be processed for later analysis."}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.a,{href:"https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/sqs-dead-letter-queues.html",children:"Using dead-letter queues in Amazon SQS - Amazon Simple Queue Service"})}),"\n",(0,n.jsx)(s.h3,{id:"can-i-use-a-dead-letter-queue-with-fifo-queues",children:"Can I use a dead letter queue with FIFO queues?"}),"\n",(0,n.jsx)(s.p,{children:"Yes. However, you must use a FIFO dead letter queue with a FIFO queue. (Similarly, you can use only a standard dead letter queue with a standard queue.)"}),"\n",(0,n.jsx)(s.h2,{id:"sqs-delay-queues",children:"SQS Delay Queues"}),"\n",(0,n.jsx)(s.p,{children:"Delay queues let you postpone the delivery of new messages to a queue for a number of seconds, for example, when your consumer application needs additional time to process messages. If you create a delay queue, any messages that you send to the queue remain invisible to consumers for the duration of the delay period. The default (minimum) delay for a queue is 0 seconds. The maximum is 15 minutes (900 seconds)."}),"\n",(0,n.jsxs)(s.p,{children:["Delay queues are similar to\xa0",(0,n.jsx)(s.a,{href:"https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/sqs-visibility-timeout.html",children:"visibility timeouts"}),"\xa0because both features make messages unavailable to consumers for a specific period of time. The difference between the two is that, for ",(0,n.jsx)(s.strong,{children:"delay queues, a message is hidden when it is first added to queue"}),", whereas for ",(0,n.jsx)(s.strong,{children:"visibility timeouts a message is hidden only after it is consumed from the queue"}),". The following diagram illustrates the relationship between delay queues and visibility timeouts."]}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.img,{src:"https://docs.aws.amazon.com/images/AWSSimpleQueueService/latest/SQSDeveloperGuide/images/sqs-delay-queues-diagram.png",alt:"An illustration of the relationship between delay queues and visibility timeouts."})}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.a,{href:"https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/sqs-delay-queues.html",children:"Amazon SQS delay queues - Amazon Simple Queue Service"})}),"\n",(0,n.jsx)(s.h3,{id:"configuration",children:"Configuration"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.strong,{children:"Queue-level delay:"}),"\xa0A delay can be configured for the entire queue, meaning all messages sent to that queue will be subject to the same delay.\xa0This is set using the\xa0",(0,n.jsx)(s.code,{children:"DelaySeconds"}),"\xa0attribute of the queue."]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.strong,{children:"Message-level delay (Message Timers):"}),"\xa0Individual messages can also have a delay specified using the\xa0",(0,n.jsx)(s.code,{children:"DelaySeconds"}),"\xa0parameter when sending the message.\xa0If both queue-level and message-level delays are set, the message-level delay overrides the queue-level setting for that specific message."]}),"\n"]}),"\n",(0,n.jsx)(s.h3,{id:"what-is-a-visibility-timeout",children:"What is a visibility timeout?"}),"\n",(0,n.jsxs)(s.p,{children:["The visibility timeout is a period of time during which Amazon SQS prevents other consuming components from receiving and processing a message. For more information, see ",(0,n.jsx)(s.a,{href:"http://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/AboutVT.html",children:"Visibility Timeout"})," in theAmazon SQS Developer Guide."]}),"\n",(0,n.jsx)(s.h2,{id:"sqs-standard-queue",children:"SQS Standard Queue"}),"\n",(0,n.jsx)(s.h3,{id:"advantages",children:"Advantages"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.strong,{children:"Durability--"})," To ensure the safety of your messages, Amazon SQS stores them on multiple servers. Standard queues support ",(0,n.jsx)(s.a,{href:"https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/standard-queues.html#standard-queues-at-least-once-delivery",children:"at-least-once message delivery"}),", and FIFO queues support ",(0,n.jsx)(s.a,{href:"https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/FIFO-queues.html#FIFO-queues-exactly-once-processing",children:"exactly-once message processing"}),"."]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.strong,{children:"Availability--"})," Amazon SQS uses ",(0,n.jsx)(s.a,{href:"https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/sqs-basic-architecture.html",children:"redundant infrastructure"})," to provide highly-concurrent access to messages and high availability for producing and consuming messages."]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.strong,{children:"Scalability--"})," Amazon SQS can process each ",(0,n.jsx)(s.a,{href:"https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/sqs-client-side-buffering-request-batching.html",children:"buffered request"})," independently, scaling transparently to handle any load increases or spikes without any provisioning instructions."]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.strong,{children:"Reliability--"})," Amazon SQS locks your messages during processing, so that multiple producers can send and multiple consumers can receive messages at the same time."]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.strong,{children:"Customization--"})," Your queues don't have to be exactly alike - for example, you can ",(0,n.jsx)(s.a,{href:"https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/sqs-delay-queues.html",children:"set a default delay on a queue"}),". You can store the contents of messages larger than 256 KB ",(0,n.jsx)(s.a,{href:"https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/sqs-s3-messages.html",children:"using Amazon Simple Storage Service (Amazon S3)"})," or Amazon DynamoDB, with Amazon SQS holding a pointer to the Amazon S3 object, or you can split a large message into smaller messages."]}),"\n"]}),"\n",(0,n.jsx)(s.p,{children:"Max Payload Size - 256 KB"}),"\n",(0,n.jsxs)(s.p,{children:["Can be increased using s3 - ",(0,n.jsx)(s.a,{href:"https://github.com/awslabs/amazon-sqs-java-extended-client-lib",children:"https://github.com/awslabs/amazon-sqs-java-extended-client-lib"})]}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.a,{href:"https://github.com/timothymugayi/boto3-sqs-extended-client-lib",children:"https://github.com/timothymugayi/boto3-sqs-extended-client-lib"})}),"\n",(0,n.jsx)(s.h3,{id:"batching",children:"Batching"}),"\n",(0,n.jsx)(s.p,{children:"Send, receive, or delete messages in batches of up to 10 messages or 256KB to save costs."}),"\n",(0,n.jsx)(s.p,{children:"All customers can make 1 million Amazon SQS requests for free each month."}),"\n",(0,n.jsxs)(s.table,{children:[(0,n.jsx)(s.thead,{children:(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.th,{children:"Pricing per 1 million Requests after Free tier (Monthly)"}),(0,n.jsx)(s.th,{})]})}),(0,n.jsxs)(s.tbody,{children:[(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"Standard Queue"}),(0,n.jsx)(s.td,{children:"$0.40($0.0000004per request)"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"FIFO Queue"}),(0,n.jsx)(s.td,{children:"$0.50($0.0000005per request)"})]})]})]}),"\n",(0,n.jsxs)(s.table,{children:[(0,n.jsx)(s.thead,{children:(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.th,{children:"API Actions"}),(0,n.jsx)(s.th,{children:"Every Amazon SQS action counts as a request."})]})}),(0,n.jsxs)(s.tbody,{children:[(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"FIFO Requests"}),(0,n.jsx)(s.td,{children:"API actions for sending, receiving, deleting, and changing visibility of messages from FIFO queues are charged at FIFO rates. All other API requests are charged at standard rates."})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"Contents of Requests"}),(0,n.jsx)(s.td,{children:"A single request can have from 1 to 10 messages, up to a maximum total payload of 256 KB."})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"Size of Payloads"}),(0,n.jsx)(s.td,{children:"Each 64 KB chunk of a payload is billed as 1 request (for example, an API action with a 256 KB payload is billed as 4 requests)."})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"Interaction with Amazon S3"}),(0,n.jsxs)(s.td,{children:["When using the ",(0,n.jsx)(s.a,{href:"https://github.com/awslabs/amazon-sqs-java-extended-client-lib",children:"Amazon SQS Extended Client Library"})," to send payloads using Amazon S3, you incur ",(0,n.jsx)(s.a,{href:"https://aws.amazon.com/s3/pricing/",children:"Amazon S3 charges"})," for any Amazon S3 storage you use to send message payloads."]})]})]})]}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.a,{href:"https://aws.amazon.com/sqs",children:"https://aws.amazon.com/sqs"})}),"\n",(0,n.jsx)(s.h2,{id:"how-is-amazon-sqs-different-from-amazon-sns",children:"How is Amazon SQS different from Amazon SNS?"}),"\n",(0,n.jsx)(s.p,{children:'Amazon SNS allows applications to send time-critical messages to multiple subscribers through a "push" mechanism, eliminating the need to periodically check or "poll" for updates. Amazon SQS is a message queue service used by distributed applications to exchange messages through a polling model, and can be used to decouple sending and receiving components.'}),"\n",(0,n.jsx)(s.h2,{id:"does-amazon-sqs-support-message-metadata",children:"Does Amazon SQS support message metadata?"}),"\n",(0,n.jsx)(s.p,{children:"Yes. An Amazon SQS message can contain up to 10 metadata attributes. You can use message attributes to separate the body of a message from the metadata that describes it. This helps process and store information with greater speed and efficiency because your applications don't have to inspect an entire message before understanding how to process it."}),"\n",(0,n.jsxs)(s.p,{children:["Amazon SQS message attributes take the form of name-type-value triples. The supported types include string, binary, and number (including integer, floating-point, and double). For more information, see ",(0,n.jsx)(s.a,{href:"http://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/SQSMessageAttributes.html",children:"Using Amazon SQS Message Attributes"})," in theAmazon SQS Developer Guide."]}),"\n",(0,n.jsx)(s.h2,{id:"how-can-i-determine-the-time-in-queue-value",children:"How can I determine the time-in-queue value?"}),"\n",(0,n.jsxs)(s.p,{children:["To determine the time-in-queue value, you can request the ",(0,n.jsx)(s.code,{children:"SentTimestamp"})," attribute when receiving a message. Subtracting that value from the current time results in the time-in-queue value."]}),"\n",(0,n.jsx)(s.h2,{id:"what-is-the-typical-latency-for-amazon-sqs",children:"What is the typical latency for Amazon SQS?"}),"\n",(0,n.jsx)(s.p,{children:"Typical latencies for SendMessage, ReceiveMessage, and DeleteMessage API requests are in the tens or low hundreds of milliseconds."}),"\n",(0,n.jsx)(s.h2,{id:"what-is-amazon-sqs-long-polling",children:"What is Amazon SQS long polling?"}),"\n",(0,n.jsx)(s.p,{children:"Amazon SQS long polling is a way to retrieve messages from your Amazon SQS queues. While the regular short polling returns immediately, even if the message queue being polled is empty, long polling doesn't return a response until a message arrives in the message queue, or the long poll times out."}),"\n",(0,n.jsxs)(s.p,{children:["Long polling makes it inexpensive to retrieve messages from your Amazon SQS queue as soon as the messages are available. Using long polling might reduce the cost of using SQS, because you can reduce the number of empty receives. For more information, see ",(0,n.jsx)(s.a,{href:"http://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/sqs-long-polling.html",children:"Amazon SQS Long Polling"})," in theAmazon SQS Developer Guide."]}),"\n",(0,n.jsx)(s.h2,{id:"when-should-i-use-amazon-sqs-long-polling-and-when-should-i-use-amazon-sqs-short-polling",children:"When should I use Amazon SQS long polling, and when should I use Amazon SQS short polling?"}),"\n",(0,n.jsx)(s.p,{children:"In almost all cases, Amazon SQS long polling is preferable to short polling. Long-polling requests let your queue consumers receive messages as soon as they arrive in your queue while reducing the number of empty ReceiveMessageResponse instances returned."}),"\n",(0,n.jsx)(s.p,{children:"Amazon SQS long polling results in higher performance at reduced cost in the majority of use cases. However, if your application expects an immediate response from a ReceiveMessage call, you might not be able to take advantage of long polling without some modifications to your application."}),"\n",(0,n.jsx)(s.p,{children:"For example, if your application uses a single thread to poll multiple queues, switching from short polling to long polling will probably not work, because the single thread will wait for the long-poll timeout on any empty queues, delaying the processing of any queues that might contain messages."}),"\n",(0,n.jsx)(s.p,{children:"In such an application, it is a good practice to use a single thread to process only one queue, allowing the application to take advantage of the benefits that Amazon SQS long polling provides."}),"\n",(0,n.jsx)(s.h2,{id:"what-value-should-i-use-for-my-long-poll-timeout",children:"What value should I use for my long-poll timeout?"}),"\n",(0,n.jsx)(s.p,{children:"In general, you should use maximum 20 seconds for a long-poll timeout. Because higher long-poll timeout values reduce the number of empty ReceiveMessageResponse instances returned, try to set your long-poll timeout as high as possible."}),"\n",(0,n.jsx)(s.p,{children:"If the 20-second maximum doesn't work for your application (see the example in the previous question), set a shorter long-poll timeout, as low as 1 second."}),"\n",(0,n.jsx)(s.p,{children:"All AWS SDKs work with 20-second long polls by default. If you don't use an AWS SDK to access Amazon SQS, or if you configured your AWS SDK to specifically have a shorter timeout, you might need to modify your Amazon SQS client to allow longer requests or to use a shorter long-poll timeout."}),"\n",(0,n.jsx)(s.h2,{id:"can-i-delete-all-messages-in-a-message-queue-without-deleting-the-message-queue-itself",children:"Can I delete all messages in a message queue without deleting the message queue itself?"}),"\n",(0,n.jsx)(s.p,{children:"Yes. You can delete all messages in an Amazon SQS message queue using the PurgeQueue action."}),"\n",(0,n.jsx)(s.p,{children:"When you purge a message queue, all the messages previously sent to the message queue are deleted. Because your message queue and its attributes remain, there is no need to reconfigure the message queue; you can continue using it."}),"\n",(0,n.jsx)(s.p,{children:"To delete only specific messages, use the DeleteMessage or DeleteMessageBatch actions."}),"\n",(0,n.jsx)(s.h2,{id:"which-aws-cloudwatch-metrics-do-amazon-sqs-fifo-queues-support",children:"Which AWS CloudWatch metrics do Amazon SQS FIFO queues support?"}),"\n",(0,n.jsx)(s.p,{children:"FIFO queues support all metrics that standard queues support. For FIFO queues, all approximate metrics return accurate counts. For example, the following AWS CloudWatch metrics are supported:"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:"ApproximateNumberOfMessagesDelayed - The number of messages in the queue that are delayed and not available for reading immediately."}),"\n",(0,n.jsx)(s.li,{children:"ApproximateNumberOfMessagesVisible - The number of messages available for retrieval from the queue."}),"\n",(0,n.jsx)(s.li,{children:"ApproximateNumberOfMessagesNotVisible - The number of messages that are in flight (sent to a client but have not yet been deleted or have not yet reached the end of their visibility window)."}),"\n"]}),"\n",(0,n.jsx)(s.h2,{id:"what-are-message-groups",children:"What are message groups?"}),"\n",(0,n.jsx)(s.p,{children:'Messages are grouped into distinct, ordered "bundles" within a FIFO queue. For each message group ID, all messages are sent and received in strict order. However, messages with different message group ID values might be sent and received out of order. You must associate a message group ID with a message. If you don\'t provide a message group ID, the action fails.'}),"\n",(0,n.jsx)(s.p,{children:"If multiple hosts (or different threads on the same host) send messages with the same message group ID are sent to a FIFO queue, Amazon SQS delivers the messages in the order in which they arrive for processing. To ensure that Amazon SQS preserves the order in which messages are sent and received, ensure that multiple senders send each message with a unique message group ID."}),"\n",(0,n.jsx)(s.h2,{id:"do-amazon-sqs-fifo-queues-support-multiple-producers",children:"Do Amazon SQS FIFO queues support multiple producers?"}),"\n",(0,n.jsx)(s.p,{children:"Yes. One or more producers can send messages to a FIFO queue. Messages are stored in the order that they were successfully received by Amazon SQS."}),"\n",(0,n.jsx)(s.p,{children:"If multiple producers send messages in parallel, without waiting for the success response from SendMessage or SendMessageBatch actions, the order between producers might not be preserved. The response of SendMessage or SendMessageBatch actions contains the final ordering sequence that FIFO queues use to place messages in the queue, so your multiple-parallel-producer code can determine the final order of messages in the queue."}),"\n",(0,n.jsx)(s.h2,{id:"do-amazon-sqs-fifo-queues-support-multiple-consumers",children:"Do Amazon SQS FIFO queues support multiple consumers?"}),"\n",(0,n.jsx)(s.p,{children:"By design, Amazon SQS FIFO queues don't serve messages from the same message group to more than one consumer at a time. However, if your FIFO queue has multiple message groups, you can take advantage of parallel consumers, allowing Amazon SQS to serve messages from different message groups to different consumers."}),"\n",(0,n.jsx)(s.h2,{id:"why-are-there-separate-receivemessage-and-deletemessage-operations",children:"Why are there separate ReceiveMessage and DeleteMessage operations?"}),"\n",(0,n.jsx)(s.p,{children:"When Amazon SQS returns a message to you, the message stays in the message queue whether or not you actually receive the message. You're responsible for deleting the message and the deletion request acknowledges that you're done processing the message."}),"\n",(0,n.jsxs)(s.p,{children:["If you don't delete the message, Amazon SQS will deliver it again on when it receives another receive request. For more information, see ",(0,n.jsx)(s.a,{href:"http://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/AboutVT.html",children:"Visibility Timeout"})," in theAmazon SQS Developer Guide."]}),"\n",(0,n.jsx)(s.h2,{id:"can-a-deleted-message-be-received-again",children:"Can a deleted message be received again?"}),"\n",(0,n.jsx)(s.p,{children:"No. FIFO queues never introduce duplicate messages."}),"\n",(0,n.jsx)(s.p,{children:"For standard queues, under rare circumstances, you might receive a previously-deleted message a second time."}),"\n",(0,n.jsx)(s.h2,{id:"what-happens-if-i-issue-a-deletemessage-request-on-a-previously-deleted-message",children:"What happens if I issue a DeleteMessage request on a previously-deleted message?"}),"\n",(0,n.jsx)(s.p,{children:"When you issue a DeleteMessage request on a previously-deleted message, Amazon SQS returns asuccessresponse."}),"\n",(0,n.jsx)(s.h2,{id:"how-long-can-i-keep-my-messages-in-amazon-sqs-message-queues",children:"How long can I keep my messages in Amazon SQS message queues?"}),"\n",(0,n.jsx)(s.p,{children:"Longer message retention provides greater flexibility to allow for longer intervals between message production and consumption."}),"\n",(0,n.jsx)(s.p,{children:"You can configure the Amazon SQS message retention period to a value from 1 minute to 14 days. The default is 4 days. Once the message retention quota is reached, your messages are automatically deleted."}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.a,{href:"https://aws.amazon.com/sqs/faqs",children:"https://aws.amazon.com/sqs/faqs"})}),"\n",(0,n.jsx)(s.h2,{id:"boto3",children:"Boto3"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-python",children:"import boto3\n\nclient = boto3.client('sqs')\n"})}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:(0,n.jsx)(s.a,{href:"https://boto3.amazonaws.com/v1/documentation/api/latest/reference/services/sqs.html#SQS.Client.add_permission",children:(0,n.jsx)(s.strong,{children:"add_permission()"})})}),"\n",(0,n.jsx)(s.li,{children:(0,n.jsx)(s.a,{href:"https://boto3.amazonaws.com/v1/documentation/api/latest/reference/services/sqs.html#SQS.Client.can_paginate",children:(0,n.jsx)(s.strong,{children:"can_paginate()"})})}),"\n",(0,n.jsx)(s.li,{children:(0,n.jsx)(s.a,{href:"https://boto3.amazonaws.com/v1/documentation/api/latest/reference/services/sqs.html#SQS.Client.change_message_visibility",children:(0,n.jsx)(s.strong,{children:"change_message_visibility()"})})}),"\n",(0,n.jsx)(s.li,{children:(0,n.jsx)(s.a,{href:"https://boto3.amazonaws.com/v1/documentation/api/latest/reference/services/sqs.html#SQS.Client.change_message_visibility_batch",children:(0,n.jsx)(s.strong,{children:"change_message_visibility_batch()"})})}),"\n",(0,n.jsx)(s.li,{children:(0,n.jsx)(s.a,{href:"https://boto3.amazonaws.com/v1/documentation/api/latest/reference/services/sqs.html#SQS.Client.create_queue",children:(0,n.jsx)(s.strong,{children:"create_queue()"})})}),"\n",(0,n.jsx)(s.li,{children:(0,n.jsx)(s.a,{href:"https://boto3.amazonaws.com/v1/documentation/api/latest/reference/services/sqs.html#SQS.Client.delete_message",children:(0,n.jsx)(s.strong,{children:"delete_message()"})})}),"\n",(0,n.jsx)(s.li,{children:(0,n.jsx)(s.a,{href:"https://boto3.amazonaws.com/v1/documentation/api/latest/reference/services/sqs.html#SQS.Client.delete_message_batch",children:(0,n.jsx)(s.strong,{children:"delete_message_batch()"})})}),"\n",(0,n.jsx)(s.li,{children:(0,n.jsx)(s.a,{href:"https://boto3.amazonaws.com/v1/documentation/api/latest/reference/services/sqs.html#SQS.Client.delete_queue",children:(0,n.jsx)(s.strong,{children:"delete_queue()"})})}),"\n",(0,n.jsx)(s.li,{children:(0,n.jsx)(s.a,{href:"https://boto3.amazonaws.com/v1/documentation/api/latest/reference/services/sqs.html#SQS.Client.generate_presigned_url",children:(0,n.jsx)(s.strong,{children:"generate_presigned_url()"})})}),"\n",(0,n.jsx)(s.li,{children:(0,n.jsx)(s.a,{href:"https://boto3.amazonaws.com/v1/documentation/api/latest/reference/services/sqs.html#SQS.Client.get_paginator",children:(0,n.jsx)(s.strong,{children:"get_paginator()"})})}),"\n",(0,n.jsx)(s.li,{children:(0,n.jsx)(s.a,{href:"https://boto3.amazonaws.com/v1/documentation/api/latest/reference/services/sqs.html#SQS.Client.get_queue_attributes",children:(0,n.jsx)(s.strong,{children:"get_queue_attributes()"})})}),"\n",(0,n.jsx)(s.li,{children:(0,n.jsx)(s.a,{href:"https://boto3.amazonaws.com/v1/documentation/api/latest/reference/services/sqs.html#SQS.Client.get_queue_url",children:(0,n.jsx)(s.strong,{children:"get_queue_url()"})})}),"\n",(0,n.jsx)(s.li,{children:(0,n.jsx)(s.a,{href:"https://boto3.amazonaws.com/v1/documentation/api/latest/reference/services/sqs.html#SQS.Client.get_waiter",children:(0,n.jsx)(s.strong,{children:"get_waiter()"})})}),"\n",(0,n.jsx)(s.li,{children:(0,n.jsx)(s.a,{href:"https://boto3.amazonaws.com/v1/documentation/api/latest/reference/services/sqs.html#SQS.Client.list_dead_letter_source_queues",children:(0,n.jsx)(s.strong,{children:"list_dead_letter_source_queues()"})})}),"\n",(0,n.jsx)(s.li,{children:(0,n.jsx)(s.a,{href:"https://boto3.amazonaws.com/v1/documentation/api/latest/reference/services/sqs.html#SQS.Client.list_queue_tags",children:(0,n.jsx)(s.strong,{children:"list_queue_tags()"})})}),"\n",(0,n.jsx)(s.li,{children:(0,n.jsx)(s.a,{href:"https://boto3.amazonaws.com/v1/documentation/api/latest/reference/services/sqs.html#SQS.Client.list_queues",children:(0,n.jsx)(s.strong,{children:"list_queues()"})})}),"\n",(0,n.jsx)(s.li,{children:(0,n.jsx)(s.a,{href:"https://boto3.amazonaws.com/v1/documentation/api/latest/reference/services/sqs.html#SQS.Client.purge_queue",children:(0,n.jsx)(s.strong,{children:"purge_queue()"})})}),"\n",(0,n.jsx)(s.li,{children:(0,n.jsx)(s.a,{href:"https://boto3.amazonaws.com/v1/documentation/api/latest/reference/services/sqs.html#SQS.Client.receive_message",children:(0,n.jsx)(s.strong,{children:"receive_message()"})})}),"\n",(0,n.jsx)(s.li,{children:(0,n.jsx)(s.a,{href:"https://boto3.amazonaws.com/v1/documentation/api/latest/reference/services/sqs.html#SQS.Client.remove_permission",children:(0,n.jsx)(s.strong,{children:"remove_permission()"})})}),"\n",(0,n.jsx)(s.li,{children:(0,n.jsx)(s.a,{href:"https://boto3.amazonaws.com/v1/documentation/api/latest/reference/services/sqs.html#SQS.Client.send_message",children:(0,n.jsx)(s.strong,{children:"send_message()"})})}),"\n",(0,n.jsx)(s.li,{children:(0,n.jsx)(s.a,{href:"https://boto3.amazonaws.com/v1/documentation/api/latest/reference/services/sqs.html#SQS.Client.send_message_batch",children:(0,n.jsx)(s.strong,{children:"send_message_batch()"})})}),"\n",(0,n.jsx)(s.li,{children:(0,n.jsx)(s.a,{href:"https://boto3.amazonaws.com/v1/documentation/api/latest/reference/services/sqs.html#SQS.Client.set_queue_attributes",children:(0,n.jsx)(s.strong,{children:"set_queue_attributes()"})})}),"\n",(0,n.jsx)(s.li,{children:(0,n.jsx)(s.a,{href:"https://boto3.amazonaws.com/v1/documentation/api/latest/reference/services/sqs.html#SQS.Client.tag_queue",children:(0,n.jsx)(s.strong,{children:"tag_queue()"})})}),"\n",(0,n.jsx)(s.li,{children:(0,n.jsx)(s.a,{href:"https://boto3.amazonaws.com/v1/documentation/api/latest/reference/services/sqs.html#SQS.Client.untag_queue",children:(0,n.jsx)(s.strong,{children:"untag_queue()"})})}),"\n"]}),"\n",(0,n.jsx)(s.h3,{id:"sqs_consumerpy",children:"sqs_consumer.py"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-python",children:'import boto3\nimport time\nfrom datetime import datetime\n\nclient = boto3.client(\'sqs\')\n\nwhile True:\n    response = client.receive_message(\n    QueueUrl=\'https://sqs.ap-south-1.amazonaws.com/331916247734/TestQueue\',\n    AttributeNames=["SentTimestamp"],\n    MaxNumberOfMessages=10,\n    VisibilityTimeout=5)\n\n    try:\n        # print(response, type(response))\n        # print(f\'{response["ResponseMetadata"]["HTTPStatusCode"]}, {response["ResponseMetadata"]["RetryAttempts"]}\')\n        for i in response.get(\'Messages\', \'\'):\n            print(f\'{str(datetime.now())} {i["Body"]} {datetime.fromtimestamp(int(i["Attributes"]["SentTimestamp"])/1000)}\')\n\n            client.delete_message(QueueUrl=\'https://sqs.ap-south-1.amazonaws.com/331916247734/TestQueue\', ReceiptHandle=i["ReceiptHandle"])\n\n\n    except Exception as e:\n        print(e)\n        print(response, type(response))\n'})}),"\n",(0,n.jsx)(s.h3,{id:"sqs_producerpy",children:"sqs_producer.py"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-python",children:"import boto3\nimport time\nfrom datetime import datetime\n\nclient = boto3.client('sqs')\n\ni = 0\nwhile True:\n    body = f\"{i}_{str(datetime.now())}\"\n    print(body)\n    client.send_message(QueueUrl='https://sqs.ap-south-1.amazonaws.com/331916247734/TestQueue',\n    MessageBody=body)\n\n    # time.sleep(0.5)\n    i += 1\n"})}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.a,{href:"https://boto3.amazonaws.com/v1/documentation/api/latest/reference/services/sqs.html",children:"https://boto3.amazonaws.com/v1/documentation/api/latest/reference/services/sqs.html"})}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.img,{alt:"image",src:t(61655).A+"",width:"1000",height:"2022"})}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.a,{href:"http://pragmaticnotes.com/2017/12/19/lifecycle-of-a-message-in-amazon-sqs-a-detailed-coverage/",children:(0,n.jsx)(s.strong,{children:"http://pragmaticnotes.com/2017/12/19/lifecycle-of-a-message-in-amazon-sqs-a-detailed-coverage/"})})}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.a,{href:"https://blog.contactsunny.com/tech/emulating-apache-kafka-with-amazon-sns-and-sqs",children:"https://blog.contactsunny.com/tech/emulating-apache-kafka-with-amazon-sns-and-sqs"})}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.img,{alt:"image",src:t(227432).A+"",width:"531",height:"461"})})]})}function c(e={}){const{wrapper:s}={...(0,i.R)(),...e.components};return s?(0,n.jsx)(s,{...e,children:(0,n.jsx)(d,{...e})}):d(e)}},61655:(e,s,t)=>{t.d(s,{A:()=>a});const a=t.p+"assets/images/Cloud-AWS-AWS-SQS-image1-4814a85f1154493d6f18ebac55e9e4e3.jpg"},227432:(e,s,t)=>{t.d(s,{A:()=>a});const a=t.p+"assets/images/Cloud-AWS-AWS-SQS-image2-e73bb96217d1cdf80c805beca76ee942.jpg"},28453:(e,s,t)=>{t.d(s,{R:()=>o,x:()=>r});var a=t(296540);const n={},i=a.createContext(n);function o(e){const s=a.useContext(i);return a.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function r(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:o(e.components),a.createElement(i.Provider,{value:s},e.children)}}}]);