"use strict";(self.webpackChunkdeep_notes=self.webpackChunkdeep_notes||[]).push([[6446],{553296:(A,e,i)=>{i.r(e),i.d(e,{assets:()=>t,contentTitle:()=>c,default:()=>l,frontMatter:()=>r,metadata:()=>n,toc:()=>o});const n=JSON.parse('{"id":"ai/model-evaluation/confusion-matrix","title":"Confusion Matrix","description":"The confusion matrix shows - The observations broken down by actual classes and predicted classes","source":"@site/docs/ai/model-evaluation/confusion-matrix.md","sourceDirName":"ai/model-evaluation","slug":"/ai/model-evaluation/confusion-matrix","permalink":"/ai/model-evaluation/confusion-matrix","draft":false,"unlisted":false,"editUrl":"https://github.com/deepaksood619/deepaksood619.github.io/tree/master/docs/ai/model-evaluation/confusion-matrix.md","tags":[],"version":"current","lastUpdatedBy":"Deepak Sood","lastUpdatedAt":1731503026000,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"bias-variance trade-off","permalink":"/ai/model-evaluation/bias-variance-trade-off"},"next":{"title":"Evaluation","permalink":"/ai/model-evaluation/evaluation"}}');var s=i(474848),a=i(28453);const r={},c="Confusion Matrix",t={},o=[{value:"Evaluating Models",id:"evaluating-models",level:2},{value:"Basic measures derived from the confusion matrix",id:"basic-measures-derived-from-the-confusion-matrix",level:3},{value:"Receiver Operating Characteristic (ROC) Curve",id:"receiver-operating-characteristic-roc-curve",level:2},{value:"Area Under Curve (AUC)",id:"area-under-curve-auc",level:2},{value:"Precision-Recall Curve (PR Curve)",id:"precision-recall-curve-pr-curve",level:2}];function E(A){const e={a:"a",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",ol:"ol",p:"p",ul:"ul",...(0,a.R)(),...A.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(e.header,{children:(0,s.jsx)(e.h1,{id:"confusion-matrix",children:"Confusion Matrix"})}),"\n",(0,s.jsx)(e.p,{children:"The confusion matrix shows - The observations broken down by actual classes and predicted classes"}),"\n",(0,s.jsx)(e.p,{children:"Accuracy - The sum of true positives and true negatives, divided by the total number of observations"}),"\n",(0,s.jsx)(e.p,{children:"What is the relationship between the confusion matrix and the area under the receiver operating characteristic curve? - Each point from the curve represents a confusion matrix."}),"\n",(0,s.jsx)(e.p,{children:"Choose your evaluation metrics in light of acceptable tradeoffs between False Positives and False Negatives"}),"\n",(0,s.jsx)(e.h2,{id:"evaluating-models",children:"Evaluating Models"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.img,{alt:"image",src:i(703196).A+"",width:"999",height:"516"})}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.img,{alt:"image",src:i(270891).A+"",width:"617",height:"457"})}),"\n",(0,s.jsx)(e.h3,{id:"basic-measures-derived-from-the-confusion-matrix",children:"Basic measures derived from the confusion matrix"}),"\n",(0,s.jsxs)(e.ol,{children:["\n",(0,s.jsx)(e.li,{children:"Error Rate = (FP+FN)/(P+N)"}),"\n",(0,s.jsx)(e.li,{children:"Accuracy = (TP+TN)/(P+N)"}),"\n",(0,s.jsx)(e.li,{children:"Sensitivity (Recall or True positive rate) = TP/P"}),"\n",(0,s.jsx)(e.li,{children:"False negative rate = FP/(FN+TP) or FP/P - False negative rate is the fraction of true faces that are not detected by the ML system"}),"\n",(0,s.jsx)(e.li,{children:"Specificity (True negative rate) = TN/N"}),"\n",(0,s.jsx)(e.li,{children:"Precision (Positive predicted value) = TP/(TP+FP) - An increase in False Positives would drive down precision"}),"\n",(0,s.jsx)(e.li,{children:"False postitive rate = FP/(FP+TN) - False positive rate is the fraction of the faces that the ML model detects that are not really faces"}),"\n",(0,s.jsx)(e.li,{children:"F-Score (Harmonic mean of precision and recall) = (1+b)(PREC.REC) / (b2PREC+REC) where b is commonly 0.5, 1, 2"}),"\n",(0,s.jsx)(e.li,{children:"Tradeoffs - Sometimes false positives are better than false negatives or vice versa"}),"\n"]}),"\n",(0,s.jsx)(e.h2,{id:"receiver-operating-characteristic-roc-curve",children:"Receiver Operating Characteristic (ROC) Curve"}),"\n",(0,s.jsx)(e.p,{children:"The ROC curve plots - the true positives as a function of false positives."}),"\n",(0,s.jsx)(e.p,{children:"An ROC curve is a graph showing the performance of a classification model at all classification thresholds. This curve plots two parameters:"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"True Positive Rate"}),"\n",(0,s.jsx)(e.li,{children:"False Positive Rate"}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.a,{href:"https://developers.google.com/machine-learning/crash-course/classification/roc-and-auc",children:"https://developers.google.com/machine-learning/crash-course/classification/roc-and-auc"})}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.a,{href:"https://towardsdatascience.com/understanding-auc-roc-curve-68b2303cc9c5",children:"https://towardsdatascience.com/understanding-auc-roc-curve-68b2303cc9c5"})}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.img,{alt:"image",src:i(644430).A+"",width:"999",height:"527"})}),"\n",(0,s.jsx)(e.h2,{id:"area-under-curve-auc",children:"Area Under Curve (AUC)"}),"\n",(0,s.jsx)(e.p,{children:"The AUC provides an aggregate measure of performance across all possible classification thresholds"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"AUC helps us to choose between models when we don't know what decision threshold is going to be ultimately used"}),"\n",(0,s.jsx)(e.li,{children:"If we pick a random positive and a random negative, what't the probability my model scores them in the correct relative order?"}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.img,{alt:"image",src:i(238965).A+"",width:"359",height:"330"})}),"\n",(0,s.jsx)(e.h2,{id:"precision-recall-curve-pr-curve",children:"Precision-Recall Curve (PR Curve)"}),"\n",(0,s.jsx)(e.p,{children:"Precision-recall curves plot the positive predictive value (PPV, y-axis) against the true positive rate (TPR, x-axis). These quantities are defined as follows:"}),"\n",(0,s.jsx)(e.p,{children:"precision = \ud835\udc43\ud835\udc43\ud835\udc49 = \ud835\udc47\ud835\udc43 / (\ud835\udc47\ud835\udc43+\ud835\udc39\ud835\udc43)"}),"\n",(0,s.jsx)(e.p,{children:"recall = TPR = TP / (TP+FN)"}),"\n",(0,s.jsxs)(e.p,{children:["Since precision-recall curves do not consider true negatives, they should only be used ",(0,s.jsx)(e.a,{href:"https://www.datascienceblog.net/post/machine-learning/specificity-vs-precision/",children:"when specificity is of no concern for the classifier"}),"."]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.a,{href:"https://www.datascienceblog.net/post/machine-learning/interpreting-roc-curves-auc",children:"https://www.datascienceblog.net/post/machine-learning/interpreting-roc-curves-auc"})}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.a,{href:"https://www.datascienceblog.net/post/machine-learning/specificity-vs-precision",children:"https://www.datascienceblog.net/post/machine-learning/specificity-vs-precision"})}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.a,{href:"https://machinelearningmastery.com/roc-curves-and-precision-recall-curves-for-imbalanced-classification",children:"https://machinelearningmastery.com/roc-curves-and-precision-recall-curves-for-imbalanced-classification"})}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.a,{href:"https://machinelearningmastery.com/roc-curves-and-precision-recall-curves-for-classification-in-python",children:"https://machinelearningmastery.com/roc-curves-and-precision-recall-curves-for-classification-in-python"})})]})}function l(A={}){const{wrapper:e}={...(0,a.R)(),...A.components};return e?(0,s.jsx)(e,{...A,children:(0,s.jsx)(E,{...A})}):E(A)}},703196:(A,e,i)=>{i.d(e,{A:()=>n});const n=i.p+"assets/images/Confusion-Matrix-image1-2dccc22fe2d843ebc09b26503698dddb.jpg"},270891:(A,e,i)=>{i.d(e,{A:()=>n});const n=i.p+"assets/images/Confusion-Matrix-image2-6d712bdc6fd092e4934db32222ae5ab2.jpg"},644430:(A,e,i)=>{i.d(e,{A:()=>n});const n=i.p+"assets/images/Confusion-Matrix-image3-fa8e1b05524906bc1d92a533a074f57a.jpg"},238965:(A,e,i)=>{i.d(e,{A:()=>n});const n="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEA3ADcAAD/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAFKAWcDASIAAhEBAxEB/8QAGQABAAMBAQAAAAAAAAAAAAAAAAEDBAUC/8QAGAEBAQEBAQAAAAAAAAAAAAAAAAEDBAL/2gAMAwEAAhADEAAAAe+AAAAAAAAAAAAAAAAAAAAAAAeT0AAAAAAAAAAAAAAAAAAAAQSgM2rKagAAAAAAAAAAAAECUCUCUCUCYQTPnylkVKteUvvLqymoAAAAAAAAAABAlAPOD1OjXgy+/HYy449+d9Gd6mmrwr35hZExJEoOwOTe3Lqyy6gAAAAAAAAECUAr5fvz1eZU1zmDXyCAoAICgCDsDj3ty6ssuoAAAAAAABAGWzTy6vO+cjXxEiAAAAAAACJewOTe3Lqyy6gAAAAAAEB58YPfn3lOnIL5AAAAAAAAACXrjk3ty6ssuoAAAAAglAU48uuaTozBAAAAAAAAAABEvYHHvbl1ZV1AAAAEBGKy/n+fPRlEmnkEAAAAAAAAAAARKXrjk3ty6ssuoAAgmJgVuR78acsunILAAAAAAAAAAAAAAl645N7curLLqAAiYGTxj1z8ydGYIAAAAAAAAAAAAAAiUvXHJvbl1ZZdQETAzeuVp4SdOQIAAAAAAAAAAAAAAAEvXHJvbl1ZZdUTAMlmfPE9eAWAAAAAAAAAAAAAAAAIlL1xyb25dWWXVEwOXr5m2cjfIAAAAAAAAAAAAAAAAARL2Byb25dWWXSeDDl8+uvnD1AAAAAAAAAAAAAAAAAAl645N7curLLpy6uP78eB1ZAgAAAAAAAAAAAAAAAAAiXsDk3ty6sst3J14ujINcwAAAAAAAAAAAAAAAAAAl645N7cunLLVjmOvAPXkAAAAAAAAAAAAAAAAAARL2Byb2ZdXPM/jz67MAQAAAAAAAAAAAAAAAAAAJeuOTezBv49ngdeIAAAAAAAAAAAAAAAAAAAiOwOTeyq2ZaFyylcKVwpXClcKVwpXClcKVwpXClcKVwpXClcKVwpXClcKVwpXClcKVwhKX//xAAmEAABBAEDBAMAAwAAAAAAAAACAAEDMhMRQFAEEiEwECAxIjNw/9oACAEBAAEFAv8ACNeNivxkV+G1ZOTMmlB3cxZM+rKK+9cxZZBT9SybqPDzmmmPQjJ3EyZE7km8J/PzHRRX3Tvoz9QnmJ1p7Y6qK+4ImZimMlq77COiivtiNmYpDJa7KOiivtNdFJKRPtI6KK+zll7F3E+2joor7F30Yuod3fzt46KK+wOQQUknfuY6KK/vORhb9fcx0UV/dNK+u7joor+ySRgZ5DLex1UV/WXUeSJyfex0UV/SZsDSS9zb+Oiiv6CJhYv5FwEdFFf7zSdq88FHVRX+xz6O768HHRRX+sp6DwkdFFf6TH2DwsdFFf6TH3PwsdFFf56gtA4aOqiv8yn3vw0dFFf4nfSNuHjoor/E0mr8PHVRXReBbiI6KK6mkZm4iOiiupPMvER0UVzJhF31fiI6KK/U/nEx0UV5y4qOijsX9nEx0UdifUuJjonfQW/OJjpxkdVL+8VHRPGLviBYgWIFiBYgWIFiBYgWIFiBYgWIFiBYgWIFiBYgWIFiBYgWIFiBYgWIFiBYgWIFiBYgWIFiBYgWIFiBYgWIFiBYgWIFiBYgWIE3jjv/xAAeEQADAAIDAQEBAAAAAAAAAAAAARECQBAgMBIxYP/aAAgBAwEBPwH+DuhT7Po+mVl5Xq8oPLxXnR5ea8mxu+i8Xl7LvR5e67PKDd0F1eWkumT01yx6a5zeouW9RcZPVXGb1Vw9VD1kP81lxCEIQhCEIQhCEIQhCE4//8QAIxEAAgICAgEEAwAAAAAAAAAAAREAAjBAAxAgEhMxUSFBYP/aAAgBAgEBPwH+DWgKkwcX3Bxie2J6REIujlrQmV41hOMByvGvnGcVakwVAyHDXjzH58wCZWgGc+VKOALQPjSn3pHwpR6Z7AZgCGme+Ov71D3UIah6oGdU9cQ/D1T1UIapgg1TKhnWMajMZjMZjMZjMZjMZjMZjMZjMZjMZjMZjPX/xAAmEAABBAICAgEEAwAAAAAAAAAAAQIQMSFQEUAgMBIDIkFRMmFw/9oACAEBAAY/Av8ANX61+oypccw/vZUsw1SjBk/kWZUwZlIf3PtT3pD+1+kMr0Eh/Y/SdNIf1uEwnVSH9ThLMr1kh/SyfbXYSH9HJx+OykP6PK9pIf7/AItruJD9WkP9nDcme8kP9WThK0CQ/wBXK6FIf6OEszokh/nw3SJD/LjSpD/LOlSH+ONMkP8ADH506Q/wxp0h841CQ+fimoSHwupSHx8fyupSHwupSHnKnOpSHiJqkh5xqkh47VJDxdUkfV1aR9TVpCp/erSKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKK1//8QAJRAAAQMEAgICAwEAAAAAAAAAAQARoRAhMVBAUTBBIHFhcIGx/9oACAEBAAE/If0QALsca2RrZGmJAyUDYIWPAmABdDXJTV2pI52JR/UQh2pxcIBuMFGk2AIbASnc4fgJzvP2iDkV9yK+0gAMUgUkcsZiSjn/AHKEthMe9/LCpI5LiJRmyjmB4ECkjjuYkI6Q/wBCccknhQKSOKQByUYF/L2hjL8SBSRxMYc0fduNApI4QzEmCIAH2REnNzx4FJHBAX/zlUgUkcDILouUrnlQKSPOSdj2KAYcuBSR5X0cnATo5YH1zYVJHjJADlCtPsnAT86BSR4nYa7oIBsc+BSR4XwSiJCv1oYFJHgOLdyuyJOihUkfO0z9lENydHApI+QiAblAMNJApI+N1GThB/ZydLApI+BLBygtXAaaBSR8DNZWIBhpoVJFcBB6A08CkipTexsgYNp4FJFRdRnUQqSKGSB0nXJydRApI1chApIoRJP0NTApIRVgT121MCkhGWmCdVApIQyWm41UCk9E5D3qoFDYp7QihqoFHAsWqgUcAP71cKhW3vV4FHYQfVgAAAAAAAAAAAAAAAAAAAAAxhrv/9oADAMBAAIAAwAAABAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAQyAAAAAAAAAAAAAAww4w56dX4AAAAAAAAAAAAw7DPU1AOocAAAAAAAAAAAw6wuAMIIMIITEAAAAAAAAAznwCMEEEEEEEYEAAAAAAAAzBAMEEEEEEEEEIEAAAAAAQqmAEEEEEEEEEEEbEAAAAATqGAEEEEEEEEEEEFIAAAARa+EEEEEEEEEEEEEEELEAABKGAEEEEEEEEEEEEEEFIAABTICMEEEEEEEEEEEEEEEIEBS0EEEEEEEEEEEEEEEEEFIABRgMEEEEEEEEEEEEEEEEEYED4sEEEEEEEEEEEEEEEEEEIAKsIEEEEEEEEEEEEEEEEEEYEAAEEEEEEEEEEEEEEEEEEEIw4gEEEEEEEEEEEEEEEEEEEYG1AEEEEEEEEEEEEEEEEEEEIDsAAAAAAAAAAAAAAAAAAAAcGg0000000000000000000037//xAAeEQADAQACAwEBAAAAAAAAAAAAARExMEAQICFBYP/aAAgBAwEBPxD+BqKiC87VaNPwblvFRWJmOVAa8G77rTHG40vnEjHElDeMjHD+aG+RGPdotHPmRj3mjnRj1/JD+9BaY9I/OkjHloqNXektMefw6aMeH8RR9NaY8SXURjx9J1Fpjw9fURg+EPeojA8EZCEZGRkZCMjIyMjIyMjIQjIxIwSkEEEEEEEEEEEEEEEEEEEEEP/EACARAAICAgMBAAMAAAAAAAAAAAABETEhYRAwQCBBUWD/2gAIAQIBAT8Q/goZL9eCpHMJWJIl/g1EBpQW7hRYSSr7dFn1saEKyCx0uiz6muit63RZ9LnliSShdjou+60WZ7nRb6Y+Rawu90Wfy1uQkl4HRb4uMXhdFnziBcS8Tos+ZvGdFnwlODDLxuiz82Oiz4SvIOiz4iV5HRZiS4EhR5HRZ8RglEolEolEolEolEolEolEolEolEolDeCxKhuNxuNxuNxuNxuNxuNxuNxuNxuNxuNxu4//xAAnEAEAAQMDBQEAAQUAAAAAAAABABExYSFAUBAgQVFxMKFgcIGRsf/aAAgBAQABPxD+xDYBbv6Vs4m6ypLMH2I0U4YCP2GVB/1KbL8hCW1b+60n8vUWDPsEigeYJfUZQL4lZQGYiagw0BXQPWpmVUCXMbRU0e2KVAMbO+q6eYCadoQs1UUaS8qWWePz8O766hFQLWreIB/K8/nw/Omezw7mrUiKN80SEQUz27Fs7iragA9yl0NKLxVoVR7epsG23qztg09EqVerx42rZ2tWGQPLPsjYrdTztmztKs06rYXlNQUv+wKFDbttlVrSN2lVglWV/fjctnY1a0NY2XofM0iq/d02dhVh6raPMUfjQ3jZ/brdJQPcFoYv4T4LD1vW361ehr6PcNzS4vmAKChvmz+lWuF8i/dWj1wDZ/OrPVR38EGoqNdeBbP49a0ldFT/AIItcrwTZ/Grq8Cpo2h0j/fBtn8Kup+ii+oiqvCNnvqwRKBAznlcK2e+ro+amr1KQEOE8Pd1rUWxKZdf+3DNnuq6OoKHBwrZ7aO0TJfw5t29ZlVTRB7Oq8P4e2rRB0tOIbPZVtoUdKdA4Zs9lGiVBMuK8Q2eyjaY3DDiGz2UYes1EhxDZ7K1iz4Q4hs9aDTAS61Rb8S260gHuCny4ls9KIaA09ocS2evLWG4w4ls9YZPK70uL0uLMXpcWYsxZizFmLMWYsxZizFmLMWYsxZizFmLMWYsxZizFmLMWYsxZizFmLMWYsxZizFmLBEaBYhxZbp//9k="},28453:(A,e,i)=>{i.d(e,{R:()=>r,x:()=>c});var n=i(296540);const s={},a=n.createContext(s);function r(A){const e=n.useContext(a);return n.useMemo((function(){return"function"==typeof A?A(e):{...e,...A}}),[e,A])}function c(A){let e;return e=A.disableParentContext?"function"==typeof A.components?A.components(s):A.components||s:r(A.components),n.createElement(a.Provider,{value:e},A.children)}}}]);