"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[27912],{603905:(e,t,n)=>{n.d(t,{Zo:()=>g,kt:()=>u});var r=n(667294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var i=r.createContext({}),p=function(e){var t=r.useContext(i),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},g=function(e){var t=p(e.components);return r.createElement(i.Provider,{value:t},e.children)},m="mdxType",c={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,i=e.parentName,g=l(e,["components","mdxType","originalType","parentName"]),m=p(n),d=a,u=m["".concat(i,".").concat(d)]||m[d]||c[d]||o;return n?r.createElement(u,s(s({ref:t},g),{},{components:n})):r.createElement(u,s({ref:t},g))}));function u(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,s=new Array(o);s[0]=d;var l={};for(var i in t)hasOwnProperty.call(t,i)&&(l[i]=t[i]);l.originalType=e,l[m]="string"==typeof e?e:a,s[1]=l;for(var p=2;p<o;p++)s[p]=n[p];return r.createElement.apply(null,s)}return r.createElement.apply(null,n)}d.displayName="MDXCreateElement"},630055:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>i,contentTitle:()=>s,default:()=>c,frontMatter:()=>o,metadata:()=>l,toc:()=>p});var r=n(487462),a=(n(667294),n(603905));const o={},s="16. Generic Operating System Services / Logging",l={unversionedId:"python/documentation/16-generic-operating-system-services-logging",id:"python/documentation/16-generic-operating-system-services-logging",title:"16. Generic Operating System Services / Logging",description:"16.1.os - Miscellaneous operating system interfaces",source:"@site/docs/python/documentation/16-generic-operating-system-services-logging.md",sourceDirName:"python/documentation",slug:"/python/documentation/16-generic-operating-system-services-logging",permalink:"/python/documentation/16-generic-operating-system-services-logging",draft:!1,editUrl:"https://github.com/deepaksood619/deepaksood619.github.io/tree/main/docs/python/documentation/16-generic-operating-system-services-logging.md",tags:[],version:"current",lastUpdatedAt:1677955187,formattedLastUpdatedAt:"Mar 4, 2023",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"15. Cryptographic Services",permalink:"/python/documentation/15-cryptographic-services"},next:{title:"17. Concurrent Execution",permalink:"/python/documentation/17-concurrent-execution"}},i={},p=[{value:"OS",id:"os",level:2},{value:"Python logging",id:"python-logging",level:2},{value:"logging.Handlers",id:"logginghandlers",level:2},{value:"argparse",id:"argparse",level:3},{value:"getopt",id:"getopt",level:3}],g={toc:p},m="wrapper";function c(e){let{components:t,...o}=e;return(0,a.kt)(m,(0,r.Z)({},g,o,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"16-generic-operating-system-services--logging"},"16. Generic Operating System Services / Logging"),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://docs.python.org/3/library/os.html"},"16.1.os - Miscellaneous operating system interfaces")),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://docs.python.org/3/library/io.html"},"16.2.io - Core tools for working with streams")),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://docs.python.org/3/library/time.html"},"16.3.time - Time access and conversions")),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://docs.python.org/3/library/argparse.html"},(0,a.kt)("strong",{parentName:"a"},"16.4.argparse - Parser for command-line options, arguments and sub-commands"))),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://docs.python.org/3/library/getopt.html"},(0,a.kt)("strong",{parentName:"a"},"16.5.getopt - C-style parser for command line options"))),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://docs.python.org/3/library/logging.html"},"16.6.logging - Logging facility for Python")),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://docs.python.org/3/library/logging.config.html"},"16.7.logging.config - Logging configuration")),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://docs.python.org/3/library/logging.handlers.html"},"16.8.logging.handlers - Logging handlers")),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://docs.python.org/3/library/getpass.html"},"16.9.getpass - Portable password input")),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://docs.python.org/3/library/curses.html"},"16.10.curses - Terminal handling for character-cell displays")),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://docs.python.org/3/library/curses.html#module-curses.textpad"},"16.11.curses.textpad - Text input widget for curses programs")),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://docs.python.org/3/library/curses.ascii.html"},"16.12.curses.ascii - Utilities for ASCII characters")),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://docs.python.org/3/library/curses.panel.html"},"16.13.curses.panel - A panel stack extension for curses")),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://docs.python.org/3/library/platform.html"},"16.14.platform - Access to underlying platform's identifying data")),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://docs.python.org/3/library/errno.html"},"16.15.errno - Standard errno system symbols")),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://docs.python.org/3/library/ctypes.html"},"16.16.ctypes - A foreign function library for Python")),(0,a.kt)("h2",{id:"os"},"OS"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"import os\n\nos.listdir() # gives the list of the files and folder is the current directory\n\nos.getloadavg() # Return the number of processes in the system run queue averaged over the last 1, 5, and 15 minutes or raises [OSError](https://docs.python.org/3/library/exceptions.html#OSError) if the load average was unobtainable.\n")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Single Core system--")," if load average is 1.00 it means that system is fully utilized and if there will be more tasks incoming they will be queue-up and wait for execution."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Single Core system--")," if load average is 2.00 it means that System is already utilized and some tasks are already queued-up and waiting for execution."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Multi core system ( 4 cores )--")," if load average is 1.00 it means that system uses 1/4 of his CPU capabilities, one task is actively running and there are still 3 cores at 'idle' stage."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Multi core system ( 4 cores )--")," if load average is 4.00 it means that system uses all 4 cores and it indicate that system is fully utilized.")),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"run-queue:")," Number of active ( running ) and queued processes"),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://www.thegeekdiary.com/understanding-os-load-average-and-run-queue-blocked-queue-in-terms-of-cpu-utilization-in-linux"},"https://www.thegeekdiary.com/understanding-os-load-average-and-run-queue-blocked-queue-in-terms-of-cpu-utilization-in-linux")),(0,a.kt)("h2",{id:"python-logging"},"Python logging"),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:null},(0,a.kt)("strong",{parentName:"th"},"Level")),(0,a.kt)("th",{parentName:"tr",align:null},(0,a.kt)("strong",{parentName:"th"},"When it's used")))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("strong",{parentName:"td"},"DEBUG")),(0,a.kt)("td",{parentName:"tr",align:null},"Detailed information, typically of interest only when diagnosing problems.")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("strong",{parentName:"td"},"INFO")),(0,a.kt)("td",{parentName:"tr",align:null},"Confirmation that things are working as expected.")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("strong",{parentName:"td"},"WARNING")),(0,a.kt)("td",{parentName:"tr",align:null},"An indication that something unexpected happened, or indicative of some problem in the near future (e.g. 'disk space low'). The software is still working as expected.")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("strong",{parentName:"td"},"ERROR")),(0,a.kt)("td",{parentName:"tr",align:null},"Due to a more serious problem, the software has not been able to perform some function.")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("strong",{parentName:"td"},"CRITICAL")),(0,a.kt)("td",{parentName:"tr",align:null},"A serious error, indicating that the program itself may be unable to continue running")))),(0,a.kt)("p",null,"The default level isWARNING, which means that only events of this level and above will be tracked."),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"image",src:n(382102).Z,width:"955",height:"758"})),(0,a.kt)("p",null,"The logging library takes a modular approach and offers several categories of components: loggers, handlers, filters, and formatters."),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Loggers expose the interface that application code directly uses."),(0,a.kt)("li",{parentName:"ul"},"Handlers send the log records (created by loggers) to the appropriate destination."),(0,a.kt)("li",{parentName:"ul"},"Filters provide a finer grained facility for determining which log records to output."),(0,a.kt)("li",{parentName:"ul"},"Formatters specify the layout of log records in the final output.")),(0,a.kt)("p",null,"Log event information is passed between loggers, handlers, filters and formatters in a ",(0,a.kt)("a",{parentName:"p",href:"https://docs.python.org/3/library/logging.html#logging.LogRecord"},"LogRecord")," instance."),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://docs.python.org/3/howto/logging.html"},"https://docs.python.org/3/howto/logging.html")),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://docs.python.org/3/howto/logging-cookbook.html"},"https://docs.python.org/3/howto/logging-cookbook.html")),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Logger")),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://docs.python.org/3/library/logging.html#logging.Logger"},"Logger")," objects have a threefold job. First, they expose several methods to application code so that applications can log messages at runtime. Second, logger objects determine which log messages to act upon based upon severity (the default filtering facility) or filter objects. Third, logger objects pass along relevant log messages to all interested log handlers."),(0,a.kt)("ol",{start:2},(0,a.kt)("li",{parentName:"ol"},"Handler")),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://docs.python.org/3/library/logging.html#logging.Handler"},"Handler")," objects are responsible for dispatching the appropriate log messages (based on the log messages' severity) to the handler's specified destination.",(0,a.kt)("a",{parentName:"p",href:"https://docs.python.org/3/library/logging.html#logging.Logger"},"Logger")," objects can add zero or more handler objects to themselves with an ",(0,a.kt)("a",{parentName:"p",href:"https://docs.python.org/3/library/logging.html#logging.Logger.addHandler"},"addHandler()")," method. As an example scenario, an application may want to send all log messages to a log file, all log messages of error or higher to stdout, and all messages of critical to an email address. This scenario requires three individual handlers where each handler is responsible for sending messages of a specific severity to a specific location."),(0,a.kt)("h2",{id:"logginghandlers"},"logging.Handlers"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"StreamHandler")),(0,a.kt)("li",{parentName:"ul"},"FileHandler"),(0,a.kt)("li",{parentName:"ul"},"NullHandler"),(0,a.kt)("li",{parentName:"ul"},"WatchedFileHandler"),(0,a.kt)("li",{parentName:"ul"},"BaseRotatingHandler"),(0,a.kt)("li",{parentName:"ul"},"RotatingFileHandler"),(0,a.kt)("li",{parentName:"ul"},"TimedRotatingFileHandler"),(0,a.kt)("li",{parentName:"ul"},"SocketHandler"),(0,a.kt)("li",{parentName:"ul"},"DatagramHandler"),(0,a.kt)("li",{parentName:"ul"},"SysLogHandler"),(0,a.kt)("li",{parentName:"ul"},"NTEventLogHandler"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"SMTPHandler")),(0,a.kt)("li",{parentName:"ul"},"MemoryHandler"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"HTTPHandler")),(0,a.kt)("li",{parentName:"ul"},"QueueHandler"),(0,a.kt)("li",{parentName:"ul"},"QueueListener")),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://docs.python.org/3/library/logging.handlers.html"},"https://docs.python.org/3/library/logging.handlers.html")),(0,a.kt)("ol",{start:3},(0,a.kt)("li",{parentName:"ol"},"Formatter")),(0,a.kt)("p",null,"Formatter objects configure the final order, structure, and contents of the log message. Unlike the base ",(0,a.kt)("a",{parentName:"p",href:"https://docs.python.org/3/library/logging.html#logging.Handler"},"logging.Handler")," class, application code may instantiate formatter classes, although you could likely subclass the formatter if your application needs special behavior. The constructor takes three optional arguments -- a message format string, a date format string and a style indicator."),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},'"format": "[%(asctime)s] [%(levelname)s in %(module)s - %(funcName)s():%(lineno)s]: %(message)s",')),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-python"},'# Debugging Logging\nimport traceback\nimport logging\n\n# logging settings\nDEBUG = eval(os.environ.get(\'DEBUG\', \'False\'))\nif DEBUG:\n    logging.basicConfig(format=\'%(asctime)s %(levelname)-8s %(message)s\',\n    level=logging.DEBUG, datefmt=\'%Y-%m-%d %H:%M:%S\')\nelse:\n    logging.basicConfig(format=\'%(asctime)s %(levelname)-8s %(message)s\', level=logging.INFO, datefmt=\'%Y-%m-%d %H:%M:%S\')\n\nlogging.error(\'No topic: {}\'.format(topic))\n# logging.error(traceback.format_exc())\nlogging.exception(\'Exception\') #traceback is attached with message\n\n# format_exc()\n    This is like print_exc(limit) but returns a string instead of printing to a file.\n\n# SLACK Logging\nimport requests\nimport json\nimport os\nfrom logging.config import dictConfig\n\n# debugging and logging settings\nDEBUG = eval(os.environ.get(\'DEBUG\', \'False\'))\n\nSLACK_WEBHOOK="https://hooks.slack.com/services/org_id/api_key"\n\n# for sending error logs to slack\nclass HTTPSlackHandler(logging.Handler):\n    def emit(self, record):\n        log_entry = self.format(record)\n        log_entry = f\'daily_truncate_db_script: {log_entry}\'\n        json_text = json.dumps({"text": log_entry})\n        logging.info(f\'json_text {json_text}\')\n        url = SLACK_WEBHOOK\n        return requests.post(url, json_text, headers={"Content-type": "application/json"}).content\n\ndictConfig({\n    "version": 1,\n    "disable_existing_loggers": True,\n    "formatters": {\n        "default": {\n            "format": "[%(asctime)s] [%(levelname)s in %(module)s - %(funcName)s():%(lineno)s]: %(message)s",\n        },\n        "access": {\n            "format": "%(message)s",\n        }\n    },\n    "handlers": {\n        "console": {\n            "class": "logging.StreamHandler",\n            "formatter": "default",\n            "stream": "ext://sys.stdout",\n        },\n        "slack": {\n            "class": "__main__.HTTPSlackHandler",\n            "formatter": "default",\n            "level": "ERROR",\n        }\n    },\n    "root": {\n        "level": "DEBUG" if DEBUG else "INFO",\n        "handlers": ["console"] if DEBUG else ["console", "slack"],\n    }\n})\n')),(0,a.kt)("h3",{id:"argparse"},"argparse"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-python"},'import argparse\n\nparser = argparse.ArgumentParser()\n\nparser.add_argument("square", type=int, help="display a square of a given number")\n\nparser.add_argument("-v", "--verbosity", type=int, help="increase output verbosity")\n\nargs = parser.parse_args()\n\nanswer = args.square**2\n\nif args.verbosity == 2:\n    print("the square of {} equals {}".format(args.square, answer))\nelif args.verbosity == 1:\n    print("{}^2 == {}".format(args.square, answer))\nelse:\n    print(answer)\n\n# to skip\nparser.add_argument("--skip", action=\'store_true\')\nif args.skip:\n    print(\'True\')\nelse:\n    print(\'False\')\npython test.py --skip\nTrue\n>>>python test.py\nFalse\n')),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://docs.python.org/3.3/library/argparse.html"},"https://docs.python.org/3.3/library/argparse.html"),"\n",(0,a.kt)("a",{parentName:"p",href:"https://docs.python.org/3/howto/argparse.html"},"https://docs.python.org/3/howto/argparse.html")),(0,a.kt)("h3",{id:"getopt"},"getopt"),(0,a.kt)("p",null,"Parses command line options and parameter list. args is the argument list to be parsed, without the leading reference to the running program.\nExample -"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-python"},'try:\n    opts, args = getopt.getopt(argv, "dh:i:k:p:P:t:u:v",\n    ["debug", "id", "keepalive", "port", "password", "topic", "username", "verbose"])\nexcept getopt.GetoptError as s:\n    print_usage()\n    sys.exit(2)\n\nfor opt, arg in opts:\nif opt in ("-d", "--debug"):\ndebug = True\nelif opt in ("-h", "--host"):\nhost = arg\nelif opt in ("-i", "--id"):\nclient_id = arg\nelif opt in ("-k", "--keepalive"):\nkeepalive = int(arg)\nelif opt in ("-p", "--port"):\nport = int(arg)\nelif opt in ("-P", "--password"):\npassword = arg\nelif opt in ("-t", "--topic"):\ntopic = arg\nprint(topic)\nelif opt in ("-u", "--username"):\nusername = arg\nelif opt in ("-v", "--verbose"):\nverbose = True\n')),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://docs.python.org/3/library/getopt.html"},"https://docs.python.org/3/library/getopt.html")),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://github.com/eclipse/paho.mqtt.python/blob/master/examples/client_mqtt_clear_retain.py"},"https://github.com/eclipse/paho.mqtt.python/blob/master/examples/client_mqtt_clear_retain.py")))}c.isMDXComponent=!0},382102:(e,t,n)=>{n.d(t,{Z:()=>r});const r=n.p+"assets/images/16.-Generic-Operating-System-Services-Logging-image1-cd4fa3bc59362c0dc6fc6d3aa677e37b.jpg"}}]);