"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[4668],{603905:(e,t,a)=>{a.d(t,{Zo:()=>c,kt:()=>k});var o=a(667294);function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function l(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,o)}return a}function r(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?l(Object(a),!0).forEach((function(t){n(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function i(e,t){if(null==e)return{};var a,o,n=function(e,t){if(null==e)return{};var a,o,n={},l=Object.keys(e);for(o=0;o<l.length;o++)a=l[o],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(o=0;o<l.length;o++)a=l[o],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var u=o.createContext({}),d=function(e){var t=o.useContext(u),a=t;return e&&(a="function"==typeof e?e(t):r(r({},t),e)),a},c=function(e){var t=d(e.components);return o.createElement(u.Provider,{value:t},e.children)},s="mdxType",p={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},m=o.forwardRef((function(e,t){var a=e.components,n=e.mdxType,l=e.originalType,u=e.parentName,c=i(e,["components","mdxType","originalType","parentName"]),s=d(a),m=n,k=s["".concat(u,".").concat(m)]||s[m]||p[m]||l;return a?o.createElement(k,r(r({ref:t},c),{},{components:a})):o.createElement(k,r({ref:t},c))}));function k(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var l=a.length,r=new Array(l);r[0]=m;var i={};for(var u in t)hasOwnProperty.call(t,u)&&(i[u]=t[u]);i.originalType=e,i[s]="string"==typeof e?e:n,r[1]=i;for(var d=2;d<l;d++)r[d]=a[d];return o.createElement.apply(null,r)}return o.createElement.apply(null,a)}m.displayName="MDXCreateElement"},704127:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>u,contentTitle:()=>r,default:()=>p,frontMatter:()=>l,metadata:()=>i,toc:()=>d});var o=a(487462),n=(a(667294),a(603905));const l={},r="Code Build",i={unversionedId:"cloud/aws/developer-tools/code-build",id:"cloud/aws/developer-tools/code-build",title:"Code Build",description:"AWS CodeBuild is a fully managed continuous integration service that compiles source code, runs tests, and produces software packages that are ready to deploy. With CodeBuild, you don't need to provision, manage, and scale your own build servers. CodeBuild scales continuously and processes multiple builds concurrently, so your builds are not left waiting in a queue.",source:"@site/docs/cloud/aws/developer-tools/code-build.md",sourceDirName:"cloud/aws/developer-tools",slug:"/cloud/aws/developer-tools/code-build",permalink:"/cloud/aws/developer-tools/code-build",draft:!1,editUrl:"https://github.com/deepaksood619/deepaksood619.github.io/tree/main/docs/cloud/aws/developer-tools/code-build.md",tags:[],version:"current",lastUpdatedAt:1677955187,formattedLastUpdatedAt:"Mar 4, 2023",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"EC2 Instance types",permalink:"/cloud/aws/compute/ec2-instance-types"},next:{title:"Developer Tools",permalink:"/cloud/aws/developer-tools/intro"}},u={},d=[{value:"Build Config",id:"build-config",level:2},{value:"IAM auth",id:"iam-auth",level:2},{value:"Caching docker builds",id:"caching-docker-builds",level:2}],c={toc:d},s="wrapper";function p(e){let{components:t,...a}=e;return(0,n.kt)(s,(0,o.Z)({},c,a,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("h1",{id:"code-build"},"Code Build"),(0,n.kt)("p",null,"AWS CodeBuild is a fully managed continuous integration service that compiles source code, runs tests, and produces software packages that are ready to deploy. With CodeBuild, you don't need to provision, manage, and scale your own build servers. CodeBuild scales continuously and processes multiple builds concurrently, so your builds are not left waiting in a queue."),(0,n.kt)("h2",{id:"build-config"},"Build Config"),(0,n.kt)("p",null,"version: 0.2"),(0,n.kt)("p",null,"phases:"),(0,n.kt)("p",null,"pre_build:"),(0,n.kt)("p",null,"commands:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"echo Logging in to Amazon ECR...")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"aws --version")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"$(aws ecr get-login --region $AWS_DEFAULT_REGION --no-include-email)")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"REPOSITORY_URI=331916247734.dkr.ecr.ap-south-1.amazonaws.com/example-repo")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"COMMIT_HASH=$(echo $CODEBUILD_RESOLVED_SOURCE_VERSION | cut -c 1-7)")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"IMAGE_TAG=${COMMIT_HASH:=latest}"))),(0,n.kt)("p",null,"build:"),(0,n.kt)("p",null,"commands:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"echo Build started on ",(0,n.kt)("inlineCode",{parentName:"p"},"date"))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"echo Building the Docker image...")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"docker build -t $REPOSITORY_URI:latest .")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"docker tag $REPOSITORY_URI:latest $REPOSITORY_URI:$IMAGE_TAG"))),(0,n.kt)("p",null,"post_build:"),(0,n.kt)("p",null,"commands:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"echo Build completed on ",(0,n.kt)("inlineCode",{parentName:"p"},"date"))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"echo Pushing the Docker images...")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"docker push $REPOSITORY_URI:latest")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"docker push $REPOSITORY_URI:$IMAGE_TAG"))),(0,n.kt)("h2",{id:"iam-auth"},"IAM auth"),(0,n.kt)("p",null,'{\n"Version": "2012-10-17",\n"Statement": [\n{\n"Effect": "Allow",\n"Action": ','[\n"ecr:GetAuthorizationToken",\n"ecr:InitiateLayerUpload",\n"ecr:UploadLayerPart",\n"ecr:CompleteLayerUpload",\n"ecr:BatchCheckLayerAvailability",\n"ecr:PutImage"\n]',',\n"Resource": "*"\n}\n]\n}'),(0,n.kt)("p",null,(0,n.kt)("a",{parentName:"p",href:"https://dev.to/raphael_jambalos/automate-docker-build-with-aws-codebuild-9om"},"https://dev.to/raphael_jambalos/automate-docker-build-with-aws-codebuild-9om")),(0,n.kt)("p",null,(0,n.kt)("a",{parentName:"p",href:"https://docs.aws.amazon.com/codebuild/latest/userguide/sample-docker.html"},"https://docs.aws.amazon.com/codebuild/latest/userguide/sample-docker.html")),(0,n.kt)("p",null,(0,n.kt)("a",{parentName:"p",href:"https://dev.to/kylegalbraith/how-to-build-your-docker-images-in-aws-with-ease-3174"},"https://dev.to/kylegalbraith/how-to-build-your-docker-images-in-aws-with-ease-3174")),(0,n.kt)("h2",{id:"caching-docker-builds"},"Caching docker builds"),(0,n.kt)("p",null,(0,n.kt)("a",{parentName:"p",href:"https://aws.amazon.com/blogs/devops/improve-build-performance-and-save-time-using-local-caching-in-aws-codebuild"},"https://aws.amazon.com/blogs/devops/improve-build-performance-and-save-time-using-local-caching-in-aws-codebuild")),(0,n.kt)("p",null,(0,n.kt)("a",{parentName:"p",href:"https://docs.aws.amazon.com/codebuild/latest/userguide/build-caching.html"},"https://docs.aws.amazon.com/codebuild/latest/userguide/build-caching.html")))}p.isMDXComponent=!0}}]);