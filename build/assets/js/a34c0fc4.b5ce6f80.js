"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[22485],{603905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>h});var a=n(667294);function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,a,s=function(e,t){if(null==e)return{};var n,a,s={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(s[n]=e[n]);return s}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(s[n]=e[n])}return s}var l=a.createContext({}),u=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},c=function(e){var t=u(e.components);return a.createElement(l.Provider,{value:t},e.children)},d="mdxType",p={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var n=e.components,s=e.mdxType,r=e.originalType,l=e.parentName,c=o(e,["components","mdxType","originalType","parentName"]),d=u(n),m=s,h=d["".concat(l,".").concat(m)]||d[m]||p[m]||r;return n?a.createElement(h,i(i({ref:t},c),{},{components:n})):a.createElement(h,i({ref:t},c))}));function h(e,t){var n=arguments,s=t&&t.mdxType;if("string"==typeof e||s){var r=n.length,i=new Array(r);i[0]=m;var o={};for(var l in t)hasOwnProperty.call(t,l)&&(o[l]=t[l]);o.originalType=e,o[d]="string"==typeof e?e:s,i[1]=o;for(var u=2;u<r;u++)i[u]=n[u];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},866680:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>p,frontMatter:()=>r,metadata:()=>o,toc:()=>u});var a=n(487462),s=(n(667294),n(603905));const r={},i="Others",o={unversionedId:"languages/sql/others",id:"languages/sql/others",title:"Others",description:"SQL CTEs (Common Table Expressions)",source:"@site/docs/languages/sql/others.md",sourceDirName:"languages/sql",slug:"/languages/sql/others",permalink:"/languages/sql/others",draft:!1,editUrl:"https://github.com/deepaksood619/deepaksood619.github.io/tree/main/docs/languages/sql/others.md",tags:[],version:"current",lastUpdatedAt:1677955187,formattedLastUpdatedAt:"Mar 4, 2023",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Operators / Wildcards",permalink:"/languages/sql/operators-wildcards"},next:{title:"PartiQL",permalink:"/languages/sql/partiql"}},l={},u=[{value:"SQL CTEs (Common Table Expressions)",id:"sql-ctes-common-table-expressions",level:2},{value:"When should I use a unique contraint instead of a unique index",id:"when-should-i-use-a-unique-contraint-instead-of-a-unique-index",level:2},{value:"Performance",id:"performance",level:2},{value:"single vs multiple row inserts",id:"single-vs-multiple-row-inserts",level:2},{value:"Enable incremental ETL",id:"enable-incremental-etl",level:2},{value:"Others",id:"others-1",level:2}],c={toc:u},d="wrapper";function p(e){let{components:t,...n}=e;return(0,s.kt)(d,(0,a.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,s.kt)("h1",{id:"others"},"Others"),(0,s.kt)("h2",{id:"sql-ctes-common-table-expressions"},"SQL CTEs (Common Table Expressions)"),(0,s.kt)("p",null,"TheCommon Table Expressions (CTE)were introduced into standard SQL in order to simplify various classes of SQL Queries for which a derived table was just unsuitable. CTE was introduced in SQL Server 2005, the common table expression (CTE) is a temporary named result set that you can reference within a SELECT, INSERT, UPDATE, or DELETE statement. You can also use a CTE in a CREATE a view, as part of the view's SELECT query. In addition, as of SQL Server 2008, you can add a CTE to the new MERGE statement."),(0,s.kt)("p",null,(0,s.kt)("a",{parentName:"p",href:"https://dev.to/helenanders26/why-you-should-use-sql-ctes-25lk"},"https://dev.to/helenanders26/why-you-should-use-sql-ctes-25lk")),(0,s.kt)("p",null,(0,s.kt)("a",{parentName:"p",href:"https://www.geeksforgeeks.org/cte-in-sql"},"https://www.geeksforgeeks.org/cte-in-sql")),(0,s.kt)("p",null,(0,s.kt)("a",{parentName:"p",href:"https://www.essentialsql.com/introduction-common-table-expressions-ctes"},"https://www.essentialsql.com/introduction-common-table-expressions-ctes")),(0,s.kt)("h2",{id:"when-should-i-use-a-unique-contraint-instead-of-a-unique-index"},"When should I use a unique contraint instead of a unique index"),(0,s.kt)("p",null,"Under the hood a unique constraint is implemented the same way as a unique index - an index is needed to efficiently fulfill the requirement to enforce the constraint. Even if the index is created as a result of a UNIQUE constraint, the query planner can use it like any other index if it sees it as the best way to approach a given query."),(0,s.kt)("p",null,"So for a database that supports both features the choice of which to use will often come down to preferred style and consistency."),(0,s.kt)("p",null,"If you are planning to use the index as an index (i.e. your code may rely on searching/sorting/filtering on that field to be quick) I would explicitly use a unique index (and comment the source) rather than a constraint to make that clear - this way if the uniqueness requirement is changed in a later revision of the application you (or some other coder) will know to make sure a non-unique index is put in place of the unique one (just removing a unique constraint would remove the index completely). Also a specific index can be named in an index hint (i.e. WITH(INDEX(ix_index_name)), which I don't think is the case for the index created behind the scenes for managing uniqueness as you are unlikely to know its name."),(0,s.kt)("p",null,"Likewise if you are only needing to enforce uniqueness as a business rule rather than the field needing to be searched or used for sorting then I'd use the constraint, again to make the intended use more obvious when someone else looks at your table definition."),(0,s.kt)("p",null,"Note that if you use both a unique constraint and a unique index on the same field the database will not be bright enough to see the duplication, so you will end up with two indexes which will consume extra space and slow down row inserts/updates."),(0,s.kt)("p",null,(0,s.kt)("a",{parentName:"p",href:"https://dba.stackexchange.com/questions/144/when-should-i-use-a-unique-constraint-instead-of-a-unique-index"},"https://dba.stackexchange.com/questions/144/when-should-i-use-a-unique-constraint-instead-of-a-unique-index")),(0,s.kt)("h2",{id:"performance"},"Performance"),(0,s.kt)("h2",{id:"single-vs-multiple-row-inserts"},"single vs multiple row inserts"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"2 rows at a time: 3.5 - 3.5 seconds"),(0,s.kt)("li",{parentName:"ul"},"5 rows at a time: 2.2 - 2.2 seconds"),(0,s.kt)("li",{parentName:"ul"},"10 rows at a time: 1.7 - 1.7 seconds"),(0,s.kt)("li",{parentName:"ul"},"50 rows at a time: 1.17 - 1.18 seconds"),(0,s.kt)("li",{parentName:"ul"},"100 rows at a time: 1.1 - 1.4 seconds"),(0,s.kt)("li",{parentName:"ul"},"500 rows at a time: 1.1 - 1.2 seconds"),(0,s.kt)("li",{parentName:"ul"},"1000 rows at a time: 1.17 - 1.17 seconds")),(0,s.kt)("p",null,"The time required for inserting a row is determined by the following factors, where the numbers indicate approximate proportions:"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"Connecting: (3)"),(0,s.kt)("li",{parentName:"ul"},"Sending query to server: (2)"),(0,s.kt)("li",{parentName:"ul"},"Parsing query: (2)"),(0,s.kt)("li",{parentName:"ul"},"Inserting row: (1 \xd7 size of row)"),(0,s.kt)("li",{parentName:"ul"},"Inserting indexes: (1 \xd7 number of indexes)"),(0,s.kt)("li",{parentName:"ul"},"Closing: (1)")),(0,s.kt)("p",null,"From this it should be obvious, that sending one large statement will save you an overhead of 7 per insert statement, which in further reading the text also says:"),(0,s.kt)("p",null,"If you are inserting many rows from the same client at the same time, use INSERT statements with multiple VALUES lists to insert several rows at a time. This is considerably faster (many times faster in some cases) than using separate single-row INSERT statements."),(0,s.kt)("p",null,(0,s.kt)("a",{parentName:"p",href:"https://dev.mysql.com/doc/refman/5.7/en/insert-optimization.html"},"https://dev.mysql.com/doc/refman/5.7/en/insert-optimization.html")),(0,s.kt)("h2",{id:"enable-incremental-etl"},"Enable incremental ETL"),(0,s.kt)("p",null,"By enabling data engineers to identify new & updated records by accessing simple fields likecreated_timestampandupdated_timestamp. Make sure that both these fields are populated by the database and not the application. You should have a separate datetime or timestamp field if you want to populate it from the application."),(0,s.kt)("p",null,(0,s.kt)("a",{parentName:"p",href:"https://towardsdatascience.com/table-design-best-practices-for-etl-200accee9cc9"},"https://towardsdatascience.com/table-design-best-practices-for-etl-200accee9cc9")),(0,s.kt)("h2",{id:"others-1"},"Others"),(0,s.kt)("p",null,(0,s.kt)("a",{parentName:"p",href:"https://towardsdatascience.com/6-sql-tricks-every-data-scientist-should-know-f84be499aea5"},"https://towardsdatascience.com/6-sql-tricks-every-data-scientist-should-know-f84be499aea5")))}p.isMDXComponent=!0}}]);