"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[85572],{603905:(e,t,r)=>{r.d(t,{Zo:()=>c,kt:()=>d});var n=r(667294);function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function o(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},s=Object.keys(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var p=n.createContext({}),l=function(e){var t=n.useContext(p),r=t;return e&&(r="function"==typeof e?e(t):i(i({},t),e)),r},c=function(e){var t=l(e.components);return n.createElement(p.Provider,{value:t},e.children)},h="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},y=n.forwardRef((function(e,t){var r=e.components,a=e.mdxType,s=e.originalType,p=e.parentName,c=o(e,["components","mdxType","originalType","parentName"]),h=l(r),y=a,d=h["".concat(p,".").concat(y)]||h[y]||m[y]||s;return r?n.createElement(d,i(i({ref:t},c),{},{components:r})):n.createElement(d,i({ref:t},c))}));function d(e,t){var r=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var s=r.length,i=new Array(s);i[0]=y;var o={};for(var p in t)hasOwnProperty.call(t,p)&&(o[p]=t[p]);o.originalType=e,o[h]="string"==typeof e?e:a,i[1]=o;for(var l=2;l<s;l++)i[l]=r[l];return n.createElement.apply(null,i)}return n.createElement.apply(null,r)}y.displayName="MDXCreateElement"},272800:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>p,contentTitle:()=>i,default:()=>m,frontMatter:()=>s,metadata:()=>o,toc:()=>l});var n=r(487462),a=(r(667294),r(603905));const s={},i="15. Cryptographic Services",o={unversionedId:"python/documentation/15-cryptographic-services",id:"python/documentation/15-cryptographic-services",title:"15. Cryptographic Services",description:"- hashlib - Secure hashes and message digests",source:"@site/docs/python/documentation/15-cryptographic-services.md",sourceDirName:"python/documentation",slug:"/python/documentation/15-cryptographic-services",permalink:"/python/documentation/15-cryptographic-services",draft:!1,editUrl:"https://github.com/deepaksood619/deepaksood619.github.io/tree/main/docs/python/documentation/15-cryptographic-services.md",tags:[],version:"current",lastUpdatedAt:1677955187,formattedLastUpdatedAt:"Mar 4, 2023",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"14. File Formats",permalink:"/python/documentation/14-file-formats"},next:{title:"16. Generic Operating System Services / Logging",permalink:"/python/documentation/16-generic-operating-system-services-logging"}},p={},l=[{value:"Libraries",id:"libraries",level:2},{value:"Fernet",id:"fernet",level:2},{value:"encryption_service.py",id:"encryption_servicepy",level:3}],c={toc:l},h="wrapper";function m(e){let{components:t,...r}=e;return(0,a.kt)(h,(0,n.Z)({},c,r,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"15-cryptographic-services"},"15. Cryptographic Services"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://docs.python.org/3/library/hashlib.html"},"hashlib - Secure hashes and message digests"),(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://docs.python.org/3/library/hashlib.html#hash-algorithms"},"Hash algorithms")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://docs.python.org/3/library/hashlib.html#shake-variable-length-digests"},"SHAKE variable length digests")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://docs.python.org/3/library/hashlib.html#key-derivation"},"Key derivation")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://docs.python.org/3/library/hashlib.html#blake2"},(0,a.kt)("strong",{parentName:"a"},"BLAKE2")),(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://docs.python.org/3/library/hashlib.html#creating-hash-objects"},"Creating hash objects")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://docs.python.org/3/library/hashlib.html#constants"},"Constants")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://docs.python.org/3/library/hashlib.html#examples"},"Examples"),(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://docs.python.org/3/library/hashlib.html#simple-hashing"},"Simple hashing")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://docs.python.org/3/library/hashlib.html#using-different-digest-sizes"},"Using different digest sizes")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://docs.python.org/3/library/hashlib.html#keyed-hashing"},"Keyed hashing")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://docs.python.org/3/library/hashlib.html#randomized-hashing"},"Randomized hashing")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://docs.python.org/3/library/hashlib.html#personalization"},"Personalization")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://docs.python.org/3/library/hashlib.html#tree-mode"},"Tree mode")))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://docs.python.org/3/library/hashlib.html#credits"},"Credits")))))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://docs.python.org/3/library/hmac.html"},"hmac - Keyed-Hashing for Message Authentication")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://docs.python.org/3/library/secrets.html"},(0,a.kt)("strong",{parentName:"a"},"secrets - Generate secure random numbers for managing secrets")),(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://docs.python.org/3/library/secrets.html#random-numbers"},"Random numbers")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://docs.python.org/3/library/secrets.html#generating-tokens"},"Generating tokens"),(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://docs.python.org/3/library/secrets.html#how-many-bytes-should-tokens-use"},"How many bytes should tokens use?")))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://docs.python.org/3/library/secrets.html#other-functions"},"Other functions")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://docs.python.org/3/library/secrets.html#recipes-and-best-practices"},"Recipes and best practices"))))),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-python"},"import secrets\n\nsecrets.token_hex(16)\n\nsecrets.token_urlsafe(16)\n")),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://docs.python.org/3/library/secrets.html"},"https://docs.python.org/3/library/secrets.html")),(0,a.kt)("h2",{id:"libraries"},"Libraries"),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://github.com/Legrandin/pycryptodome"},"https://github.com/Legrandin/pycryptodome")),(0,a.kt)("p",null,"AES - ",(0,a.kt)("a",{parentName:"p",href:"https://qvault.io/cryptography/aes-256-cipher-python-cryptography-examples"},"https://qvault.io/cryptography/aes-256-cipher-python-cryptography-examples")),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://github.com/chrissimpkins/crypto"},"https://github.com/chrissimpkins/crypto")),(0,a.kt)("h2",{id:"fernet"},"Fernet"),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://github.com/pyca/cryptography"},"https://github.com/pyca/cryptography")),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://cryptography.io/en/latest"},"https://cryptography.io/en/latest")),(0,a.kt)("p",null,"cryptographyincludes both high level recipes and low level interfaces to common cryptographic algorithms such as symmetric ciphers, message digests, and key derivation functions. For example, to encrypt something withcryptography's high level symmetric encryption recipe:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-python"},"from cryptography.fernet import Fernet\n# Put this somewhere safe!\nkey = Fernet.generate_key()\nf = Fernet(key)\ntoken = f.encrypt(b\"A really secret message. Not for prying eyes.\")\ntoken\nb'...'\nf.decrypt(token)\nb'A really secret message. Not for prying eyes.'\n")),(0,a.kt)("h3",{id:"encryption_servicepy"},"encryption_service.py"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-python"},"from cryptography.hazmat.primitives.ciphers import Cipher, algorithms, modes\nimport codecs\n\nclass IrctcEncryptDecrypt:\n    block_size = 16\n\n    def __init__(self):\n\n        self.key = \"abfb7c8d48dfc4f1ce7ed92a44989f25\".encode()\n        self.iv = \"232fcfdc2e2b4767\".encode()\n\n  #PKCS5\n    def pad(self, message):\n        return  message + (self.block_size - len(message) % self.block_size) * chr(self.block_size - len(message) % self.block_size)\n\n  #PKCS5\n    def unpad(self, message):\n        return message[0:-ord(message[-1])]\n\n    def encrypt(self, message):\n        message = self.pad(message).encode()\n        cipher = Cipher(algorithms.AES(self.key), modes.CBC(self.iv))\n        encryptor = cipher.encryptor()\n        ct = encryptor.update(message) + encryptor.finalize()\n        ct = codecs.encode(ct, 'hex').decode()\n        return ct\n\n    def decrypt(self, cipher_text):\n        cipher_text = cipher_text.encode()\n        cipher_text = codecs.decode(cipher_text, 'hex')\n        cipher = Cipher(algorithms.AES(self.key), modes.CBC(self.iv))\n        decrypter = cipher.decryptor()\n        ct = decrypter.update(cipher_text) + decrypter.finalize()\n        ct = self.unpad(ct.decode())\n        return ct\n")),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://medium.com/coinmonks/if-youre-struggling-picking-a-crypto-suite-fernet-may-be-the-answer-95196c0fec4b"},"https://medium.com/coinmonks/if-youre-struggling-picking-a-crypto-suite-fernet-may-be-the-answer-95196c0fec4b")))}m.isMDXComponent=!0}}]);