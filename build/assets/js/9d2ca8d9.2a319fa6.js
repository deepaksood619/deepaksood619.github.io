"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[86406],{603905:(e,t,a)=>{a.d(t,{Zo:()=>p,kt:()=>d});var n=a(667294);function i(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){i(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function s(e,t){if(null==e)return{};var a,n,i=function(e,t){if(null==e)return{};var a,n,i={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(i[a]=e[a]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(i[a]=e[a])}return i}var o=n.createContext({}),m=function(e){var t=n.useContext(o),a=t;return e&&(a="function"==typeof e?e(t):l(l({},t),e)),a},p=function(e){var t=m(e.components);return n.createElement(o.Provider,{value:t},e.children)},c="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},g=n.forwardRef((function(e,t){var a=e.components,i=e.mdxType,r=e.originalType,o=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),c=m(a),g=i,d=c["".concat(o,".").concat(g)]||c[g]||u[g]||r;return a?n.createElement(d,l(l({ref:t},p),{},{components:a})):n.createElement(d,l({ref:t},p))}));function d(e,t){var a=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var r=a.length,l=new Array(r);l[0]=g;var s={};for(var o in t)hasOwnProperty.call(t,o)&&(s[o]=t[o]);s.originalType=e,s[c]="string"==typeof e?e:i,l[1]=s;for(var m=2;m<r;m++)l[m]=a[m];return n.createElement.apply(null,l)}return n.createElement.apply(null,a)}g.displayName="MDXCreateElement"},109502:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>o,contentTitle:()=>l,default:()=>u,frontMatter:()=>r,metadata:()=>s,toc:()=>m});var n=a(487462),i=(a(667294),a(603905));const r={},l="System Design - MMOG - Game",s={unversionedId:"computer-science/interview-question/system-design-mmog-game",id:"computer-science/interview-question/system-design-mmog-game",title:"System Design - MMOG - Game",description:"System design: Design Multiplayer game",source:"@site/docs/computer-science/interview-question/system-design-mmog-game.md",sourceDirName:"computer-science/interview-question",slug:"/computer-science/interview-question/system-design-mmog-game",permalink:"/computer-science/interview-question/system-design-mmog-game",draft:!1,editUrl:"https://github.com/deepaksood619/deepaksood619.github.io/tree/main/docs/computer-science/interview-question/system-design-mmog-game.md",tags:[],version:"current",lastUpdatedAt:1677955187,formattedLastUpdatedAt:"Mar 4, 2023",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"System Design - Messenger / WhatsApp",permalink:"/computer-science/interview-question/system-design-messenger-whatsapp"},next:{title:"System Design - Others",permalink:"/computer-science/interview-question/system-design-others"}},o={},m=[{value:"Game Loop",id:"game-loop",level:2},{value:"Physics Engines",id:"physics-engines",level:2},{value:"Authoritative Server",id:"authoritative-server",level:2},{value:"Networking",id:"networking",level:2},{value:"Handling states, corner cases, rules for objects",id:"handling-states-corner-cases-rules-for-objects",level:2},{value:"Patch Servers",id:"patch-servers",level:2},{value:"Game State Backup",id:"game-state-backup",level:2},{value:"CDN",id:"cdn",level:2},{value:"Database",id:"database",level:2}],p={toc:m},c="wrapper";function u(e){let{components:t,...r}=e;return(0,i.kt)(c,(0,n.Z)({},p,r,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"system-design---mmog---game"},"System Design - MMOG - Game"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://www.youtube.com/playlist?list=PLkQkbY7JNJuCoOw3epgKcNIU6rFri4iQk"},"System design: Design Multiplayer game")),(0,i.kt)("h2",{id:"game-loop"},"Game Loop"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"image",src:a(485125).Z,width:"978",height:"832"})),(0,i.kt)("p",null,"while (true) {"),(0,i.kt)("p",null,"check_input()"),(0,i.kt)("p",null,"update_game_state()"),(0,i.kt)("p",null,"render_screen()"),(0,i.kt)("p",null,"}"),(0,i.kt)("h2",{id:"physics-engines"},"Physics Engines"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Unity"),(0,i.kt)("li",{parentName:"ul"},"Unreal Engine\n",(0,i.kt)("img",{alt:"image",src:a(22495).Z,width:"1162",height:"452"}))),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Strategic games")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Slow turn games")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"First person games"))),(0,i.kt)("h2",{id:"authoritative-server"},"Authoritative Server"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Holds all the state information and validates each state information with it's own state"),(0,i.kt)("li",{parentName:"ul"},"No one can hack the client and run mod commands"),(0,i.kt)("li",{parentName:"ul"},"Therefore can't have peer to peer connection between players")),(0,i.kt)("h2",{id:"networking"},"Networking"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"Deterministic Lock Step")),(0,i.kt)("li",{parentName:"ul"},"Sends only input only and not the new state of game character"),(0,i.kt)("li",{parentName:"ul"},"Encode each bit for each input thereby saving more bandwidth"),(0,i.kt)("li",{parentName:"ul"},"Using this other side can simulate their own environment"),(0,i.kt)("li",{parentName:"ul"},"Sampling size - 60 / sec")),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"TCP (Head of line blocking), therefore can't use TCP")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Playout Buffer (keep 5 sec in buffer like in youtube, netflix, that keeps preloaded some data beforehand, so intermittent network can be smoothened)")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Can have a buffer space (park space) of 50 ms so the overall experience is smooth")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Therefore instead of TCP use UDP,"))),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"image",src:a(273842).Z,width:"1101",height:"434"})),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Send previous inputs in all packets"),(0,i.kt)("li",{parentName:"ul"},"Add timestamps for replay- ",(0,i.kt)("strong",{parentName:"li"},"State Synchronization"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"Sync state of the environments object",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"Object State",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"Position"),(0,i.kt)("li",{parentName:"ul"},"Orientation"),(0,i.kt)("li",{parentName:"ul"},"Linear Velocity"),(0,i.kt)("li",{parentName:"ul"},"Angular Velocity"))))))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"Jitters and lagging"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"Prediction"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"Linear Interpolation"),(0,i.kt)("li",{parentName:"ul"},"Polar Interpolation"),(0,i.kt)("li",{parentName:"ul"},"Hermite Interpolation")))))),(0,i.kt)("h2",{id:"handling-states-corner-cases-rules-for-objects"},"Handling states, corner cases, rules for objects"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Via if-else statement",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"Not maintainable"),(0,i.kt)("li",{parentName:"ul"},"Not scalable"),(0,i.kt)("li",{parentName:"ul"},"No design pattern")))),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"image",src:a(138366).Z,width:"1099",height:"674"}),"\n",(0,i.kt)("img",{alt:"image",src:a(751723).Z,width:"1268",height:"788"}),"\n",(0,i.kt)("img",{alt:"image",src:a(318678).Z,width:"1099",height:"577"}),"\n",(0,i.kt)("img",{alt:"image",src:a(607137).Z,width:"1405",height:"878"})),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"World Server"),(0,i.kt)("li",{parentName:"ul"},"Game /Area Server"),(0,i.kt)("li",{parentName:"ul"},"Data Structure - Map Template\n",(0,i.kt)("img",{alt:"image",src:a(927223).Z,width:"1100",height:"946"}))),(0,i.kt)("h2",{id:"patch-servers"},"Patch Servers"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Everyone should be in same version in MMOG"),(0,i.kt)("li",{parentName:"ul"},"Real time updates")),(0,i.kt)("h2",{id:"game-state-backup"},"Game State Backup"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Important bits")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Only if changed")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Individual")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Async"))),(0,i.kt)("h2",{id:"cdn"},"CDN"),(0,i.kt)("p",null,"Game Sprites"),(0,i.kt)("h2",{id:"database"},"Database"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"SQL"),(0,i.kt)("li",{parentName:"ul"},"Sharded SQL"),(0,i.kt)("li",{parentName:"ul"},"NoSQL")))}u.isMDXComponent=!0},485125:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/System-Design-MMOG-Game-image1-0b5fa7cb0ab29cdf63452bca1df05fba.jpg"},22495:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/System-Design-MMOG-Game-image2-173526ff51f403f9fbcac1db99ed07f6.jpg"},273842:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/System-Design-MMOG-Game-image3-4b2b568661c54d29a406e77db2892ad6.jpg"},138366:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/System-Design-MMOG-Game-image4-1f3c2a18624be1f767ca872b9701b378.jpg"},751723:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/System-Design-MMOG-Game-image5-9ecb57e1659aa64802c7f673e0285e33.jpg"},318678:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/System-Design-MMOG-Game-image6-62ce4a1d006cb9e5acb1a793f35110a2.jpg"},607137:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/System-Design-MMOG-Game-image7-b7a3dd884bc5b5be164d72416be43643.jpg"},927223:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/System-Design-MMOG-Game-image8-25aea4c0855481219f52f60d2466dc4f.jpg"}}]);